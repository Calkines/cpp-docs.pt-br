---
title: Classe CRowset
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- MoveToRatio
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- ReleaseRows
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: dc4f619fb0dba924693682c927247e809fe2cfe9
ms.sourcegitcommit: c7f90df497e6261764893f9cc04b5d1f1bf0b64b
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/05/2019
ms.locfileid: "59032317"
---
# <a name="crowset-class"></a>Classe CRowset

Encapsula um objeto de conjunto de linhas OLE DB e vários relacionados interfaces e fornece métodos de manipulação de dados do conjunto de linhas.

## <a name="syntax"></a>Sintaxe

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>Parâmetros

*TAccessor*<br/>
Uma classe de acessador. O padrão é `CAccessorBase`.

## <a name="requirements"></a>Requisitos

**Cabeçalho:** atldbcli.h

## <a name="members"></a>Membros

### <a name="methods"></a>Métodos

|||
|-|-|
|[AddRefRows](#addrefrows)|Incrementa a contagem de referência associado com a linha atual.|
|[Fechar](#close)|Libera linhas e atual `IRowset` interface.|
|[Comparar](#compare)|Compara dois indicadores usando [IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).|
|[CRowset](#crowset)|Cria um novo `CRowset` do objeto e (opcionalmente) associa a um `IRowset` interface fornecida como um parâmetro.|
|[Excluir](#delete)|Exclui linhas do conjunto de linhas usando [IRowsetChange:DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)).|
|[FindNextRow](#findnextrow)|Localiza a próxima linha correspondente após o indicador especificado.|
|[GetApproximatePosition](#getapproximateposition)|Retorna a posição aproximada de uma linha correspondente a um indicador.|
|[GetData](#getdata)|Recupera dados da cópia do conjunto de linhas da linha.|
|[GetDataHere](#getdatahere)|Recupera dados do buffer especificado.|
|[GetOriginalData](#getoriginaldata)|Recupera os dados mais recentemente procurada de ou transmitida para a fonte de dados, ignorando as alterações pendentes.|
|[GetRowStatus](#getrowstatus)|Retorna o status de todas as linhas.|
|[Inserir](#insert)|Cria e insere uma nova linha usando [IRowsetChange:InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85)).|
|[IsSameRow](#issamerow)|Compara a linha especificada com a linha atual.|
|[MoveFirst](#movefirst)|Reposiciona o local de busca de Avançar para a posição inicial.|
|[MoveLast](#movelast)|Move para o último registro.|
|[MoveNext](#movenext)|Busca dados da próxima linha sequencial ou um número especificado de posições após a próxima linha.|
|[MovePrev](#moveprev)|Move para o registro anterior.|
|[MoveToBookmark](#movetobookmark)|Busca a linha marcada por um indicador ou a linha em um deslocamento especificado desse indicador.|
|[MoveToRatio](#movetoratio)|Busca linhas a partir de uma posição fracionária no conjunto de linhas.|
|[ReleaseRows](#releaserows)|Chamadas [IRowset:: Releaserows](/previous-versions/windows/desktop/ms719771(v=vs.85)) para liberar o identificador de linha atual.|
|[SetData](#setdata)|Define os valores de dados em uma ou mais colunas de uma linha usando [IRowsetChange:SetData](/previous-versions/windows/desktop/ms721232(v=vs.85)).|
|[Desfazer](#undo)|Desfaz todas as alterações feitas em uma linha desde o último fetch ou [atualização](../../data/oledb/crowset-update.md).|
|[Atualização](#update)|Transmite todas as alterações feitas na linha atual desde a última busca ou atualização pendentes.|
|[UpdateAll](#updateall)|Transmite todas as alterações feitas a todas as linhas desde o último fetch ou a atualização pendentes.|

## <a name="remarks"></a>Comentários

No OLE DB, um conjunto de linhas é o objeto por meio do qual um programa define e recupera os dados.

Essa classe não deve ser instanciado, mas em vez disso, é passado como um parâmetro de modelo `CTable` ou `CCommand` (`CRowset` é o padrão).

## <a name="addrefrows"></a> CRowset::AddRefRows

Chamadas [IRowset::AddRefRows](/previous-versions/windows/desktop/ms719619(v=vs.85)) sejam incrementados (um) a contagem de referência associado com o identificador da linha atual.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método incrementa a contagem de referência para a alça da linha atual. Chame [ReleaseRows](../../data/oledb/crowset-releaserows.md) para diminuir a contagem. Linhas retornadas pelos métodos de movimentação tem uma contagem de referência de um.

## <a name="close"></a> Crowset:: Close

Libera linhas e o atual [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) interface.

### <a name="syntax"></a>Sintaxe

```cpp
void Close() throw();
```

### <a name="remarks"></a>Comentários

Esse método libera todas as linhas atualmente no conjunto de linhas.

## <a name="compare"></a> CRowset::Compare

Compara dois indicadores usando [IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>Parâmetros

*Bookmark1*<br/>
[in] O primeiro indicador a ser comparado.

*Bookmark2*<br/>
[in] O segundo indicador a ser comparado.

*pComparison*<br/>
[out] Um ponteiro para o resultado da comparação.

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer que a interface opcional `IRowsetLocate`, que podem não ter suporte em todos os provedores; se esse for o caso, o método retorna E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetLocate` como VARIANT_TRUE antes de chamar `Open` na tabela ou que contém o conjunto de linhas de comando.

Para obter informações sobre como usar indicadores de consumidores, consulte [usando indicadores](../../data/oledb/using-bookmarks.md).

## <a name="crowset"></a> CRowset::CRowset

Cria um novo `CRowset` do objeto e (opcionalmente) associa a um [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) interface fornecida como um parâmetro.

### <a name="syntax"></a>Sintaxe

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>Parâmetros

*pRowset*<br/>
[in] Um ponteiro para um `IRowset` interface a ser associado essa classe.

## <a name="delete"></a> CRowset::Delete

Chamadas [IRowsetChange:: DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)) para excluir a linha atual do conjunto de linhas.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

## <a name="findnextrow"></a> CRowset::FindNextRow

Localiza a próxima linha correspondente após o indicador especificado.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>Parâmetros

*op*<br/>
[in] A operação a ser usada na comparação de valores de linha. Para obter valores, consulte [irowsetfind:: Findnextrow](/previous-versions/windows/desktop/ms723091(v=vs.85)).

*pData*<br/>
[in] Um ponteiro para o valor a ser correspondido.

*wType*<br/>
[in] Indica o tipo de dados na parte de valor do buffer. Para obter informações sobre indicadores de tipo, consulte [tipos de dados](/previous-versions/windows/desktop/ms723969(v=vs.85)) na *referência do programador DB OLE* no SDK do Windows.

*nLength*<br/>
[in] O comprimento, em bytes, da estrutura de dados consumidor alocado para o valor de dados. Para obter detalhes, consulte a descrição da `cbMaxLen` na [estruturas DBBINDING](/previous-versions/windows/desktop/ms716845(v=vs.85)) no *referência do programador DB OLE.*

*bPrecision*<br/>
[in] A precisão máxima usada ao obter dados. Usado somente se *wType* é DBTYPE_NUMERIC. Para obter mais informações, consulte [conversões que envolvem DBTYPE_NUMERIC ou DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) na *referência do programador DB OLE*.

*bScale*<br/>
[in] A escala usada ao obter dados. Usado somente se *wType* é DBTYPE_NUMERIC ou DBTYPE_DECIMAL. Para obter mais informações, consulte [conversões que envolvem DBTYPE_NUMERIC ou DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) na *referência do programador DB OLE*.

*bSkipCurrent*<br/>
[in] O número de linhas do indicador no qual iniciar uma pesquisa.

*pBookmark*<br/>
[in] O indicador de posição na qual iniciar uma pesquisa.

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer que a interface opcional `IRowsetFind`, que podem não ter suporte em todos os provedores; se esse for o caso, o método retorna E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetFind` como VARIANT_TRUE antes de chamar `Open` na tabela ou que contém o conjunto de linhas de comando.

Para obter informações sobre como usar indicadores de consumidores, consulte [usando indicadores](../../data/oledb/using-bookmarks.md).

## <a name="getapproximateposition"></a> CRowset::GetApproximatePosition

Retorna a posição aproximada de uma linha correspondente a um indicador.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>Parâmetros

*pBookmark*<br/>
[in] Um ponteiro para um indicador que identifica a linha cuja posição deve ser encontrado. NULL se apenas a contagem de linhas é necessária.

*pPosition*<br/>
[out] Um ponteiro para o local onde `GetApproximatePosition` retorna a posição da linha. NULL se a posição não for necessária.

*pcRows*<br/>
[out] Um ponteiro para o local onde `GetApproximatePosition` retorna o número total de linhas. NULL se a contagem de linhas não é necessária.

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer que a interface opcional `IRowsetScroll`, que podem não ter suporte em todos os provedores; se esse for o caso, o método retorna E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetScroll` como VARIANT_TRUE antes de chamar `Open` na tabela ou que contém o conjunto de linhas de comando.

Para obter informações sobre como usar indicadores de consumidores, consulte [usando indicadores](../../data/oledb/using-bookmarks.md).

## <a name="getdata"></a> CRowset::GetData

Recupera dados da cópia do conjunto de linhas da linha.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>Parâmetros

*nAccessor*<br/>
[in] O número de índice (deslocamento zero) do acessador a ser usado para acessar os dados.

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Se você especificar um acessador que não é um autoaccessor na [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md), use esse método para obter explicitamente os dados, passando o número de acessador.

## <a name="getdatahere"></a> CRowset::GetDataHere

Recupera dados da linha atual e o coloca no buffer especificado.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>Parâmetros

*nAccessor*<br/>
[in] O número de índice de acessador a ser usado para acessar os dados.

*pBuffer*<br/>
[out] Um buffer no qual colocar os dados para o registro atual.

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Para obter um exemplo de como usar essa função, consulte a [MultiRead exemplo](../../overview/visual-cpp-samples.md).

## <a name="getoriginaldata"></a> CRowset::GetOriginalData

Chamadas `IRowsetUpdate::GetOriginalData` para recuperar os dados mais recentemente procurada de ou transmitida para a fonte de dados.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método recupera os dados mais recentemente procurada de ou transmitida para a fonte de dados; ela não recupera valores com base em alterações pendentes.

Esse método requer que a interface opcional `IRowsetUpdate`, que podem não ter suporte em todos os provedores; se esse for o caso, o método retorna E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetUpdate` como VARIANT_TRUE antes de chamar `Open` na tabela ou que contém o conjunto de linhas de comando.

## <a name="getrowstatus"></a> CRowset::GetRowStatus

Retorna o status de todas as linhas.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>Parâmetros

*pStatus*<br/>
[out] Um ponteiro para um local onde `GetRowStatus` retorna o valor de status. Consulte DBPENDINGSTATUS na referência do programador do OLE DB.

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer que a interface opcional `IRowsetUpdate`, que podem não ter suporte em todos os provedores; se esse for o caso, o método retorna E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetUpdate` como VARIANT_TRUE antes de chamar `Open` na tabela ou que contém o conjunto de linhas de comando.

## <a name="insert"></a> CRowset::Insert

Cria e inicializa uma nova linha usando os dados do acessador.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>Parâmetros

*nAccessor*<br/>
[in] O número de acessador a ser usado para inserir os dados.

*bGetHRow*<br/>
[in] Indica se o identificador para a linha inserida é recuperado.

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer que a interface opcional `IRowsetChange`, que podem não ter suporte em todos os provedores; se esse for o caso, o método retorna E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetChange` como VARIANT_TRUE antes de chamar `Open` na tabela ou que contém o conjunto de linhas de comando.

Inserção pode falhar se uma ou mais colunas não é gravável. Modifique seu mapa de cursor para corrigir isso.

### <a name="example"></a>Exemplo

O exemplo a seguir mostra como acessar uma fonte de dados por meio de um conjunto de linhas e, em seguida, insira uma cadeia de caracteres usando uma tabela em que conjunto de linhas.

Primeiro, crie uma classe de tabela, inserindo um novo objeto ATL ao seu projeto. Por exemplo, o botão direito do mouse no projeto no painel de espaço de trabalho e selecione **novo objeto ATL**. Dos **acesso a dados** categoria, selecione **consumidor**. Criar um objeto do tipo de consumidor **tabela**. (Selecionando **tabela** cria um conjunto de linhas diretamente da tabela; selecionando **comando** cria um conjunto de linhas por meio de um comando SQL.) Selecione uma fonte de dados, especificando uma tabela por meio do qual acessar essa fonte de dados. Se você chamar o objeto do consumidor **CCustomerTable**, em seguida, você poderia implementar seu código de inserção da seguinte maneira:

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="issamerow"></a> CRowset::IsSameRow

Compara a linha especificada com a linha atual.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>Parâmetros

*hRow*<br/>
[in] Um identificador para a linha a ser comparado com a linha atual.

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão. S_OK indica que as linhas são os mesmos. Para outros valores, consulte [IRowsetIndentity::IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85)) na *referência do programador DB OLE* no SDK do Windows.

## <a name="movefirst"></a> CRowset::MoveFirst

Move o cursor para a posição inicial e recupera a linha inicial.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Chamadas [:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) para reposicionar o próxima busca local para a posição inicial (a posição em que era a localização de fetch next quando o conjunto de linhas foi criado) e recupera a linha inicial.

## <a name="movelast"></a> CRowset::MoveLast

Move o cursor para a última linha.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Chamadas [:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) para reposicionar o próxima busca local para a última posição e recupera a última linha.

Esse método requer que você defina `DBPROP_CANSCROLLBACKWARDS` como VARIANT_TRUE antes de chamar `Open` na tabela ou que contém o conjunto de linhas de comando. (Para obter melhor desempenho, você também pode definir `DBPROP_QUICKRESTART` como VARIANT_TRUE.)

## <a name="movenext"></a> CRowset::MoveNext

Move o cursor para o próximo registro.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>Parâmetros

*lSkip*<br/>
[in] O número de linhas a serem ignoradas antes de buscar.

*bForward*<br/>
[in] Passar **verdadeira** para Avançar para o próximo registro, **falso** para retroceder.

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão. Quando o final do conjunto de linhas foi atingido, retorna DB_S_ENDOFROWSET.

### <a name="remarks"></a>Comentários

Busca a próxima linha sequencial do `CRowset` objeto, lembrando da posição anterior. Opcionalmente, você pode optar por ignorá-la *lSkip* linhas ou mover para trás.

Esse método requer que você defina as propriedades a seguir antes de chamar `Open` na tabela ou que contém o conjunto de linhas de comando:

- `DBPROP_CANSCROLLBACKWARDS` deve ser VARIANT_TRUE caso *lSkip* < 0

- `DBPROP_CANFETCHBACKWARDS` deve ser VARIANT_TRUE caso *bForward* = false

Caso contrário (se *lSkip* > = 0 e *bForward* = true), você não precisa definir quaisquer propriedades adicionais.

## <a name="moveprev"></a> CRowset::MovePrev

Move o cursor para o registro anterior.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer que você defina `DBPROP_CANFETCHBACKWARDS` ou `DBPROP_CANSCROLLBACKWARDS` como VARIANT_TRUE antes de chamar `Open` na tabela ou que contém o conjunto de linhas de comando.

## <a name="movetobookmark"></a> CRowset::MoveToBookmark

Busca a linha marcada por um indicador ou a linha em um deslocamento especificado (*lSkip*) desse indicador.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>Parâmetros

*Indicador*<br/>
[in] Um indicador que marca o local do qual você deseja buscar dados.

*lSkip*<br/>
[in] A contagem do número de linhas de indicador para a linha de destino. Se *lSkip* for zero, a primeira linha buscada é a linha indicada. Se *lSkip* é 1, a primeira linha buscada é a linha após a linha indicada. Se *lSkip* é -1, a primeira linha buscada é a linha antes da linha indicada.

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer que a interface opcional `IRowsetLocate`, que podem não ter suporte em todos os provedores; se esse for o caso, o método retorna E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetLocate` VARIANT_TRUE e o conjunto `DBPROP_CANFETCHBACKWARDS` como VARIANT_TRUE antes de chamar `Open` na tabela ou que contém o conjunto de linhas de comando.

Para obter informações sobre como usar indicadores de consumidores, consulte [usando indicadores](../../data/oledb/using-bookmarks.md).

## <a name="movetoratio"></a> CRowset::MoveToRatio

Busca linhas a partir de uma posição fracionária no conjunto de linhas.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>Parâmetros

*nNumerator*<br/>
[in] O numerador usado para determinar o fracionários posicionais das quais buscar dados.

*nDenominator*<br/>
[in] O denominador usado para determinar o fracionários posicionais das quais buscar dados.

*bForward*<br/>
[in] Indica se deve Avançar ou retroceder. O padrão é simples.

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

`MoveToRatio` busca linhas de acordo com aproximadamente a fórmula a seguir:

`(nNumerator *  RowsetSize ) / nDenominator`

Onde `RowsetSize` é o tamanho do conjunto de linhas, medido em linhas. A precisão dessa fórmula depende do provedor específico. Para obter detalhes, consulte [irowsetscroll:: Getrowsatratio](/previous-versions/windows/desktop/ms709602(v=vs.85)).

Esse método requer que a interface opcional `IRowsetScroll`, que podem não ter suporte em todos os provedores; se esse for o caso, o método retorna E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetScroll` como VARIANT_TRUE antes de chamar `Open` na tabela ou que contém o conjunto de linhas de comando.

## <a name="releaserows"></a> CRowset::ReleaseRows

Chamadas [IRowset:: Releaserows](/previous-versions/windows/desktop/ms719771(v=vs.85)) para liberar o identificador de linha atual.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

## <a name="setdata"></a> CRowset::SetData

Define valores de dados em uma ou mais colunas de uma linha.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>Parâmetros

*nAccessor*<br/>
[in] O número de acessador a ser usado para acessar os dados.

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Para o `SetData` formulário que aceita nenhum argumento, todos os acessadores são usados para a atualização. Normalmente você chama `SetData` para definir valores de dados em colunas em uma linha, em seguida, chame [atualização](../../data/oledb/crowset-update.md) para transmitir essas alterações.

Esse método requer que a interface opcional `IRowsetChange`, que podem não ter suporte em todos os provedores; se esse for o caso, o método retorna E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetChange` como VARIANT_TRUE antes de chamar `Open` na tabela ou que contém o conjunto de linhas de comando.

A operação de configuração poderá falhar se uma ou mais colunas não é gravável. Modifique seu mapa de cursor para corrigir isso.

## <a name="undo"></a> CRowset::Undo

Desfaz todas as alterações feitas em uma linha desde o último fetch ou [atualização](../../data/oledb/crowset-update.md).

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parâmetros

*pcRows*<br/>
[out] Um ponteiro para o local onde `Undo` retorna o número de linhas que ele tentou desfazer se necessário.

*phRow*<br/>
[out] Um ponteiro para o local onde `Undo` retorna uma matriz de identificadores para todas as linhas que ele tentou desfazer se necessário.

*pStatus*<br/>
[out] Um ponteiro para o local onde `Undo` retorna o valor de status de linha. Nenhum status será retornado se *pStatus* é nulo.

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Esse método requer que a interface opcional `IRowsetUpdate`, que podem não ter suporte em todos os provedores; se esse for o caso, o método retorna E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetUpdate` como VARIANT_TRUE antes de chamar `Open` na tabela ou que contém o conjunto de linhas de comando.

## <a name="update"></a> CRowset::Update

Transmite todas as alterações feitas na linha atual desde o último fetch pendentes ou `Update` chamar nela.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parâmetros

*pcRows*<br/>
[out] Um ponteiro para o local onde `Update` retorna o número de linhas que ele tentou atualizar, se necessário.

*phRow*<br/>
[out] Um ponteiro para o local onde `Update` retorna o identificador da linha que ele tentou atualizar. Nenhum identificador é retornado se *phRow* é nulo.

*pStatus*<br/>
[out] Um ponteiro para o local onde `Update` retorna o valor de status de linha. Nenhum status será retornado se *pStatus* é nulo.

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

### <a name="remarks"></a>Comentários

Transmite todas as alterações feitas na linha atual, desde que a linha foi buscada ou atualizada pela última pendentes (usando `Update` ou [UpdateAll](../../data/oledb/crowset-updateall.md)). Normalmente você chama [SetData](../../data/oledb/crowset-setdata.md) para definir valores de dados em colunas em uma linha e, em seguida, chamar `Update` para transmitir essas alterações.

Esse método requer que a interface opcional `IRowsetUpdate`, que podem não ter suporte em todos os provedores; se esse for o caso, o método retorna E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetUpdate` como VARIANT_TRUE antes de chamar `Open` na tabela ou que contém o conjunto de linhas de comando.

## <a name="updateall"></a> CRowset::UpdateAll

Transmite todas as alterações feitas a todas as linhas desde o último fetch pendentes ou `Update` chamar nela.

### <a name="syntax"></a>Sintaxe

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>Parâmetros

*pcRows*<br/>
[out] Um ponteiro para o local onde `UpdateAll` retorna o número de linhas que ele tentou atualizar, se necessário.

*pphRow*<br/>
[out] Um ponteiro de memória no qual `UpdateAll` retorna o identificador da linha que ele tentou atualizar. Nenhum identificador é retornado se *pphRow* é nulo.

*ppStatus*<br/>
[out] Um ponteiro para o local onde `Update` retorna o valor de status de linha. Nenhum status será retornado se *ppStatus* é nulo.

### <a name="remarks"></a>Comentários

Transmite todas as alterações feitas a todas as linhas, desde que essas linhas foram buscadas pela última vez ou atualizada usando pendentes [atualização](../../data/oledb/crowset-update.md) ou `UpdateAll`. `UpdateAll` atualizará todas as linhas que foram modificadas, independentemente se você ainda tem o identificador para eles (consulte *pphRow*) ou não.

Por exemplo, se você usou `Insert` para inserir cinco linhas em um conjunto de linhas, você poderia chamar `Update` cinco vezes ou chamada `UpdateAll` uma vez para atualizá-las.

Esse método requer que a interface opcional `IRowsetUpdate`, que podem não ter suporte em todos os provedores; se esse for o caso, o método retorna E_NOINTERFACE. Você também deve definir `DBPROP_IRowsetUpdate` como VARIANT_TRUE antes de chamar `Open` na tabela ou que contém o conjunto de linhas de comando.

### <a name="return-value"></a>Valor de retorno

Um HRESULT padrão.

## <a name="see-also"></a>Consulte também

[Exemplo de DBViewer](../../overview/visual-cpp-samples.md)<br/>
[Exemplo multiRead](../../overview/visual-cpp-samples.md)<br/>
[Exemplo de atributos multiRead](../../overview/visual-cpp-samples.md)<br/>
[Modelos de consumidor de banco de dados OLE](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[Referência dos modelos de consumidor de banco de dados OLE](../../data/oledb/ole-db-consumer-templates-reference.md)