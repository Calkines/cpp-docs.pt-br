---
title: Classe COleClientItem
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: 9f97f117f0fd8570855079aca7bdfd7a63118bc5
ms.sourcegitcommit: 180f63704f6ddd07a4172a93b179cf0733fd952d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/06/2019
ms.locfileid: "70740877"
---
# <a name="coleclientitem-class"></a>Classe COleClientItem

Define a interface de contêiner para itens OLE.

## <a name="syntax"></a>Sintaxe

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Membros

### <a name="public-constructors"></a>Construtores públicos

|Nome|Descrição|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|Constrói um objeto `COleClientItem`.|

### <a name="public-methods"></a>Métodos públicos

|Nome|Descrição|
|----------|-----------------|
|[COleClientItem::Activate](#activate)|Abre o item OLE para uma operação e, em seguida, executa o verbo especificado.|
|[COleClientItem::ActivateAs](#activateas)|Ativa o item como outro tipo.|
|[COleClientItem::AttachDataObject](#attachdataobject)|Acessa os dados no objeto OLE.|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Indica se um aplicativo de contêiner pode criar um objeto inserido.|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Indica se um aplicativo de contêiner pode criar um objeto vinculado.|
|[COleClientItem::CanPaste](#canpaste)|Indica se a área de transferência contém um item OLE estático ou incorporável.|
|[COleClientItem::CanPasteLink](#canpastelink)|Indica se a área de transferência contém um item OLE vinculado.|
|[COleClientItem::Close](#close)|Fecha um link para um servidor, mas não destrói o item OLE.|
|[COleClientItem::ConvertTo](#convertto)|Converte o item em outro tipo.|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Copia o item OLE para a área de transferência.|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Cria uma duplicata de um item existente.|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Cria um item inserido da área de transferência.|
|[COleClientItem::CreateFromData](#createfromdata)|Cria um item inserido a partir de um objeto de dados.|
|[COleClientItem::CreateFromFile](#createfromfile)|Cria um item inserido a partir de um arquivo.|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Cria um item vinculado da área de transferência.|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Cria um item vinculado de um objeto de dados.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Cria um item vinculado de um arquivo.|
|[COleClientItem::CreateNewItem](#createnewitem)|Cria um novo item inserido iniciando o aplicativo do servidor.|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Cria um item estático da área de transferência.|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Cria um item estático a partir de um objeto de dados.|
|[COleClientItem::Deactivate](#deactivate)|Desativa o item.|
|[COleClientItem::DeactivateUI](#deactivateui)|Restaura a interface do usuário do aplicativo de contêiner para seu estado original.|
|[COleClientItem::Delete](#delete)|Exclui ou fecha o item OLE se ele fosse um item vinculado.|
|[COleClientItem::DoDragDrop](#dodragdrop)|Executa uma operação de arrastar e soltar.|
|[COleClientItem::DoVerb](#doverb)|Executa o verbo especificado.|
|[COleClientItem::Draw](#draw)|Desenha o item OLE.|
|[COleClientItem::GetActiveView](#getactiveview)|Obtém a exibição na qual o item é ativado no local.|
|[COleClientItem::GetCachedExtent](#getcachedextent)|Retorna os limites do retângulo do item OLE.|
|[COleClientItem::GetClassID](#getclassid)|Obtém a ID da classe do item atual.|
|[COleClientItem::GetClipboardData](#getclipboarddata)|Obtém os dados que seriam colocados na área de transferência chamando a função `CopyToClipboard` de membro.|
|[COleClientItem::GetDocument](#getdocument)|Retorna o `COleDocument` objeto que contém o item atual.|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Obtém a exibição atual do item para renderização.|
|[COleClientItem::GetExtent](#getextent)|Retorna os limites do retângulo do item OLE.|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Recupera um identificador para um ícone associado ao servidor de um CLSID específico.|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Obtém o metarquivo usado para desenhar o ícone do item.|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Retorna um ponteiro para a janela de edição in-loco do item.|
|[COleClientItem::GetItemState](#getitemstate)|Obtém o estado atual do item.|
|[COleClientItem::GetLastStatus](#getlaststatus)|Retorna o status da última operação OLE.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Retorna o modo de atualização para um item vinculado (recurso avançado).|
|[COleClientItem::GetType](#gettype)|Retorna o tipo (inserido, vinculado ou estático) do item OLE.|
|[COleClientItem::GetUserType](#getusertype)|Obtém uma cadeia de caracteres que descreve o tipo do item.|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Retornará TRUE se o item estiver ativo no local.|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Retornará TRUE se um item vinculado estiver atualizado com seu documento de origem.|
|[COleClientItem::IsModified](#ismodified)|Retornará TRUE se o item tiver sido modificado desde que foi salvo pela última vez.|
|[COleClientItem::IsOpen](#isopen)|Retornará TRUE se o item estiver aberto no momento no aplicativo do servidor.|
|[COleClientItem::IsRunning](#isrunning)|Retornará TRUE se o aplicativo do servidor do item estiver em execução.|
|[COleClientItem::OnActivate](#onactivate)|Chamado pelo Framework para notificar o item que ele está ativado.|
|[COleClientItem::OnActivateUI](#onactivateui)|Chamado pelo Framework para notificar o item que ele está ativado e deve mostrar sua interface do usuário.|
|[COleClientItem::OnChange](#onchange)|Chamado quando o servidor altera o item OLE. Implementação necessária.|
|[COleClientItem::OnDeactivate](#ondeactivate)|Chamado pelo Framework quando um item é desativado.|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Chamado pelo Framework quando o servidor removeu sua interface do usuário in-loco.|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Chamado pelo Framework para obter os dados a serem copiados para a área de transferência.|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Chamado pelo Framework para criar um menu composto.|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Chamado pelo Framework para remover os menus do contêiner de um menu composto.|
|[COleClientItem::OnSetMenu](#onsetmenu)|Chamado pelo Framework para instalar e remover um menu composto.|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Chamado pelo Framework para mostrar e Ocultar barras de controle.|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Chamado pelo Framework para atualizar a barra de título da janela do quadro.|
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|Reativa o item e desfaz a última operação de edição in-loco.|
|[COleClientItem::Release](#release)|Libera a conexão a um item OLE vinculado e o fecha se ele estava aberto. Não destrói o item do cliente.|
|[COleClientItem::Reload](#reload)|Recarrega o item após uma chamada para `ActivateAs`.|
|[COleClientItem::Run](#run)|Executa o aplicativo associado ao item.|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Define a exibição atual do item para renderização.|
|[COleClientItem::SetExtent](#setextent)|Define o retângulo delimitador do item OLE.|
|[COleClientItem::SetHostNames](#sethostnames)|Define os nomes que o servidor exibe ao editar o item OLE.|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Armazena em cache o metarquivo usado para desenhar o ícone do item.|
|[COleClientItem::SetItemRects](#setitemrects)|Define o retângulo delimitador do item.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Define o modo de atualização para um item vinculado (recurso avançado).|
|[COleClientItem::SetPrintDevice](#setprintdevice)|Define o dispositivo de destino de impressão para este item de cliente.|
|[COleClientItem::UpdateLink](#updatelink)|Atualiza o cache de apresentação de um item.|

### <a name="protected-methods"></a>Métodos Protegidos

|Nome|Descrição|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|Chamado pelo Framework para determinar se a ativação in-loco é permitida.|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|Chamado pelo Framework quando a posição de um item é alterada.|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Chamado pelo Framework para desfazer após a ativação.|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Chamado pelo Framework para descartar as informações de estado de desfazer do item.|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Chamado pelo Framework para obter as coordenadas do retângulo de recorte do item.|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Chamado pelo Framework para obter a posição do item relativa à exibição.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Chamado pelo Framework quando um item é ativado no local.|
|[COleClientItem::OnScrollBy](#onscrollby)|Chamado pelo Framework para rolar o item para a exibição.|
|[COleClientItem::OnShowItem](#onshowitem)|Chamado pelo Framework para exibir o item OLE.|

## <a name="remarks"></a>Comentários

Um item OLE representa dados, criados e mantidos por um aplicativo de servidor, que pode ser "diretamente" incorporado a um documento para que ele pareça que o usuário seja um único documento. O resultado é um "documento composto" composto pelo item OLE e um documento recipiente.

Um item OLE pode ser inserido ou vinculado. Se for inserido, seus dados serão armazenados como parte do documento composto. Se ele estiver vinculado, seus dados serão armazenados como parte de um arquivo separado criado pelo aplicativo de servidor e apenas um link para esse arquivo será armazenado no documento composto. Todos os itens OLE contêm informações que especificam o aplicativo de servidor que deve ser chamado para editá-los.

`COleClientItem`define várias funções substituíveis que são chamadas em resposta a solicitações do aplicativo de servidor; Esses substituíveis geralmente agem como notificações. Isso permite que o aplicativo de servidor informe o contêiner de alterações que o usuário faz ao editar o item OLE ou recupere as informações necessárias durante a edição.

`COleClientItem`pode ser usado com a classe [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)ou [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) . Para usar `COleClientItem`, derive uma classe dela e implemente a função de membro [onChange](#onchange) , que define como o contêiner responde às alterações feitas no item. Para dar suporte à ativação in-loco, substitua a função membro [OnGetItemPosition](#ongetitemposition) . Essa função fornece informações sobre a posição exibida do item OLE.

Para obter mais informações sobre como usar a interface do contêiner, [consulte os artigos contêineres: Implementando um](../../mfc/containers-implementing-a-container.md) contêiner e uma [ativação](../../mfc/activation-cpp.md).

> [!NOTE]
>  A SDK do Windows se refere a itens incorporados e vinculados como "objetos" e se refere a tipos de itens como "classes". Essa referência usa o termo "item" para distinguir a entidade OLE do objeto correspondente C++ e o termo "tipo" para distinguir a categoria OLE da C++ classe.

## <a name="inheritance-hierarchy"></a>Hierarquia de herança

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Requisitos

**Cabeçalho:** Afxole. h

##  <a name="activate"></a>  COleClientItem::Activate

Chame essa função para executar o verbo especificado em vez de [doverbs](#doverb) para que você possa fazer seu próprio processamento quando uma exceção for gerada.

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parâmetros

*nVerb*<br/>
Especifica o verbo a ser executado. Pode ser um dos seguintes:

|Valor|Significado|Símbolo|
|-----------|-------------|------------|
|- 0|Verbo primário|OLEIVERB_PRIMARY|
|- 1|Verbo secundário|(Nenhum)|
|- 1|Exibir item para edição|OLEIVERB_SHOW|
|- 2|Editar item em janela separada|OLEIVERB_OPEN|
|- 3|Ocultar item|OLEIVERB_HIDE|

O valor-1 normalmente é um alias para outro verbo. Se a edição aberta não tiver suporte,-2 terá o mesmo efeito que-1. Para obter valores adicionais, consulte [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) no SDK do Windows.

*pView*<br/>
Ponteiro para a janela de exibição de contêiner que contém o item OLE; Isso é usado pelo aplicativo de servidor para ativação in-loco. Esse parâmetro deverá ser nulo se o contêiner não oferecer suporte à ativação in-loco.

*lpMsg*<br/>
Ponteiro para a mensagem que causou a ativação do item.

### <a name="remarks"></a>Comentários

Se o aplicativo de servidor foi escrito usando o biblioteca MFC, essa função faz com que a função membro [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) do objeto `COleServerItem` correspondente seja executada.

Se o verbo primário for Edit e zero for especificado no parâmetro *nVerb* , o aplicativo de servidor será iniciado para permitir que o item OLE seja editado. Se o aplicativo de contêiner oferecer suporte à ativação in-loco, a edição poderá ser feita em vigor. Se o contêiner não oferecer suporte à ativação in-loco (ou se o verbo aberto for especificado), o servidor será iniciado em uma janela separada e a edição poderá ser feita lá. Normalmente, quando o usuário do aplicativo de contêiner clica duas vezes no item OLE, o valor do verbo primário no parâmetro *nVerb* determina a ação que o usuário pode executar. No entanto, se o servidor der suporte a apenas uma ação, ele executará essa ação, não importa qual valor é especificado no parâmetro *nVerb* .

Para obter mais informações, consulte [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) no SDK do Windows.

##  <a name="activateas"></a>  COleClientItem::ActivateAs

Usa recursos de conversão de objeto OLE para ativar o item como se fosse um item do tipo especificado por *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Parâmetros

*lpszUserType*<br/>
Ponteiro para uma cadeia de caracteres que representa o tipo de usuário de destino, como "documento do Word".

*clsidOld*<br/>
Uma referência à ID de classe atual do item. A ID de classe deve representar o tipo do objeto real, como armazenado, a menos que seja um link. Nesse caso, ele deve ser o CLSID do item ao qual o link se refere. O [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) fornece automaticamente a ID de classe correta para o item.

*clsidNew*<br/>
Uma referência à ID de classe de destino.

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Isso é chamado automaticamente pelo [COleConvertDialog::D oconvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Normalmente, ele não é chamado diretamente.

##  <a name="attachdataobject"></a>  COleClientItem::AttachDataObject

Chame essa função para inicializar um [COleDataObject](../../mfc/reference/coledataobject-class.md) para acessar os dados no item OLE.

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Parâmetros

*rDataObject*<br/>
Referência a um `COleDataObject` objeto que será inicializado para permitir o acesso aos dados no item OLE.

##  <a name="canactivate"></a>  COleClientItem::CanActivate

Chamado pelo Framework quando o usuário solicita a ativação in-loco do item OLE; o valor de retorno da função determina se a ativação in-loco é permitida.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se a ativação in-loco for permitida; caso contrário, 0.

### <a name="remarks"></a>Comentários

A implementação padrão permite a ativação in-loco se o contêiner tiver uma janela válida. Substitua essa função para implementar uma lógica especial para aceitar ou recusar a solicitação de ativação. Por exemplo, uma solicitação de ativação pode ser recusada se o item OLE for muito pequeno ou não estiver visível no momento.

Para obter mais informações, consulte [IOleInPlaceSite:: CanInPlaceActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) no SDK do Windows.

##  <a name="cancreatefromdata"></a>  COleClientItem::CanCreateFromData

Verifica se um aplicativo de contêiner pode criar um objeto inserido a partir `COleDataObject` do objeto fornecido.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parâmetros

*pDataObject*<br/>
Ponteiro para o objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) do qual o item OLE deve ser criado.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o contêiner puder criar um objeto inserido `COleDataObject` a partir do objeto; caso contrário, 0.

### <a name="remarks"></a>Comentários

A `COleDataObject` classe é usada em transferências de dados para recuperar dados em vários formatos da área de transferência, por meio de arrastar e soltar, ou de um item OLE incorporado.

Os contêineres podem usar essa função para decidir habilitar ou desabilitar seus comandos de Editar Colar e editar colar especial.

Para obter mais informações, consulte o artigo [objetos de dados e fontes de dados (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="cancreatelinkfromdata"></a>  COleClientItem::CanCreateLinkFromData

Verifica se um aplicativo de contêiner pode criar um objeto vinculado a partir `COleDataObject` do objeto fornecido.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parâmetros

*pDataObject*<br/>
Ponteiro para o objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) do qual o item OLE deve ser criado.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o contêiner puder criar um objeto vinculado `COleDataObject` a partir do objeto.

### <a name="remarks"></a>Comentários

A `COleDataObject` classe é usada em transferências de dados para recuperar dados em vários formatos da área de transferência, por meio de arrastar e soltar, ou de um item OLE incorporado.

Os contêineres podem usar essa função para decidir habilitar ou desabilitar os comandos Editar Colar especial e editar link de colagem.

Para obter mais informações, consulte o artigo [objetos de dados e fontes de dados (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="canpaste"></a>  COleClientItem::CanPaste

Chame essa função para ver se um item OLE incorporado pode ser colado da área de transferência.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se um item OLE incorporado puder ser colado da área de transferência; caso contrário, 0.

### <a name="remarks"></a>Comentários

Para obter mais informações, consulte [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) e [OleQueryCreateFromData](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) no SDK do Windows.

##  <a name="canpastelink"></a>  COleClientItem::CanPasteLink

Chame essa função para ver se um item OLE vinculado pode ser colado da área de transferência.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se um item OLE vinculado puder ser colado da área de transferência; caso contrário, 0.

### <a name="remarks"></a>Comentários

Para obter mais informações, consulte [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) e [OleQueryLinkFromData](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) no SDK do Windows.

##  <a name="close"></a>  COleClientItem::Close

Chame essa função para alterar o estado de um item OLE do estado em execução para o estado Loaded, ou seja, carregado com seu manipulador na memória, mas com o servidor não em execução.

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Parâmetros

*dwCloseOption*<br/>
Sinalizador que especifica em que circunstâncias o item OLE é salvo quando retorna ao estado carregado. Ele pode ter um dos seguintes valores:

- OLECLOSE_SAVEIFDIRTY salvar o item OLE.

- OLECLOSE_NOSAVE não salve o item OLE.

- OLECLOSE_PROMPTSAVE Solicita ao usuário se deseja salvar o item OLE.

### <a name="remarks"></a>Comentários

Essa função não tem efeito quando o item OLE não está em execução.

Para obter mais informações, consulte [IOleObject:: Close](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) na SDK do Windows.

##  <a name="coleclientitem"></a>  COleClientItem::COleClientItem

Constrói um `COleClientItem` objeto e o adiciona à coleção de itens de documento do documento de contêiner, que constrói apenas o C++ objeto e não executa nenhuma inicialização OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Parâmetros

*pContainerDoc*<br/>
Ponteiro para o documento de contêiner que conterá este item. Isso pode ser qualquer derivação [COleDocument](../../mfc/reference/coledocument-class.md) .

### <a name="remarks"></a>Comentários

Se você passar um ponteiro nulo, nenhuma adição será feita no documento de contêiner. Você deve chamar explicitamente [COleDocument:: AddItem](../../mfc/reference/coledocument-class.md#additem).

Você deve chamar uma das seguintes funções de membro de criação antes de usar o item OLE:

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

##  <a name="convertto"></a>  COleClientItem::ConvertTo

Chame essa função de membro para converter o item para o tipo especificado por *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Parâmetros

*clsidNew*<br/>
A ID de classe do tipo de destino.

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Isso é chamado automaticamente pelo [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). Não é necessário chamá-lo diretamente.

##  <a name="copytoclipboard"></a>  COleClientItem::CopyToClipboard

Chame essa função para copiar o item OLE para a área de transferência.

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Parâmetros

*bIncludeLink*<br/>
TRUE se as informações do link devem ser copiadas para a área de transferência, permitindo que um item vinculado seja colado; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

Normalmente, você chama essa função ao escrever manipuladores de mensagens para os comandos copiar ou recortar no menu Editar. Você deve implementar a seleção de item no aplicativo de contêiner se desejar implementar os comandos copiar ou recortar.

Para obter mais informações, consulte [OleSetClipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard) no SDK do Windows.

##  <a name="createclonefrom"></a>  COleClientItem::CreateCloneFrom

Chame essa função para criar uma cópia do item OLE especificado.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Parâmetros

*pSrcItem*<br/>
Ponteiro para o item OLE a ser duplicado.

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

A cópia é idêntica ao item de origem. Você pode usar essa função para dar suporte a operações de desfazer.

##  <a name="createfromclipboard"></a>  COleClientItem::CreateFromClipboard

Chame essa função para criar um item incorporado do conteúdo da área de transferência.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*render*<br/>
Sinalizador que especifica como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no SDK do Windows.

*cfFormat*<br/>
Especifica o formato de dados da área de transferência a ser armazenado em cache ao criar o item OLE.

*lpFormatEtc*<br/>
Ponteiro para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *render* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para esse parâmetro somente se você quiser especificar informações de formato adicionais além do formato de área de transferência especificado por *cfFormat*. Se você omitir esse parâmetro, os valores padrão serão usados para os outros campos `FORMATETC` na estrutura.

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Normalmente, você chama essa função do manipulador de mensagens para o comando colar no menu Editar. (O comando colar é habilitado pela estrutura se a função de membro [CanPaste](#canpaste) retornar um zero).

Para obter mais informações, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no SDK do Windows.

##  <a name="createfromdata"></a>  COleClientItem::CreateFromData

Chame essa função para criar um item incorporado de um `COleDataObject` objeto.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*pDataObject*<br/>
Ponteiro para o objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) do qual o item OLE deve ser criado.

*render*<br/>
Sinalizador que especifica como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no SDK do Windows.

*cfFormat*<br/>
Especifica o formato de dados da área de transferência a ser armazenado em cache ao criar o item OLE.

*lpFormatEtc*<br/>
Ponteiro para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *render* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para esse parâmetro somente se você quiser especificar informações de formato adicionais além do formato de área de transferência especificado por *cfFormat*. Se você omitir esse parâmetro, os valores padrão serão usados para os outros campos `FORMATETC` na estrutura.

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

As operações de transferência de dados, como colar da área de transferência ou operações de arrastar e soltar, `COleDataObject` fornecem objetos que contêm as informações oferecidas por um aplicativo de servidor. Normalmente, ele é usado em sua substituição de [cvisualização:: OnDrop](../../mfc/reference/cview-class.md#ondrop).

Para obter mais informações, consulte [OleCreateFromData](/windows/win32/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no SDK do Windows.

##  <a name="createfromfile"></a>  COleClientItem::CreateFromFile

Chame essa função para criar um item OLE incorporado de um arquivo.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*lpszFileName*<br/>
Ponteiro para o nome do arquivo do qual o item OLE deve ser criado.

*clsid*<br/>
Reservado para uso futuro.

*render*<br/>
Sinalizador que especifica como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no SDK do Windows.

*cfFormat*<br/>
Especifica o formato de dados da área de transferência a ser armazenado em cache ao criar o item OLE.

*lpFormatEtc*<br/>
Ponteiro para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *render* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para esse parâmetro somente se você quiser especificar informações de formato adicionais além do formato de área de transferência especificado por *cfFormat*. Se você omitir esse parâmetro, os valores padrão serão usados para os outros campos `FORMATETC` na estrutura.

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

A estrutura chama essa função de [COleInsertDialog:: CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) se o usuário escolher OK na caixa de diálogo Inserir objeto quando o botão criar do arquivo for selecionado.

Para obter mais informações, consulte [OleCreateFromFile](/windows/win32/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no SDK do Windows.

##  <a name="createlinkfromclipboard"></a>  COleClientItem::CreateLinkFromClipboard

Chame essa função para criar um item vinculado do conteúdo da área de transferência.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*render*<br/>
Sinalizador que especifica como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no SDK do Windows.

*cfFormat*<br/>
Especifica o formato de dados da área de transferência a ser armazenado em cache ao criar o item OLE.

*lpFormatEtc*<br/>
Ponteiro para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *render* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para esse parâmetro somente se você quiser especificar informações de formato adicionais além do formato de área de transferência especificado por *cfFormat*. Se você omitir esse parâmetro, os valores padrão serão usados para os outros campos `FORMATETC` na estrutura.

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Normalmente, você chama essa função do manipulador de mensagens para o comando colar link no menu Editar. (O comando Colar vínculo será habilitado na implementação padrão de [COleDocument](../../mfc/reference/coledocument-class.md) se a área de transferência contiver um item OLE que possa ser vinculado a.)

Para obter mais informações, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no SDK do Windows.

##  <a name="createlinkfromdata"></a>  COleClientItem::CreateLinkFromData

Chame essa função para criar um item vinculado de um `COleDataObject` objeto.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*pDataObject*<br/>
Ponteiro para o objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) do qual o item OLE deve ser criado.

*render*<br/>
Sinalizador que especifica como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no SDK do Windows.

*cfFormat*<br/>
Especifica o formato de dados da área de transferência a ser armazenado em cache ao criar o item OLE.

*lpFormatEtc*<br/>
Ponteiro para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *render* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para esse parâmetro somente se você quiser especificar informações de formato adicionais além do formato de área de transferência especificado por *cfFormat*. Se você omitir esse parâmetro, os valores padrão serão usados para os outros campos `FORMATETC` na estrutura.

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Chame isso durante uma operação de remoção quando o usuário indicar que um link deve ser criado. Ele também pode ser usado para manipular o comando Editar Colar. Ele é chamado pela estrutura em `COleClientItem::CreateLinkFromClipboard` e em [COlePasteSpecialDialog:: CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) quando a opção de link foi selecionada.

Para obter mais informações, consulte [OleCreateLinkFromData](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no SDK do Windows.

##  <a name="createlinkfromfile"></a>  COleClientItem::CreateLinkFromFile

Chame essa função para criar um item OLE vinculado de um arquivo.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*lpszFileName*<br/>
Ponteiro para o nome do arquivo do qual o item OLE deve ser criado.

*render*<br/>
Sinalizador que especifica como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no SDK do Windows.

*cfFormat*<br/>
Especifica o formato de dados da área de transferência a ser armazenado em cache ao criar o item OLE.

*lpFormatEtc*<br/>
Ponteiro para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *render* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para esse parâmetro somente se você quiser especificar informações de formato adicionais além do formato de área de transferência especificado por *cfFormat*. Se você omitir esse parâmetro, os valores padrão serão usados para os outros campos `FORMATETC` na estrutura.

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

A estrutura chamará essa função se o usuário escolher OK na caixa de diálogo Inserir objeto quando o botão criar do arquivo for selecionado e a caixa de seleção Vincular estiver marcada. Ele é chamado de [COleInsertDialog:: CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Para obter mais informações, consulte [OleCreateLinkToFile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no SDK do Windows.

##  <a name="createnewitem"></a>  COleClientItem::CreateNewItem

Chame esta função para criar um item inserido; Essa função inicia o aplicativo de servidor que permite ao usuário criar o item OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*clsid*<br/>
ID que identifica exclusivamente o tipo de item OLE a ser criado.

*render*<br/>
Sinalizador que especifica como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no SDK do Windows.

*cfFormat*<br/>
Especifica o formato de dados da área de transferência a ser armazenado em cache ao criar o item OLE.

*lpFormatEtc*<br/>
Ponteiro para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *render* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para esse parâmetro somente se você quiser especificar informações de formato adicionais além do formato de área de transferência especificado por *cfFormat*. Se você omitir esse parâmetro, os valores padrão serão usados para os outros campos `FORMATETC` na estrutura.

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

A estrutura chamará essa função se o usuário escolher OK na caixa de diálogo Inserir objeto quando o botão Criar novo for selecionado.

Para obter mais informações, consulte [OleCreate](/windows/win32/api/ole/nf-ole-olecreate), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no SDK do Windows.

##  <a name="createstaticfromclipboard"></a>  COleClientItem::CreateStaticFromClipboard

Chame essa função para criar um item estático do conteúdo da área de transferência.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*render*<br/>
Sinalizador que especifica como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no SDK do Windows.

*cfFormat*<br/>
Especifica o formato de dados da área de transferência a ser armazenado em cache ao criar o item OLE.

*lpFormatEtc*<br/>
Ponteiro para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *render* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para esse parâmetro somente se você quiser especificar informações de formato adicionais além do formato de área de transferência especificado por *cfFormat*. Se você omitir esse parâmetro, os valores padrão serão usados para os outros campos `FORMATETC` na estrutura.

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Um item estático contém os dados da apresentação, mas não os dados nativos; Consequentemente, não pode ser editado. Normalmente, você chamará essa função se a função membro [CreateFromClipboard](#createfromclipboard) falhar.

Para obter mais informações, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no SDK do Windows.

##  <a name="createstaticfromdata"></a>  COleClientItem::CreateStaticFromData

Chame essa função para criar um item estático a partir `COleDataObject` de um objeto.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parâmetros

*pDataObject*<br/>
Ponteiro para o objeto [COleDataObject](../../mfc/reference/coledataobject-class.md) do qual o item OLE deve ser criado.

*render*<br/>
Sinalizador que especifica como o servidor renderizará o item OLE. Para obter os valores possíveis, consulte [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) no SDK do Windows.

*cfFormat*<br/>
Especifica o formato de dados da área de transferência a ser armazenado em cache ao criar o item OLE.

*lpFormatEtc*<br/>
Ponteiro para uma estrutura [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) usada se *render* for OLERENDER_FORMAT ou OLERENDER_DRAW. Forneça um valor para esse parâmetro somente se você quiser especificar informações de formato adicionais além do formato de área de transferência especificado por *cfFormat*. Se você omitir esse parâmetro, os valores padrão serão usados para os outros campos `FORMATETC` na estrutura.

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Um item estático contém os dados da apresentação, mas não os dados nativos; Consequentemente, ele não pode ser editado. Isso é essencialmente o mesmo que [CreateStaticFromClipboard](#createstaticfromclipboard) , exceto que um item estático pode ser criado a partir `COleDataObject`de um arbitrário, não apenas da área de transferência.

Usado em [COlePasteSpecialDialog:: CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) quando estático é selecionado.

Para obter mais informações, consulte [OleCreateStaticFromData](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)e [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) no SDK do Windows.

##  <a name="deactivate"></a>  COleClientItem::Deactivate

Chame essa função para desativar o item OLE e liberar todos os recursos associados.

```
void Deactivate();
```

### <a name="remarks"></a>Comentários

Normalmente, você desativa um item OLE ativo no local quando o usuário clica no mouse na área do cliente fora dos limites do item. Observe que a desativação do item OLE descartará seu estado de desfazer, tornando impossível chamar a função de membro [ReactivateAndUndo](#reactivateandundo) .

Se seu aplicativo der suporte para desfazer, não `Deactivate`chame; em vez disso, chame [DeactivateUI](#deactivateui).

Para obter mais informações, consulte [IOleInPlaceObject:: InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) no SDK do Windows.

##  <a name="deactivateui"></a>  COleClientItem::DeactivateUI

Chame essa função quando o usuário desativar um item que foi ativado no local.

```
void DeactivateUI();
```

### <a name="remarks"></a>Comentários

Essa função restaura a interface do usuário do aplicativo de contêiner para seu estado original, ocultando todos os menus e outros controles que foram criados para ativação in-loco.

Essa função não libera as informações de estado de desfazer para o item. Essas informações são mantidas para que o [ReactivateAndUndo](#reactivateandundo) possa ser usado posteriormente para executar um comando Undo no aplicativo de servidor, caso o comando Undo do contêiner seja escolhido imediatamente após a desativação do item.

Para obter mais informações, consulte [IOleInPlaceObject:: InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) no SDK do Windows.

##  <a name="delete"></a>  COleClientItem::Delete

Chame essa função para excluir o item OLE do documento de contêiner.

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Parâmetros

*bAutoDelete*<br/>
Especifica se o item deve ser removido do documento.

### <a name="remarks"></a>Comentários

Essa função chama a função de membro de [liberação](#release) , que, por C++ sua vez, exclui o objeto do item, removendo permanentemente o item OLE do documento. Se o item OLE for inserido, os dados nativos do item serão excluídos. Ele sempre fecha um servidor em execução; Portanto, se o item for um link aberto, essa função o fechará.

##  <a name="dodragdrop"></a>  COleClientItem::DoDragDrop

Chame a `DoDragDrop` função de membro para executar uma operação de arrastar e soltar.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Parâmetros

*lpItemRect*<br/>
O retângulo do item na tela nas coordenadas do cliente (pixels).

*ptOffset*<br/>
O deslocamento de *lpItemRect* onde a posição do mouse estava no momento da operação de arrastar.

*bIncludeLink*<br/>
Defina como verdadeiro se os dados do link devem ser copiados para a área de transferência. Defina-a como FALSE se o aplicativo do servidor não oferecer suporte a links.

*dwEffects*<br/>
Determina os efeitos que a fonte de arrastar permitirá na operação de arrastar.

*lpRectStartDrag*<br/>
Ponteiro para o retângulo que define onde o arrastar realmente começa. Para obter mais informações, consulte a seção Comentários a seguir.

### <a name="return-value"></a>Valor de retorno

Um valor de DROPEFFECT. Se for DROPEFFECT_MOVE, os dados originais deverão ser removidos.

### <a name="remarks"></a>Comentários

A operação de arrastar e soltar não é iniciada imediatamente. Ele aguarda até que o cursor do mouse saia do retângulo especificado por *lpRectStartDrag* ou até que um número especificado de milissegundos tenha passado. Se *lpRectStartDrag* for NULL, o tamanho do retângulo será um pixel.

O tempo de atraso é especificado por uma configuração de chave do registro. Você pode alterar o tempo de atraso chamando [CWinApp:: WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) ou [CWinApp:: WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Se você não especificar o tempo de atraso, será usado um valor padrão de 200 milissegundos. O tempo de atraso de arrastar é armazenado da seguinte maneira:

- O tempo de atraso de arrastar do Windows NT é armazenado em HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay.

- O tempo de espera de arrastar do Windows 3. x é armazenado no WIN. INI, na seção [Windows}.

- O tempo de atraso de arrasto do Windows 95/98 é armazenado em uma versão armazenada em cache do WIN. Personalizado.

Para obter mais informações sobre como as informações de atraso de arrastar são armazenadas no registro ou no. Arquivo INI, consulte [WriteProfileString](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) no SDK do Windows.

##  <a name="doverb"></a>  COleClientItem::DoVerb

Chame `DoVerb` para executar o verbo especificado.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parâmetros

*nVerb*<br/>
Especifica o verbo a ser executado. Ele pode incluir um dos seguintes:

|Valor|Significado|Símbolo|
|-----------|-------------|------------|
|- 0|Verbo primário|OLEIVERB_PRIMARY|
|- 1|Verbo secundário|(Nenhum)|
|- 1|Exibir item para edição|OLEIVERB_SHOW|
|- 2|Editar item em janela separada|OLEIVERB_OPEN|
|- 3|Ocultar item|OLEIVERB_HIDE|

O valor-1 normalmente é um alias para outro verbo. Se a edição aberta não tiver suporte,-2 terá o mesmo efeito que-1. Para obter valores adicionais, consulte [IOleObject::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) no SDK do Windows.

*pView*<br/>
Ponteiro para a janela de exibição; Isso é usado pelo servidor para ativação in-loco. Esse parâmetro deverá ser nulo se o aplicativo de contêiner não permitir a ativação in-loco.

*lpMsg*<br/>
Ponteiro para a mensagem que causou a ativação do item.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o verbo foi executado com êxito; caso contrário, 0.

### <a name="remarks"></a>Comentários

Essa função chama a função de membro [Activate](#activate) para executar o verbo. Ele também captura exceções e exibe uma caixa de mensagem para o usuário, se uma for gerada.

Se o verbo primário for Edit e zero for especificado no parâmetro *nVerb* , o aplicativo de servidor será iniciado para permitir que o item OLE seja editado. Se o aplicativo de contêiner oferecer suporte à ativação in-loco, a edição poderá ser feita em vigor. Se o contêiner não oferecer suporte à ativação in-loco (ou se o verbo aberto for especificado), o servidor será iniciado em uma janela separada e a edição poderá ser feita lá. Normalmente, quando o usuário do aplicativo de contêiner clica duas vezes no item OLE, o valor do verbo primário no parâmetro *nVerb* determina a ação que o usuário pode executar. No entanto, se o servidor der suporte a apenas uma ação, ele executará essa ação, não importa qual valor é especificado no parâmetro *nVerb* .

##  <a name="draw"></a>  COleClientItem::Draw

Chame essa função para desenhar o item OLE no retângulo delimitador especificado usando o contexto de dispositivo especificado.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
Ponteiro para um objeto [CDC](../../mfc/reference/cdc-class.md) usado para desenhar o item OLE.

*lpBounds*<br/>
Ponteiro para um objeto [CRect](../../atl-mfc-shared/reference/crect-class.md) ou estrutura `RECT` que define o retângulo delimitador no qual desenhar o item OLE (em unidades lógicas determinadas pelo contexto do dispositivo).

*nDrawAspect*<br/>
Especifica o aspecto do item OLE, ou seja, como ele deve ser exibido. Se *nDrawAspect* for-1, o último conjunto de aspectos usando [SetDrawAspect](#setdrawaspect) será usado. Para obter mais informações sobre os valores possíveis para esse sinalizador, consulte [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

A função pode usar a representação de metarquivo do item OLE criado pela função de membro [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) do `COleServerItem`.

Normalmente, você `Draw` usa o para exibição de tela, passando o contexto do dispositivo de tela como *PDC*. Nesse caso, você precisa especificar apenas os dois primeiros parâmetros.

O parâmetro *lpBounds* identifica o retângulo no contexto do dispositivo de destino (em relação ao seu modo de mapeamento atual). A renderização pode envolver o dimensionamento da imagem e pode ser usada por aplicativos de contêiner para impor uma exibição que é dimensionada entre a exibição exibida e a imagem final impressa.

Para obter mais informações, consulte [IViewObject::D RAW](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) no SDK do Windows.

##  <a name="getactiveview"></a>  COleClientItem::GetActiveView

Retorna a exibição na qual o item está ativado no local.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para a exibição; caso contrário, NULL se o item não estiver ativado no local.

##  <a name="getcachedextent"></a>  COleClientItem::GetCachedExtent

Chame essa função para recuperar o tamanho do item OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parâmetros

*lpSize*<br/>
Ponteiro para uma `SIZE` estrutura ou um objeto [CSize](../../atl-mfc-shared/reference/csize-class.md) que receberá as informações de tamanho.

*nDrawAspect*<br/>
Especifica o aspecto do item OLE cujos limites devem ser recuperados. Para obter os valores possíveis, consulte [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; 0 se o item OLE estiver em branco.

### <a name="remarks"></a>Comentários

Essa função fornece as mesmas informações de [getextensão](#getextent). No entanto, você `GetCachedExtent` pode chamar para obter informações de extensão durante o processamento de outros manipuladores OLE, como [onChange](#onchange). As dimensões estão em unidades MM_HIMETRIC.

Isso é possível porque `GetCachedExtent` o usa a interface [IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2) em vez de usar a interface [IOleObject](/windows/win32/api/oleidl/nn-oleidl-ioleobject) para obter a extensão deste item. O `IViewObject2` objeto com armazena em cache as informações de extensão usadas na chamada anterior para [IViewObject::D RAW](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw).

Para obter mais informações, consulte [IViewObject2:: getextensão](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) no SDK do Windows.

##  <a name="getclassid"></a>  COleClientItem::GetClassID

Retorna a ID de classe do item para a memória apontada por *pClassId*.

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Parâmetros

*pClassID*<br/>
Ponteiro para um identificador do tipo [CLSID](/windows/win32/com/clsid-key-hklm) para recuperar a ID de classe. Para obter informações sobre CLSID, consulte a SDK do Windows.

### <a name="remarks"></a>Comentários

A ID de classe é um número de 128 bits que identifica exclusivamente o aplicativo que edita o item.

Para obter mais informações, consulte [IPersist:: GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) no SDK do Windows.

##  <a name="getclipboarddata"></a>  COleClientItem::GetClipboardData

Chame essa função para obter um `COleDataSource` objeto que contém todos os dados que seriam colocados na área de transferência por uma chamada para a função membro [CopyToClipboard](#copytoclipboard) .

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Parâmetros

*pDataSource*<br/>
Ponteiro para um objeto [COleDataSource](../../mfc/reference/coledatasource-class.md) que receberá os dados contidos no item OLE.

*bIncludeLink*<br/>
TRUE se os dados do link devem ser incluídos; caso contrário, FALSE.

*lpOffset*<br/>
O deslocamento do cursor do mouse da origem do objeto em pixels.

*lpSize*<br/>
O tamanho do objeto em pixels.

### <a name="remarks"></a>Comentários

`GetClipboardData`é chamado de implementação padrão de [OnGetClipboardData](#ongetclipboarddata). Substitua `OnGetClipboardData` somente se desejar oferecer formatos de dados além daqueles oferecidos pelo `CopyToClipboard`. `COleDataSource` Coloque esses formatos no objeto antes ou depois de chamar `CopyToClipboard`e, em seguida, passe o `COleDataSource` objeto para a função [COleDataSource:: SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) . Por exemplo, se você quiser que a posição do item OLE em seu documento de contêiner o acompanhe na área de transferência, você definirá seu próprio formato para passar essas informações e colocá- `COleDataSource` las no `CopyToClipboard`antes de chamar.

##  <a name="getdocument"></a>  COleClientItem::GetDocument

Chame essa função para obter um ponteiro para o documento que contém o item OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para o documento que contém o item OLE. NULL se o item não fizer parte de um documento.

### <a name="remarks"></a>Comentários

Esse ponteiro permite o `COleDocument` acesso ao objeto que você passou como um argumento para o `COleClientItem` Construtor.

##  <a name="getdrawaspect"></a>  COleClientItem::GetDrawAspect

Chame a `GetDrawAspect` função de membro para determinar o "aspecto" ou a exibição atual do item.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Valor de retorno

Um valor da enumeração DVASPECT, cujos valores são listados na referência para [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Comentários

O aspecto especifica como o item deve ser renderizado.

##  <a name="getextent"></a>  COleClientItem::GetExtent

Chame essa função para recuperar o tamanho do item OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Parâmetros

*lpSize*<br/>
Ponteiro para uma `SIZE` estrutura ou para `CSize` um objeto que receberá as informações de tamanho.

*nDrawAspect*<br/>
Especifica o aspecto do item OLE cujos limites devem ser recuperados. Para obter os valores possíveis, consulte [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; 0 se o item OLE estiver em branco.

### <a name="remarks"></a>Comentários

Se o aplicativo de servidor foi escrito usando o biblioteca MFC, essa função faz com que a função de membro [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) do objeto `COleServerItem` correspondente seja chamada. Observe que o tamanho recuperado pode ser diferente do tamanho definido pela última vez pela função membro [SetExtent](#setextent) ; o tamanho especificado por `SetExtent` é tratado como uma sugestão. As dimensões estão em unidades MM_HIMETRIC.

> [!NOTE]
>  Não chame `GetExtent` durante o processamento de um manipulador OLE, como [onChange](#onchange). Em vez disso, chame [GetCachedExtent](#getcachedextent) .

Para obter mais informações, consulte [IOleObject:: getextensão](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) no SDK do Windows.

##  <a name="geticonfromregistry"></a>  COleClientItem::GetIconFromRegistry

Chame essa função de membro para recuperar um identificador para um recurso de ícone associado ao servidor de um CLSID específico.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Parâmetros

*clsid*<br/>
Uma referência ao CLSID para o servidor associado ao ícone.

### <a name="return-value"></a>Valor de retorno

Um identificador válido para o recurso de ícone, ou NULL se o ícone do servidor, ou um ícone padrão, não puder ser encontrado.

### <a name="remarks"></a>Comentários

Essa função de membro não iniciará o servidor nem obterá um ícone dinamicamente, mesmo que o servidor já esteja em execução. Em vez disso, essa função de membro abre a imagem executável do servidor e recupera o ícone estático associado ao servidor conforme ele foi registrado.

##  <a name="geticonicmetafile"></a>  COleClientItem::GetIconicMetafile

Recupera o metarquivo usado para desenhar o ícone do item.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Valor de retorno

Um identificador para o metarquivo se for bem-sucedido; caso contrário, NULL.

### <a name="remarks"></a>Comentários

Se não houver nenhum ícone atual, um ícone padrão será retornado. Isso é chamado automaticamente pelas caixas de diálogo MFC/OLE e geralmente não é chamado diretamente.

Essa função também chama [SetIconicMetafile](#seticonicmetafile) para armazenar em cache o metarquivo para uso posterior.

##  <a name="getinplacewindow"></a>  COleClientItem::GetInPlaceWindow

Chame a `GetInPlaceWindow` função de membro para obter um ponteiro para a janela na qual o item foi aberto para edição in-loco.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para a janela de edição in-loco do item; NULL se o item não estiver ativo ou se seu servidor não estiver disponível.

### <a name="remarks"></a>Comentários

Essa função deve ser chamada somente para itens que estão ativos no local.

##  <a name="getitemstate"></a>  COleClientItem::GetItemState

Chame essa função para obter o estado atual do item OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Valor de retorno

Um `COleClientItem::ItemState` valor enumerado, que pode ser um dos seguintes: `emptyState`, `loadedState`, `openState` `activeState`,, `activeUIState`. Para obter informações sobre esses Estados, consulte o [artigo Contêineres: Estados](../../mfc/containers-client-item-states.md)de item de cliente.

### <a name="remarks"></a>Comentários

Para ser notificado quando o estado do item OLE for alterado, use a função de membro [onChange](#onchange) .

Para obter mais informações, consulte o [artigo Contêineres: Estados](../../mfc/containers-client-item-states.md)de item de cliente.

##  <a name="getlaststatus"></a>  COleClientItem::GetLastStatus

Retorna o código de status da última operação OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Valor de retorno

Um valor de SCODE.

### <a name="remarks"></a>Comentários

Para funções de membro que retornam um valor bool false ou outras funções de membro que retornam `GetLastStatus` NULL, retorna informações de falha mais detalhadas. Lembre-se de que a maioria das funções de membro OLE gera exceções para erros mais graves. As informações específicas sobre a interpretação do SCODE dependem da chamada OLE subjacente que retornou por último um valor SCODE.

Para obter mais informações sobre o SCODE, consulte [estrutura de códigos de erro com](/windows/win32/com/structure-of-com-error-codes) na documentação do SDK do Windows.

##  <a name="getlinkupdateoptions"></a>  COleClientItem::GetLinkUpdateOptions

Chame essa função para obter o valor atual da opção link-Update para o item OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Valor de retorno

Um dos seguintes valores:

- OLEUPDATE_ALWAYS atualize o item vinculado sempre que possível. Essa opção dá suporte ao botão de opção de atualização automática de link na caixa de diálogo links.

- OLEUPDATE_ONCALL atualiza o item vinculado somente na solicitação do aplicativo de contêiner (quando a função de membro [UpdateLink](#updatelink) é chamada). Essa opção dá suporte ao botão de opção link manual-atualizar na caixa de diálogo links.

### <a name="remarks"></a>Comentários

Essa é uma operação avançada.

Essa função é chamada automaticamente pela classe [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) .

Para obter mais informações, consulte [IOleLink:: GetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) no SDK do Windows.

##  <a name="gettype"></a>  COleClientItem::GetType

Chame essa função para determinar se o item OLE está inserido ou vinculado, ou estático.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Valor de retorno

Um inteiro não assinado com um dos seguintes valores:

- OT_LINK o item OLE é um link.

- OT_EMBEDDED o item OLE está inserido.

- OT_STATIC o item OLE é estático, ou seja, ele contém somente dados de apresentação, não dados nativos e, portanto, não pode ser editado.

##  <a name="getusertype"></a>  COleClientItem::GetUserType

Chame essa função para obter a cadeia de caracteres visível ao usuário que descreve o tipo do item OLE, como "documento do Word".

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Parâmetros

*nUserClassType*<br/>
Um valor que indica a variante desejada da cadeia de caracteres que descreve o tipo do item OLE. Isso pode ter um dos seguintes valores:

- USERCLASSTYPE_FULL o nome completo do tipo exibido para o usuário.

- USERCLASSTYPE_SHORT um nome curto (máximo de 15 caracteres) para uso nos menus pop-up e na caixa de diálogo Editar links.

- USERCLASSTYPE_APPNAME nome do aplicativo que atende à classe.

*rString*<br/>
Uma referência a um objeto [CString](../../atl-mfc-shared/reference/cstringt-class.md) para o qual a cadeia de caracteres que descreve o tipo do item OLE deve ser retornada.

### <a name="remarks"></a>Comentários

Geralmente, essa é a entrada no banco de dados de registro do sistema.

Se o nome completo do tipo for solicitado, mas não estiver disponível, o nome curto será usado em seu lugar. Se nenhuma entrada para o tipo de item OLE for encontrada no banco de dados de registro ou se não houver nenhum tipo de usuário registrado para o tipo de item OLE, o tipo de usuário atualmente armazenado no item OLE será usado. Se esse nome de tipo de usuário for uma cadeia de caracteres vazia, o "objeto desconhecido" será usado.

Para obter mais informações, consulte [IOleObject:: GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) na SDK do Windows.

##  <a name="isinplaceactive"></a>  COleClientItem::IsInPlaceActive

Chame essa função para ver se o item OLE está ativo no local.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o item OLE estiver ativo no local; caso contrário, 0.

### <a name="remarks"></a>Comentários

É comum executar uma lógica diferente dependendo se o item está sendo editado no local. A função verifica se o estado do item atual é igual ao `activeState` ou ao. `activeUIState`

##  <a name="islinkuptodate"></a>  COleClientItem::IsLinkUpToDate

Chame essa função para ver se o item OLE está atualizado.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o item OLE estiver atualizado; caso contrário, 0.

### <a name="remarks"></a>Comentários

Um item vinculado pode ficar desatualizado se o documento de origem tiver sido atualizado. Um item inserido que contém links dentro dele pode ficar desatualizado de forma semelhante. A função faz uma verificação recursiva do item OLE. Observe que determinar se um item OLE está desatualizado pode ser tão caro quanto executar uma atualização.

Isso é chamado automaticamente pela implementação do [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) .

Para obter mais informações, consulte [IOleObject:: IsUpToDate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) no SDK do Windows.

##  <a name="ismodified"></a>  COleClientItem::IsModified

Chame essa função para ver se o item OLE está sujo (modificado desde que foi salvo pela última vez).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o item OLE estiver sujo; caso contrário, 0.

### <a name="remarks"></a>Comentários

Para obter mais informações, consulte [IPersistStorage:: IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) no SDK do Windows.

##  <a name="isopen"></a>  COleClientItem::IsOpen

Chame essa função para ver se o item OLE está aberto; ou seja, aberto em uma instância do aplicativo de servidor em execução em uma janela separada.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o item OLE estiver aberto; caso contrário, 0.

### <a name="remarks"></a>Comentários

Ele é usado para determinar quando desenhar o objeto com um padrão de hachura. Um objeto aberto deve ter um padrão de hachura desenhado na parte superior do objeto. Você pode usar um objeto [CRectTracker](../../mfc/reference/crecttracker-class.md) para fazer isso.

##  <a name="isrunning"></a>  COleClientItem::IsRunning

Chame essa função para ver se o item OLE está em execução; ou seja, se o item está carregado e em execução no aplicativo de servidor.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o item OLE estiver em execução; caso contrário, 0.

### <a name="remarks"></a>Comentários

Para obter mais informações, consulte [OleIsRunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) no SDK do Windows.

##  <a name="onactivate"></a>  COleClientItem::OnActivate

Chamado pelo Framework para notificar o item que acabou de ser ativado no local.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Comentários

Observe que essa função é chamada para indicar que o servidor está em execução, não para indicar que a interface do usuário foi instalada no aplicativo de contêiner. Neste ponto, o objeto não tem uma interface de usuário ativa (não `activeUIState`é). Ele não instalou seus menus ou barras de ferramentas. A função de membro [OnActivateUI](#onactivateui) é chamada quando isso acontece.

A implementação padrão chama a função de membro [onChange](#onchange) com OLE_CHANGEDSTATE como um parâmetro. Substitua essa função para executar o processamento personalizado quando um item se tornar ativo no local.

##  <a name="onactivateui"></a>  COleClientItem::OnActivateUI

A estrutura chama `OnActivateUI` quando o objeto entrou no estado ativo da interface do usuário.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Comentários

O objeto agora instalou sua barra de ferramentas e menus.

A implementação padrão lembra o HWND do servidor para chamadas posteriores `GetServerWindow` .

##  <a name="onchange"></a>  COleClientItem::OnChange

Chamado pelo Framework quando o usuário modifica, salva ou fecha o item OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Parâmetros

*nCode*<br/>
O motivo pelo qual o servidor alterou este item. Ele pode ter um dos seguintes valores:

- OLE_CHANGED a aparência do item OLE foi alterada.

- OLE_SAVED o item OLE foi salvo.

- OLE_CLOSED o item OLE foi fechado.

- OLE_CHANGED_STATE o item OLE foi alterado de um estado para outro.

*dwParam*<br/>
Se *nCode* for OLE_SAVED ou OLE_CLOSED, esse parâmetro não será usado. Se *nCode* for OLE_CHANGED, esse parâmetro especificará o aspecto do item OLE que foi alterado. Para obter os valores possíveis, consulte o parâmetro *dwParam* de [COleClientItem::D RAW](#draw). Se *nCode* for OLE_CHANGED_STATE, esse parâmetro será um `COleClientItem::ItemState` valor enumerado e descreverá o estado que está sendo inserido. Ele pode ter um dos seguintes valores: `emptyState` `openState`, `loadedState` `activeState`,, ou `activeUIState`.

### <a name="remarks"></a>Comentários

(Se o aplicativo do servidor for gravado usando o biblioteca MFC, essa função será chamada em resposta às `Notify` funções de membro `COleServerDoc` do `COleServerItem`ou.) A implementação padrão marca o documento de contêiner como modificado se *nCode* for OLE_CHANGED ou OLE_SAVED.

Para OLE_CHANGED_STATE, o estado atual retornado de [GetItemState](#getitemstate) ainda será o estado antigo, ou seja, o estado atual antes dessa alteração de estado.

Substitua essa função para responder às alterações no estado do item OLE. Normalmente, você atualiza a aparência do item invalidando a área na qual o item é exibido. Chame a implementação da classe base no início da substituição.

##  <a name="onchangeitemposition"></a>  COleClientItem::OnChangeItemPosition

Chamado pelo Framework para notificar o contêiner de que a extensão do item OLE foi alterada durante a ativação in-loco.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Parâmetros

*rectPos*<br/>
Indica a posição do item relativa à área do cliente do aplicativo de contêiner.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se a posição do item for alterada com êxito; caso contrário, 0.

### <a name="remarks"></a>Comentários

A implementação padrão determina o novo retângulo visível do item OLE e chama [SetItemRects](#setitemrects) com os novos valores. A implementação padrão calcula o retângulo visível para o item e passa essas informações para o servidor.

Substitua essa função para aplicar regras especiais à operação de redimensionamento/movimentação. Se o aplicativo for escrito em MFC, essa chamada resultará porque o servidor chamou [COleServerDoc:: RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

##  <a name="ondeactivate"></a>  COleClientItem::OnDeactivate

Chamado pelo Framework quando o item OLE faz a transição do estado ativo in-loco ( `activeState`) para o estado carregado, o que significa que ele é desativado após uma ativação in-loco.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Comentários

Observe que essa função é chamada para indicar que o item OLE está fechado, e não que sua interface do usuário foi removida do aplicativo de contêiner. Quando isso acontece, a função de membro [OnDeactivateUI](#ondeactivateui) é chamada.

A implementação padrão chama a função de membro [onChange](#onchange) com OLE_CHANGEDSTATE como um parâmetro. Substitua essa função para executar o processamento personalizado quando um item ativo in-loco for desativado. Por exemplo, se você oferecer suporte ao comando desfazer no aplicativo de contêiner, poderá substituir essa função para descartar o estado de desfazer, indicando que a última operação executada no item OLE não poderá ser desfeita depois que o item for desativado.

##  <a name="ondeactivateandundo"></a>  COleClientItem::OnDeactivateAndUndo

Chamado pelo Framework quando o usuário invoca o comando Undo depois de ativar o item OLE no local.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Comentários

A implementação padrão chama [DeactivateUI](#deactivateui) para desativar a interface do usuário do servidor. Substitua essa função se você estiver implementando o comando Undo em seu aplicativo de contêiner. Em sua substituição, chame a versão da classe base da função e, em seguida, desfaça o último comando executado em seu aplicativo.

Para obter mais informações, consulte [IOleInPlaceSite::D eactivateandundo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) no SDK do Windows.

##  <a name="ondeactivateui"></a>  COleClientItem::OnDeactivateUI

Chamado quando o usuário desativa um item que foi ativado no local.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Parâmetros

*bUndoable*<br/>
Especifica se as alterações de edição podem ser desfeitas.

### <a name="remarks"></a>Comentários

Essa função restaura a interface do usuário do aplicativo de contêiner para seu estado original, ocultando todos os menus e outros controles que foram criados para ativação in-loco.

Se *bUndoable* for false, o contêiner deverá desabilitar o comando Undo, na verdade, descartando o estado de desfazer do contêiner, porque ele indica que a última operação executada pelo servidor não é pode ser desfeita.

##  <a name="ondiscardundostate"></a>  COleClientItem::OnDiscardUndoState

Chamado pelo Framework quando o usuário executa uma ação que descarta o estado de desfazer ao editar o item OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Comentários

A implementação padrão não faz nada. Substitua essa função se você estiver implementando o comando Undo em seu aplicativo de contêiner. Em sua substituição, descarte o estado de desfazer do aplicativo de contêiner.

Se o servidor foi gravado com o biblioteca MFC, o servidor pode fazer com que essa função seja chamada chamando [COleServerDoc::D iscardundostate](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Para obter mais informações, consulte [IOleInPlaceSite::D iscardundostate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) no SDK do Windows.

##  <a name="ongetclipboarddata"></a>  COleClientItem::OnGetClipboardData

Chamado pelo Framework para obter um `COleDataSource` objeto que contém todos os dados que seriam colocados na área de transferência por uma chamada para a função de membro [CopyToClipboard](#copytoclipboard) ou [DoDragDrop](#dodragdrop) .

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Parâmetros

*bIncludeLink*<br/>
Defina como verdadeiro se os dados do link devem ser copiados para a área de transferência. Defina como FALSE se o aplicativo do servidor não oferecer suporte a links.

*lpOffset*<br/>
Ponteiro para o deslocamento do cursor do mouse da origem do objeto em pixels.

*lpSize*<br/>
Ponteiro para o tamanho do objeto em pixels.

### <a name="return-value"></a>Valor de retorno

Um ponteiro para um objeto [COleDataSource](../../mfc/reference/coledatasource-class.md) que contém os dados da área de transferência.

### <a name="remarks"></a>Comentários

A implementação padrão dessa função chama [GetClipboardData](#getclipboarddata).

##  <a name="ongetcliprect"></a>  COleClientItem::OnGetClipRect

A estrutura chama a `OnGetClipRect` função de membro para obter as coordenadas de retângulo de recorte do item que está sendo editado no local.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Parâmetros

*rClipRect*<br/>
Ponteiro para um objeto da classe [CRect](../../atl-mfc-shared/reference/crect-class.md) que conterá as coordenadas do retângulo de recorte do item.

### <a name="remarks"></a>Comentários

As coordenadas são em pixels em relação à área do cliente da janela do aplicativo de contêiner.

A implementação padrão simplesmente retorna o retângulo do cliente da exibição na qual o item está ativo no local.

##  <a name="ongetitemposition"></a>  COleClientItem::OnGetItemPosition

A estrutura chama a `OnGetItemPosition` função de membro para obter as coordenadas do item que está sendo editado no local.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Parâmetros

*rPosition*<br/>
Referência ao objeto [CRect](../../atl-mfc-shared/reference/crect-class.md) que conterá as coordenadas de posição do item.

### <a name="remarks"></a>Comentários

As coordenadas são em pixels em relação à área do cliente da janela do aplicativo de contêiner.

A implementação padrão dessa função não faz nada. Os aplicativos que dão suporte à edição in-loco exigem sua implementação.

##  <a name="ongetwindowcontext"></a>  COleClientItem::OnGetWindowContext

Chamado pelo Framework quando um item é ativado no local.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Parâmetros

*ppMainFrame*<br/>
Ponteiro para um ponteiro para a janela do quadro principal.

*ppDocFrame*<br/>
Ponteiro para um ponteiro para a janela do quadro do documento.

*lpFrameInfo*<br/>
Ponteiro para uma estrutura [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) que receberá informações da janela do quadro.

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Essa função é usada para recuperar informações sobre a janela pai do item OLE.

Se o contêiner for um aplicativo MDI, a implementação padrão retornará um ponteiro para o objeto [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) em *ppMainFrame* e um ponteiro para o objeto Active [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) no *ppDocFrame*. Se o contêiner for um aplicativo SDI, a implementação padrão retornará um ponteiro para o objeto [CFrameWnd](../../mfc/reference/cframewnd-class.md) em *PPMAINFRAME* e retornará NULL em *ppDocFrame*. A implementação padrão também preenche os membros de *lpFrameInfo*.

Substitua essa função somente se a implementação padrão não se adequar ao seu aplicativo; por exemplo, se seu aplicativo tiver um paradigma de interface de usuário diferente de SDI ou MDI. Esse é um substituível avançado.

Para obter mais informações, consulte [IOleInPlaceSite:: GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) e a estrutura [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) no SDK do Windows.

##  <a name="oninsertmenus"></a>  COleClientItem::OnInsertMenus

Chamado pelo Framework durante a ativação in-loco para inserir os menus do aplicativo de contêiner em um menu vazio.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Parâmetros

*pMenuShared*<br/>
Aponta para um menu vazio.

*lpMenuWidths*<br/>
Aponta para uma matriz de seis valores longos indicando quantos menus estão em cada um dos seguintes grupos de menus: Arquivo, editar, contêiner, objeto, janela, ajuda. O aplicativo de contêiner é responsável pelos grupos de menus File, container e Window, correspondentes aos elementos 0, 2 e 4 dessa matriz.

### <a name="remarks"></a>Comentários

Esse menu é passado para o servidor, que insere seus próprios menus, criando um menu composto. Essa função pode ser chamada repetidamente para criar vários menus compostos.

A implementação padrão insere em *pMenuShared* os menus de contêiner in-loco; ou seja, os grupos de menus File, container e Window. [CDocTemplate:: SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) é usado para definir esse recurso de menu. A implementação padrão também atribui os valores apropriados aos elementos 0, 2 e 4 em *lpMenuWidths*, dependendo do recurso de menu. Substitua essa função se a implementação padrão não for apropriada para seu aplicativo; por exemplo, se seu aplicativo não usa modelos de documento para associar recursos a tipos de documento. Se você substituir essa função, você também deverá substituir [OnSetMenu](#onsetmenu) e [OnRemoveMenus](#onremovemenus). Esse é um substituível avançado.

Para obter mais informações, consulte [IOleInPlaceFrame:: InsertMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) no SDK do Windows.

##  <a name="onremovemenus"></a>  COleClientItem::OnRemoveMenus

Chamado pelo Framework para remover os menus do contêiner do menu composto especificado quando a ativação in-loco termina.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Parâmetros

*pMenuShared*<br/>
Aponta para o menu composto construído por chamadas para a função de membro [OnInsertMenus](#oninsertmenus) .

### <a name="remarks"></a>Comentários

A implementação padrão remove de *pMenuShared* os menus de contêiner no local, ou seja, os grupos de menus File, container e Window. Substitua essa função se a implementação padrão não for apropriada para seu aplicativo; por exemplo, se seu aplicativo não usa modelos de documento para associar recursos a tipos de documento. Se você substituir essa função, provavelmente deverá substituir [OnInsertMenus](#oninsertmenus) e [OnSetMenu](#onsetmenu) também. Esse é um substituível avançado.

Os submenus em *pMenuShared* podem ser compartilhados por mais de um menu composto se o servidor tiver chamado `OnInsertMenus`repetidamente. Portanto, você não deve excluir nenhum submenu em sua substituição de `OnRemoveMenus`; você deve desanexá-los apenas.

Para obter mais informações, consulte [IOleInPlaceFrame:: RemoveMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) no SDK do Windows.

##  <a name="onscrollby"></a>  COleClientItem::OnScrollBy

Chamado pelo Framework para rolar o item OLE em resposta a solicitações do servidor.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Parâmetros

*sizeExtent*<br/>
Especifica as distâncias, em pixels, para rolar nas direções x e y.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o item foi rolado; 0 se o item não puder ser rolado.

### <a name="remarks"></a>Comentários

Por exemplo, se o item OLE estiver parcialmente visível e o usuário se mover para fora da região visível durante a execução da edição in-loco, essa função será chamada para manter o cursor visível. A implementação padrão não faz nada. Substitua essa função para rolar o item pelo valor especificado. Observe que, como resultado da rolagem, a parte visível do item OLE pode ser alterada. Chame [SetItemRects](#setitemrects) para atualizar o retângulo visível do item.

Para obter mais informações, consulte [IOleInPlaceSite:: Scroll](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) no SDK do Windows.

##  <a name="onsetmenu"></a>  COleClientItem::OnSetMenu

Chamado pelo Framework duas vezes, quando a ativação in-loco começa e termina; na primeira vez para instalar o menu composto e a segunda vez (com *holemenu* igual a NULL) para removê-lo.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Parâmetros

*pMenuShared*<br/>
Ponteiro para o menu composto construído por chamadas para a função membro [OnInsertMenus](#oninsertmenus) e a `InsertMenu` função.

*holemenu*<br/>
Manipule para o descritor de menu retornado `OleCreateMenuDescriptor` pela função, ou NULL se o código de expedição for removido.

*hwndActiveObject*<br/>
Identificador para a janela de edição do item OLE. Esta é a janela que receberá comandos de edição do OLE.

### <a name="remarks"></a>Comentários

A implementação padrão instala ou remove o menu composto e, em seguida, chama a função [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) para instalar ou remover o código de expedição. Substitua essa função se a implementação padrão não for apropriada para seu aplicativo. Se você substituir essa função, provavelmente deverá substituir [OnInsertMenus](#oninsertmenus) e [OnRemoveMenus](#onremovemenus) também. Esse é um substituível avançado.

Para obter mais informações, consulte [OleCreateMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)e [IOleInPlaceFrame:: SetMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) na SDK do Windows.

##  <a name="onshowcontrolbars"></a>  COleClientItem::OnShowControlBars

Chamado pelo Framework para mostrar e ocultar as barras de controle do aplicativo de contêiner.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Parâmetros

*pFrameWnd*<br/>
Ponteiro para a janela do quadro do aplicativo de contêiner. Pode ser uma janela de quadro principal ou uma janela filho MDI.

*bShow*<br/>
Especifica se as barras de controle devem ser mostradas ou ocultas.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se a chamada de função causar uma alteração no estado das barras de controle; 0 se a chamada não causar nenhuma alteração ou se *pFrameWnd* não apontar para a janela do quadro do contêiner.

### <a name="remarks"></a>Comentários

Essa função retornará 0 se as barras de controle já estiverem no estado especificado por *bShow.* Isso ocorrerá, por exemplo, se as barras de controle estiverem ocultas e *bShow* for false.

A implementação padrão remove a barra de ferramentas da janela de quadro de nível superior.

##  <a name="onshowitem"></a>  COleClientItem::OnShowItem

Chamado pelo Framework para exibir o item OLE, tornando-o totalmente visível durante a edição.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Comentários

Ele é usado quando o aplicativo de contêiner dá suporte a links para itens inseridos (ou seja, se você tiver derivado a classe de documento de [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Essa função é chamada durante a ativação in-loco ou quando o item OLE é uma origem de link e o usuário deseja editá-lo. A implementação padrão ativa a primeira exibição no documento de contêiner. Substitua essa função para rolar o documento para que o item OLE fique visível.

##  <a name="onupdateframetitle"></a>  COleClientItem::OnUpdateFrameTitle

Chamado pelo Framework durante a ativação in-loco para atualizar a barra de título da janela do quadro.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se essa função tiver atualizado com êxito o título do quadro, caso contrário, zero.

### <a name="remarks"></a>Comentários

A implementação padrão não altera o título da janela do quadro. Substitua essa função se você quiser um título de quadro diferente para seu aplicativo, por exemplo "*Item* de *aplicativo* - de servidor em *docname*" (como em, "Microsoft Excel-planilha no relatório. DOC "). Esse é um substituível avançado.

##  <a name="reactivateandundo"></a>  COleClientItem::ReactivateAndUndo

Chame essa função para reativar o item OLE e desfazer a última operação executada pelo usuário durante a edição in-loco.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Se o aplicativo de contêiner der suporte ao comando desfazer, chame essa função se o usuário escolher o comando desfazer imediatamente após desativar o item OLE.

Se o aplicativo do servidor for escrito com as bibliotecas Microsoft Foundation Class, essa função fará com que o servidor chame [COleServerDoc:: OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Para obter mais informações, consulte [IOleInPlaceObject:: ReactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) no SDK do Windows.

##  <a name="release"></a>  COleClientItem::Release

Chame essa função para limpar os recursos usados pelo item OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Parâmetros

*dwCloseOption*<br/>
Sinalizador que especifica em que circunstâncias o item OLE é salvo quando retorna ao estado carregado. Para obter uma lista de valores possíveis, consulte [COleClientItem:: Close](#close).

### <a name="remarks"></a>Comentários

`Release`é chamado pelo `COleClientItem` destruidor.

Para obter mais informações, consulte [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) no SDK do Windows.

##  <a name="reload"></a>  COleClientItem::Reload

Fecha e recarrega o item.

```
BOOL Reload();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Chame a `Reload` função depois de ativar o item como um item de outro tipo por uma chamada para [ActivateAs](#activateas).

##  <a name="run"></a>  COleClientItem::Run

Executa o aplicativo associado a este item.

```
void Run();
```

### <a name="remarks"></a>Comentários

Chame a `Run` função de membro para iniciar o aplicativo de servidor antes de ativar o item. Isso é feito automaticamente por [Ativar](#activate) e [doverbo](#doverb), portanto, geralmente não é necessário chamar essa função. Chame essa função se for necessário executar o servidor para definir um atributo de item, como [SetExtent](#setextent), antes de executar [doverbs](#doverb).

##  <a name="setdrawaspect"></a>  COleClientItem::SetDrawAspect

Chame a `SetDrawAspect` função de membro para definir o "aspecto" ou a exibição do item.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Parâmetros

*nDrawAspect*<br/>
Um valor da enumeração DVASPECT. Esse parâmetro pode ter um dos seguintes valores:

- O item DVASPECT_CONTENT é representado de forma que possa ser exibido como um objeto incorporado dentro de seu contêiner.

- O item DVASPECT_THUMBNAIL é renderizado em uma representação de "miniatura" para que possa ser exibido em uma ferramenta de navegação.

- O item DVASPECT_ICON é representado por um ícone.

- DVASPECT_DOCPRINT Item é representado como se fosse impresso usando o comando Print no menu File.

### <a name="remarks"></a>Comentários

O aspecto especifica como o item deve ser processado por [empate](#draw) quando o valor padrão para o argumento *nDrawAspect* da função é usado.

Essa função é chamada automaticamente pelo ícone de alteração (e por outras caixas de diálogo que chamam a caixa de diálogo Alterar ícone diretamente) para habilitar o aspecto de exibição icônico quando solicitado pelo usuário.

##  <a name="setextent"></a>  COleClientItem::SetExtent

Chame essa função para especificar a quantidade de espaço disponível para o item OLE.

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Parâmetros

*size*<br/>
Um objeto [CSize](../../atl-mfc-shared/reference/csize-class.md) que contém as informações de tamanho.

*nDrawAspect*<br/>
Especifica o aspecto do item OLE cujos limites devem ser definidos. Para obter os valores possíveis, consulte [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Comentários

Se o aplicativo de servidor foi escrito usando o biblioteca MFC, isso faz com que a função membro [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) do objeto `COleServerItem` correspondente seja chamada. O item OLE pode ajustar sua exibição de acordo. As dimensões devem estar em unidades MM_HIMETRIC. Chame essa função quando o usuário redimensionar o item OLE ou se você oferecer suporte a alguma forma de negociação de layout.

Para obter mais informações, consulte [IOleObject:: SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) no SDK do Windows.

##  <a name="sethostnames"></a>  COleClientItem::SetHostNames

Chame essa função para especificar o nome do aplicativo de contêiner e o nome do contêiner para um item OLE inserido.

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Parâmetros

*lpszHost*<br/>
Ponteiro para o nome do aplicativo de contêiner visível ao usuário.

*lpszHostObj*<br/>
Ponteiro para uma cadeia de caracteres de identificação do contêiner que contém o item OLE.

### <a name="remarks"></a>Comentários

Se o aplicativo de servidor foi escrito usando o biblioteca MFC, essa função chama a função de membro [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) do documento `COleServerDoc` que contém o item OLE. Essas informações são usadas em títulos de janelas quando o item OLE está sendo editado. Cada vez que um documento de contêiner é carregado, a estrutura chama essa função para todos os itens OLE do documento. `SetHostNames`é aplicável somente a itens inseridos. Não é necessário chamar essa função toda vez que um item OLE incorporado é ativado para edição.

Isso também é chamado automaticamente com o nome do aplicativo e o nome do documento quando um objeto é carregado ou quando um arquivo é salvo com um nome diferente. Da mesma forma, normalmente não é necessário chamar essa função diretamente.

Para obter mais informações, consulte [IOleObject:: SetHostNames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) no SDK do Windows.

##  <a name="seticonicmetafile"></a>  COleClientItem::SetIconicMetafile

Armazena em cache o metarquivo usado para desenhar o ícone do item.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Parâmetros

*hMetaPict*<br/>
Um identificador para o metarquivo usado para desenhar o ícone do item.

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Use [GetIconicMetafile](#geticonicmetafile) para recuperar o metarquivo.

O parâmetro *hMetaPict* é copiado para o item; Portanto, *hMetaPict* deve ser liberado pelo chamador.

##  <a name="setitemrects"></a>  COleClientItem::SetItemRects

Chame essa função para definir o retângulo delimitador ou o retângulo visível do item OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parâmetros

*lprcPosRect*<br/>
Ponteiro para o retângulo que contém os limites do item OLE relativo à sua janela pai, nas coordenadas do cliente.

*lprcClipRect*<br/>
Ponteiro para o retângulo que contém os limites da parte visível do item OLE em relação à sua janela pai, nas coordenadas do cliente.

### <a name="return-value"></a>Valor de retorno

Diferente de zero, se for bem-sucedido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Essa função é chamada pela implementação padrão da função membro [OnChangeItemPosition](#onchangeitemposition) . Você deve chamar essa função sempre que a parte de posição ou visível do item OLE for alterada. Geralmente, isso significa que você o chama de suas funções de membro [OnSize](../../mfc/reference/cwnd-class.md#onsize) e [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) do modo de exibição.

Para obter mais informações, consulte [IOleInPlaceObject:: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) no SDK do Windows.

##  <a name="setlinkupdateoptions"></a>  COleClientItem::SetLinkUpdateOptions

Chame essa função para definir a opção link-Update para a apresentação do item vinculado especificado.

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Parâmetros

*dwUpdateOpt*<br/>
O valor da opção de atualização de link para este item. Esse valor deve ser um dos seguintes:

- OLEUPDATE_ALWAYS atualize o item vinculado sempre que possível. Essa opção dá suporte ao botão de opção de atualização automática de link na caixa de diálogo links.

- OLEUPDATE_ONCALL atualiza o item vinculado somente na solicitação do aplicativo de contêiner (quando a função de membro [UpdateLink](#updatelink) é chamada). Essa opção dá suporte ao botão de opção link manual-atualizar na caixa de diálogo links.

### <a name="remarks"></a>Comentários

Normalmente, você não deve alterar as opções de atualização escolhidas pelo usuário na caixa de diálogo links.

Para obter mais informações, consulte [IOleLink:: SetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) no SDK do Windows.

##  <a name="setprintdevice"></a>  COleClientItem::SetPrintDevice

Chame essa função para alterar o dispositivo de destino de impressão para este item.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Parâmetros

*ptd*<br/>
Ponteiro para uma estrutura de dados [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) , que contém informações sobre o novo dispositivo de destino de impressão. Pode ser NULL.

*ppd*<br/>
Ponteiro para uma estrutura de dados [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) , que contém informações sobre o novo dispositivo de destino de impressão. Pode ser NULL.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se a função foi bem-sucedida; caso contrário, 0.

### <a name="remarks"></a>Comentários

Essa função atualiza o dispositivo de destino de impressão para o item, mas não atualiza o cache de apresentação. Para atualizar o cache de apresentação de um item, chame [UpdateLink](#updatelink).

Os argumentos para essa função contêm informações que o sistema OLE usa para identificar o dispositivo de destino. A `PRINTDLG` estrutura contém informações que o Windows usa para inicializar a caixa de diálogo Imprimir comum. Depois que o usuário fecha a caixa de diálogo, o Windows retorna informações sobre as seleções do usuário nesta estrutura. O `m_pd` membro de um objeto [CPrintDialog](../../mfc/reference/cprintdialog-class.md) é uma `PRINTDLG` estrutura.

Para obter mais informações sobre essa estrutura, consulte [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) no SDK do Windows.

Para obter mais informações, consulte [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) no SDK do Windows.

##  <a name="updatelink"></a>  COleClientItem::UpdateLink

Chame essa função para atualizar os dados da apresentação do item OLE imediatamente.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero em caso de êxito; caso contrário, 0.

### <a name="remarks"></a>Comentários

Para itens vinculados, a função localiza a origem do link para obter uma nova apresentação para o item OLE. Esse processo pode envolver a execução de um ou mais aplicativos de servidor, o que pode ser demorado. Para itens inseridos, a função funciona recursivamente, verificando se o item inserido contém links que podem estar desatualizados e atualizá-los. O usuário também pode atualizar manualmente os links individuais usando a caixa de diálogo links.

Para obter mais informações, consulte [IOleLink:: Update](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) no SDK do Windows.

## <a name="see-also"></a>Consulte também

[Exemplo de MFCBIND do MFC](../../overview/visual-cpp-samples.md)<br/>
[Exemplo de OCLIENT do MFC](../../overview/visual-cpp-samples.md)<br/>
[Classe CDocItem](../../mfc/reference/cdocitem-class.md)<br/>
[Gráfico da hierarquia](../../mfc/hierarchy-chart.md)<br/>
[Classe COleServerItem](../../mfc/reference/coleserveritem-class.md)
