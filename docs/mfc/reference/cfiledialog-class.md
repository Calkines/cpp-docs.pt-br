---
title: Classe CFileDialog
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: a7287b2e3011159573f44e9247e016d81d893491
ms.sourcegitcommit: c3bf94210bdb73be80527166264d49e33784152c
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/06/2019
ms.locfileid: "68821075"
---
# <a name="cfiledialog-class"></a>Classe CFileDialog

Encapsula a caixa de diálogo comum que é usada para operações de arquivo abrir ou salvar arquivo.

## <a name="syntax"></a>Sintaxe

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>Membros

### <a name="public-constructors"></a>Construtores públicos

|Nome|Descrição|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|Constrói um objeto `CFileDialog`.|

### <a name="public-methods"></a>Métodos públicos

|Nome|Descrição|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|Adiciona um botão de seleção à caixa de diálogo.|
|[CFileDialog::AddComboBox](#addcombobox)|Adiciona uma caixa de combinação ao diálogo.|
|[CFileDialog::AddControlItem](#addcontrolitem)|Adiciona um item a um controle de contêiner na caixa de diálogo.|
|[CFileDialog::AddEditBox](#addeditbox)|Adiciona uma caixa de edição ao diálogo.|
|[CFileDialog::AddMenu](#addmenu)|Adiciona um menu à caixa de diálogo.|
|[CFileDialog::AddPlace](#addplace)|Sobrecarregado. Adiciona uma pasta à lista de locais disponíveis para o usuário abrir ou salvar itens.|
|[CFileDialog::AddPushButton](#addpushbutton)|Adiciona um botão à caixa de diálogo.|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Adiciona um grupo de botões de opção (também conhecido como botão de opção) à caixa de diálogo.|
|[CFileDialog::AddSeparator](#addseparator)|Adiciona um separador à caixa de diálogo.|
|[CFileDialog::AddText](#addtext)|Adiciona o conteúdo de texto à caixa de diálogo.|
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|Atualiza o estado do `CFileDialog` para corresponder aos parâmetros e sinalizadores armazenados na variável de `m_ofn` membro.|
|[CFileDialog::D oModal](#domodal)|Exibe a caixa de diálogo e permite que o usuário faça uma seleção.|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|Habilita uma lista suspensa no botão **abrir** ou **salvar** na caixa de diálogo.|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Interrompe a adição de elementos a um grupo Visual na caixa de diálogo.|
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|Obtém o estado atual de um botão de verificação (caixa de seleção) no diálogo.|
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|Obtém o estado atual de um item em um controle de contêiner encontrado na caixa de diálogo.|
|[CFileDialog::GetControlState](#getcontrolstate)|Obtém a visibilidade atual e os Estados habilitados de um determinado controle.|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Obtém o texto atual em um controle de caixa de edição.|
|[CFileDialog::GetFileExt](#getfileext)|Retorna a extensão do arquivo selecionado.|
|[CFileDialog::GetFileName](#getfilename)|Retorna o nome de arquivo do arquivo selecionado.|
|[CFileDialog::GetFileTitle](#getfiletitle)|Retorna o título do arquivo selecionado.|
|[CFileDialog::GetFolderPath](#getfolderpath)|Recupera o caminho da pasta ou diretório aberto no momento para uma caixa de diálogo **aberta** no estilo do Explorer ou **salvar como** comum.|
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|Recupera o objeto com interno para um objeto `CFileDialog` personalizado.|
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|Recupera o objeto com interno para um `CFileDialog` que é usado como uma caixa de diálogo de arquivo **aberto** .|
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|Recupera o objeto com interno para um `CFileDialog` que é usado como uma caixa de diálogo **salvar** arquivo.|
|[CFileDialog::GetNextPathName](#getnextpathname)|Retorna o caminho completo do próximo arquivo selecionado.|
|[CFileDialog::GetOFN](#getofn)|Recupera a `OPENFILENAME` estrutura `CFileDialog` do objeto.|
|[CFileDialog::GetPathName](#getpathname)|Retorna o caminho completo do arquivo selecionado.|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Retorna o status somente leitura do arquivo selecionado.|
|[CFileDialog::GetResult](#getresult)|Obtém a opção que o usuário fez na caixa de diálogo.|
|[CFileDialog::GetResults](#getresults)|Obtém as opções do usuário em uma caixa de diálogo que permite seleção múltipla.|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Obtém um item específico dos controles de contêiner especificados na caixa de diálogo.|
|[CFileDialog::GetStartPosition](#getstartposition)|Retorna a posição do primeiro elemento da lista de nomes de arquivos.|
|[CFileDialog::HideControl](#hidecontrol)|Oculta o controle especificado em uma caixa de diálogo **abrir** no estilo do Explorer ou **salvar como** comum.|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|Determina se a caixa de diálogo atual no modo de seletor de pasta.|
|[CFileDialog::MakeProminent](#makeprominent)|Coloca um controle na caixa de diálogo para que ele se destaque em comparação com outros controles adicionados.|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|Remove um item de um controle de contêiner na caixa de diálogo.|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|Define o estado atual de um botão de verificação (caixa de seleção) no diálogo.|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|Define o estado atual de um item em um controle de contêiner encontrado na caixa de diálogo.|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Define o texto de um item de controle. Por exemplo, o texto que acompanha um botão de opção ou um item em um menu.|
|[CFileDialog::SetControlLabel](#setcontrollabel)|Define o texto associado a um controle, como um texto de botão ou um rótulo de caixa de edição.|
|[CFileDialog::SetControlState](#setcontrolstate)|Define a visibilidade atual e os Estados habilitados de um determinado controle.|
|[CFileDialog::SetControlText](#setcontroltext)|Define o texto do controle especificado em uma caixa de diálogo **abrir** no estilo do Explorer ou **salvar como** comum.|
|[CFileDialog::SetDefExt](#setdefext)|Define a extensão de nome de arquivo padrão para uma caixa de diálogo **abrir** no estilo do Explorer ou **salvar como** comum.|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Define o texto atual em um controle de caixa de edição.|
|[CFileDialog::SetProperties](#setproperties)|Fornece um repositório de propriedades que define os valores padrão a serem usados para o item que está sendo salvo.|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Define o estado selecionado de um item específico em um grupo de botões de opção ou de uma caixa de combinação encontrada no diálogo.|
|[CFileDialog::SetTemplate](#settemplate)|Define o modelo de caixa de diálogo `CFileDialog` para o objeto.|
|[CFileDialog::StartVisualGroup](#startvisualgroup)|Declara um grupo Visual na caixa de diálogo. As chamadas subsequentes para qualquer método "Add" adicionam esses elementos a esse grupo.|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Atualiza os dados armazenados na `m_ofn` variável de membro para corresponder ao estado atual da caixa de diálogo de arquivo.|

### <a name="protected-methods"></a>Métodos Protegidos

|Nome|Descrição|
|----------|-----------------|
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|Chamado quando o botão é clicado.|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Chamado quando a caixa de seleção está marcada/desmarcada.|
|[CFileDialog::OnControlActivating](#oncontrolactivating)|Chamado quando o controle está sendo ativo.|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Manipula a mensagem WM_NOTIFY CDN_SELCHANGE.|
|[CFileDialog::OnFileNameOK](#onfilenameok)|Valida o nome do arquivo inserido na caixa de diálogo.|
|[CFileDialog::OnFolderChange](#onfolderchange)|Manipula a mensagem WM_NOTIFY CDN_FOLDERCHANGE.|
|[CFileDialog::OnInitDone](#oninitdone)|Manipula a mensagem WM_NOTIFY CDN_INITDONE.|
|[CFileDialog::OnItemSelected](#onitemselected)|Chamado quando o item de contêiner está sendo selecionado.|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Permite que você execute ações personalizadas quando a seleção de arquivo é alterada.|
|[CFileDialog::OnShareViolation](#onshareviolation)|Lida com violações de compartilhamento.|
|[CFileDialog:: OnTypeChange](#ontypechange)|Manipula a mensagem WM_NOTIFY CDN_TYPECHANGE.|

### <a name="public-data-members"></a>Membros de Dados Públicos

|Nome|Descrição|
|----------|-----------------|
|[CFileDialog:: m_ofn](#m_ofn)|A estrutura `OPENFILENAME` do Windows. Fornece acesso aos parâmetros da caixa de diálogo de arquivo básico.|

## <a name="remarks"></a>Comentários

Caixas de diálogo de arquivo comum permitem implementar caixas de diálogo de seleção de arquivos, por exemplo, **Abrir arquivo** e **salvar como**, de maneira consistente com os padrões do Windows.

Você pode usar `CFileDialog` o as com o construtor fornecido ou pode derivar sua própria classe de caixa de diálogo `CFileDialog` de e escrever um construtor para atender às suas necessidades. Em ambos os casos, essas caixas de diálogo se comportarão como caixas de diálogo padrão do MFC porque são derivadas da [classe CCommonDialog](../../mfc/reference/ccommondialog-class.md). `CFileDialog`depende do COMMDLG. Arquivo DLL que está incluído no Windows.

A aparência e a funcionalidade do `CFileDialog` com o Windows Vista ou posterior diferem das versões anteriores do Windows. O padrão `CFileDialog` usa automaticamente o novo estilo Windows Vista ou posterior sem alterações de código se um programa for compilado e executado no Windows Vista ou posterior. Use o parâmetro *bVistaStyle* no construtor para substituir manualmente essa atualização automática. A exceção à atualização automática é de caixas de diálogo personalizadas. Eles não serão convertidos para o novo estilo. Para obter mais informações sobre o construtor, consulte [CFileDialog:: CFileDialog](#cfiledialog).

> [!NOTE]
>  O sistema de identificação de controle difere no Windows Vista ou posterior de versões anteriores do Windows quando você `CFileDialog`usa um. Você deve atualizar todas as referências `CFileDialog` a controles no código antes de poder portar seu projeto de uma versão anterior do Windows.

Alguns `CFileDialog` métodos não têm suporte no Windows Vista ou posterior. Verifique o tópico Método individual para obter informações sobre se há suporte para o método. Além disso, as seguintes funções herdadas não têm suporte no Windows Vista ou posterior:

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

As mensagens do Windows para `CFileDialog` a classe variam de acordo com o sistema operacional que você está usando. Por exemplo, o Windows XP não oferece suporte a [CDialog:: OnCancel](../../mfc/reference/cdialog-class.md#oncancel) e [CDialog:: OnOK](../../mfc/reference/cdialog-class.md#onok) para a `CFileDialog` classe. No entanto, o Windows Vista e sistemas operacionais posteriores dão suporte a eles. Para obter mais informações sobre as diferentes mensagens que são geradas e a ordem em que elas são recebidas, consulte [exemplo de CFileDialog: Log de ordem](../../overview/visual-cpp-samples.md)de evento.

Para usar um `CFileDialog` objeto, primeiro crie o objeto usando o `CFileDialog` Construtor. Depois que a caixa de diálogo tiver sido construída, você poderá definir ou modificar quaisquer valores na estrutura [CFileDialog:: m_ofn](#m_ofn) para inicializar os valores ou Estados dos controles da caixa de diálogo. A `m_ofn` estrutura é do tipo `OPENFILENAME`. Para obter mais informações, consulte a estrutura [da OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) no SDK do Windows.

Depois de inicializar os controles da caixa de diálogo, chame o método [CFileDialog::D omodal](#domodal) para exibir a caixa de diálogo para que o usuário possa digitar o caminho e o nome do arquivo. `DoModal`Retorna se o usuário clicou no botão OK (IDOK) ou Cancel (IDCANCEL). Se `DoModal` retornar IDOK, você poderá usar uma `CFileDialog` das funções de membro público para recuperar as informações colocadas pelo usuário.

> [!NOTE]
> No Windows Vista ou posterior, várias chamadas para [IFileDialog::](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes) SetFileTypes causam um erro. A segunda chamada para `SetFileTypes` para qualquer instância de a `CFileDialog` retornará E_UNEXPECTED no Windows Vista ou posterior. Algumas `CFileDialog` funções de método `SetFileTypes`chamam. Por exemplo, duas chamadas para `CFileDialog::DoModal` para a mesma instância de um `CFileDialog` gera [Assert](diagnostic-services.md#assert).

`CFileDialog`inclui vários membros protegidos que permitem a manipulação personalizada de violações de compartilhamento, validação de nome de arquivo e notificação de alteração da caixa de listagem. Esses membros protegidos são funções de retorno de chamada que a maioria dos aplicativos não precisa usar porque o tratamento padrão é executado automaticamente. As entradas de mapa de mensagens para essas funções não são necessárias porque são funções virtuais padrão.

Você pode usar a função [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror) do Windows para determinar se ocorreu um erro durante a inicialização da caixa de diálogo e para saber mais sobre o erro.

A destruição de `CFileDialog` objetos é manipulada automaticamente. Você não precisa chamar [CDialog:: EndDialog](../../mfc/reference/cdialog-class.md#enddialog).

Para permitir que o usuário Selecione vários arquivos, defina o sinalizador OFN_ALLOWMULTISELECT antes de `DoModal`chamar. Você deve fornecer seu próprio buffer de nome de arquivo para acomodar a lista retornada de vários nomes de arquivo. Faça isso substituindo `m_ofn.lpstrFile` por um ponteiro para um buffer que você alocou, depois de construir o `CFileDialog`, mas antes de chamar `DoModal`.

Além disso, você deve `m_ofn.nMaxFile` definir usando o número de caracteres no buffer apontado por. `m_ofn.lpstrFile` Se você definir o número máximo de arquivos a serem selecionados `n`, o tamanho de buffer necessário será. `n * (_MAX_PATH + 1) + 1` O primeiro item retornado no buffer é o caminho para a pasta onde os arquivos foram selecionados. Para as caixas de diálogo do Windows Vista ou estilo posterior, as cadeias de caracteres de nome de diretório e arquivo são terminadas em nulo, com um caractere nulo extra após o último nome de arquivo. Esse formato permite que as caixas de diálogo do estilo Explorer retornem nomes de arquivo longos que incluem espaços. Para caixas de diálogo de estilo antigo, as cadeias de caracteres de nome de diretório e de arquivo são separadas por espaços e a função usa nomes de arquivo curtos para nomes de arquivo com espaços.

O exemplo a seguir demonstra como usar um buffer para recuperar e listar vários nomes de arquivo.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Para alterar o tamanho do buffer em resposta ao usuário que seleciona vários nomes de arquivo, você deve derivar uma `CFileDialog` nova classe de e substituir o método [CFileDialog:: OnFileNameChange](#onfilenamechange) .

Se você derivar uma nova classe `CFileDialog`do, poderá usar um mapa de mensagens para lidar com qualquer mensagem. Para estender a manipulação de mensagens padrão, derive uma `CFileDialog`classe de, adicione um mapa de mensagem à nova classe e forneça funções de membro para as novas mensagens. Você não precisa fornecer uma função de gancho para personalizar a caixa de diálogo.

Para personalizar a caixa de diálogo, derive uma `CFileDialog`classe de, forneça um modelo de caixa de diálogo personalizada e adicione um mapa de mensagens para processar as mensagens de notificação dos controles estendidos. Passe todas as mensagens não processadas para a classe base. Você não precisa personalizar a função Hook.

Ao usar o estilo Windows Vista ou posterior do `CFileDialog`, não é possível usar os mapas de mensagens e os modelos de caixa de diálogo. Em vez disso, você deve usar as interfaces COM para funcionalidade semelhante.

Para obter mais informações sobre como usar `CFileDialog`o, consulte [classes de caixa de diálogo comuns](../../mfc/common-dialog-classes.md).

## <a name="inheritance-hierarchy"></a>Hierarquia de herança

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>Requisitos

**Cabeçalho:** afxdlgs. h

##  <a name="addcheckbutton"></a>  CFileDialog::AddCheckButton

Adiciona um botão de seleção à caixa de diálogo.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do botão de seleção a ser adicionado.

*strLabel*<br/>
O nome do botão de verificação.

*bChecked*<br/>
Um booliano que indica o estado atual do botão de verificação. TRUE se marcado; Caso contrário, FALSE

### <a name="remarks"></a>Comentários

##  <a name="addcombobox"></a>  CFileDialog::AddComboBox

Adiciona uma caixa de combinação ao diálogo.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID da caixa de combinação a ser adicionada.

### <a name="remarks"></a>Comentários

##  <a name="addcontrolitem"></a>  CFileDialog::AddControlItem

Adiciona um item a um controle de contêiner na caixa de diálogo.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle de contêiner ao qual adicionar o item.

*dwIDItem*<br/>
A ID do item.

*strLabel*<br/>
Texto do item.

### <a name="remarks"></a>Comentários

##  <a name="addeditbox"></a>  CFileDialog::AddEditBox

Adiciona uma caixa de edição ao diálogo.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID da caixa de edição a ser adicionada.

*strText*<br/>
O nome da caixa de edição.

### <a name="remarks"></a>Comentários

##  <a name="addmenu"></a>  CFileDialog::AddMenu

Adiciona um menu à caixa de diálogo.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do menu a ser adicionado.

*strLabel*<br/>
O nome do menu.

### <a name="remarks"></a>Comentários

##  <a name="addplace"></a>  CFileDialog::AddPlace

Adiciona uma pasta à lista de locais disponíveis para o usuário abrir ou salvar itens.

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>Parâmetros

*lpszFolder*<br/>
Um caminho para a pasta a ser disponibilizada para o usuário. Isso só pode ser uma pasta.

*fdap*<br/>
Especifica onde a pasta é colocada dentro da lista.

*psi*<br/>
Um ponteiro para um IShellItem que representa a pasta a ser disponibilizada para o usuário. Isso só pode ser uma pasta.

### <a name="remarks"></a>Comentários

##  <a name="addpushbutton"></a>  CFileDialog::AddPushButton

Adiciona um botão à caixa de diálogo.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do botão a ser adicionado.

*strLabel*<br/>
O nome do botão.

### <a name="remarks"></a>Comentários

##  <a name="addradiobuttonlist"></a>  CFileDialog::AddRadioButtonList

Adiciona um grupo de botões de opção (também conhecido como botão de opção) à caixa de diálogo.

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do grupo de botões de opção a ser adicionado.

### <a name="remarks"></a>Comentários

##  <a name="addseparator"></a>CFileDialog:: AddSeparator

Adiciona um separador à caixa de diálogo.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do separador adicionado.

### <a name="remarks"></a>Comentários

##  <a name="addtext"></a>  CFileDialog::AddText

Adiciona texto à caixa de diálogo.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do texto a ser adicionado.

*strText*<br/>
O nome do texto.

### <a name="remarks"></a>Comentários

##  <a name="applyofntoshelldialog"></a>  CFileDialog::ApplyOFNToShellDialog

Atualiza o estado atual do [CFileDialog](../../mfc/reference/cfiledialog-class.md) com base nos valores armazenados na estrutura de `m_ofn` dados.

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Comentários

Nas versões do Windows anteriores ao Windows Vista, a estrutura de dados [da OPENFILENAME](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) do membro foi sincronizada continuamente com `CFileDialog`o estado do. Todas as alterações na variável de membro [m_ofn](#m_ofn) foram refletidas imediatamente no estado da caixa de diálogo. Além disso, todas as alterações no estado da caixa de diálogo atualizam `m_ofn` imediatamente a variável de membro.

No Windows Vista ou posterior, os valores na `m_ofn` variável `CFileDialog` de membro e no estado do não têm garantia de serem sincronizados. Essa função força o estado do `CFileDialog` a ser atualizado para `m_ofn` corresponder à estrutura. O Windows chama essa função automaticamente durante [CFileDialog::D omodal](#domodal).

Para obter mais informações sobre como usar a `CFileDialog` classe no Windows Vista ou posterior, consulte [classe CFileDialog](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Exemplo

  Consulte o exemplo de [CFileDialog:: UpdateOFNFromShellDialog](#updateofnfromshelldialog).

##  <a name="cfiledialog"></a>CFileDialog:: CFileDialog

Chame essa função para construir uma caixa de diálogo padrão de arquivo do Windows.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>Parâmetros

*bOpenFileDialog*<br/>
no O parâmetro que especifica que tipo de caixa de diálogo criar. Defina-a como TRUE para construir uma caixa de diálogo de **abertura de arquivo** . Defina-a como FALSE para construir uma caixa de diálogo **salvar arquivo como** .

*lpszDefExt*<br/>
no A extensão de nome de arquivo padrão. Se o usuário não incluir uma extensão conhecida (uma que tenha uma associação no computador do usuário) na caixa nome do arquivo, a extensão especificada por *lpszDefExt* será anexada automaticamente ao nome. Se esse parâmetro for NULL, nenhuma extensão será anexada.

*lpszFileName*<br/>
no O nome de arquivo inicial que aparece na caixa filename. Se for NULL, nenhum nome de arquivo inicial será exibido.

*dwFlags*<br/>
no Uma combinação de um ou mais sinalizadores que você pode usar para personalizar a caixa de diálogo. Para obter uma descrição desses sinalizadores, consulte a estrutura [da OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) no SDK do Windows. Se você modificar o `m_ofn.Flags` membro da estrutura, use um operador de bit-a-or em suas alterações para manter o comportamento padrão intacto.

*lpszFilter*<br/>
no Uma série de pares de cadeias de caracteres que especificam filtros que você pode aplicar ao arquivo. Se você especificar filtros de arquivo, somente os arquivos que correspondem aos critérios de filtro aparecerão na lista de arquivos. Consulte a seção comentários para obter mais informações sobre como trabalhar com filtros de arquivo.

*pParentWnd*<br/>
no Um ponteiro para a janela pai ou proprietário da caixa de diálogo de arquivo.

*dwSize*<br/>
no O tamanho da `OPENFILENAME` estrutura. Esse valor depende da versão do sistema operacional. O MFC usou esse parâmetro para determinar o tipo apropriado de caixa de diálogo a ser criada. O tamanho padrão de 0 significa que o código MFC determinará o tamanho correto da caixa de diálogo a ser usada com base na versão do sistema operacional em que o programa é executado.

*bVistaStyle*<br/>
no **Observação** Esse parâmetro está disponível no Visual Studio 2008 e posterior e faz com que a caixa de diálogo novo estilo seja usada somente se você estiver executando no Windows Vista ou posterior.

O parâmetro que especifica o estilo da caixa de diálogo de arquivo. Defina-a como TRUE para usar as novas caixas de diálogo de arquivo de estilo do vista. Caso contrário, o estilo antigo das caixas de diálogo será usado. Consulte a seção comentários para obter mais informações sobre como executar no vista.

### <a name="remarks"></a>Comentários

Uma caixa de diálogo **Abrir arquivo** ou **salvar arquivo como** é construída, dependendo do valor de *bOpenFileDialog*.

A especificação de uma extensão padrão usando *lpszDefExt* pode não produzir o comportamento esperado, pois raramente é previsível quais extensões têm associações de arquivo no computador do usuário. Se você precisar de mais controle sobre o acréscimo de uma extensão padrão, poderá derivar sua própria classe do `CFileDialog`e substituir o `CFileDialog::OnFileNameOK` método para executar sua própria manipulação de extensão.

Para permitir que o usuário Selecione vários arquivos, defina o sinalizador OFN_ALLOWMULTISELECT antes de chamar [DoModal](#domodal). Você deve fornecer seu próprio buffer de nome de arquivo para armazenar a lista retornada de vários nomes de arquivo. Faça isso substituindo `m_ofn.lpstrFile` por um ponteiro para um buffer que você alocou, depois de construir o [CFileDialog](../../mfc/reference/cfiledialog-class.md), mas antes de chamar `DoModal`. Além disso, você deve `m_ofn.nMaxFile` definir com o número de caracteres no buffer apontado por `m_ofn.lpstrFile`. Se você definir o número máximo de arquivos a serem selecionados como *n*, o tamanho de buffer necessário `n`será * (_MAX_PATH + 1) + 1. Por exemplo:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Para permitir que o usuário redimensione uma caixa de diálogo estilo do Explorer usando o mouse ou o teclado, defina o sinalizador OFN_ENABLESIZING. A definição desse sinalizador será necessária somente se você fornecer um procedimento de gancho ou modelo personalizado. O sinalizador funciona apenas com uma caixa de diálogo estilo de Gerenciador; as caixas de diálogo de estilo antigo não podem ser redimensionadas.

O parâmetro *lpszFilter* é usado para determinar o tipo de nome de arquivo que um arquivo deve ter para ser exibido na lista de arquivos. A primeira cadeia de caracteres no par de cadeia de caracteres descreve o filtro; a segunda cadeia de caracteres indica a extensão de nome de arquivo a ser usada. Várias extensões podem ser especificadas usando um ponto-e-vírgula (o caractere '; ') como o delimitador. A cadeia de caracteres termina com&#124;dois ' ' caracteres, seguidos de um caractere nulo. Você também pode usar um objeto [CString](../../atl-mfc-shared/using-cstring.md) para esse parâmetro.

Por exemplo, o Microsoft Excel permite que os usuários abram arquivos que têm extensões. xlc (gráfico) ou. xls (planilha), entre outros. O filtro para Excel pode ser escrito como:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

No entanto, se você planeja usar essa cadeia de caracteres para `OPENFILENAME` atualizar diretamente a estrutura, você deve delimitar suas cadeias de caracteres com o caractere nulo, ' \ 0 ',&#124;em vez das barras verticais (' ').

O parâmetro *bVistaStyle* é aplicável somente quando executado no Windows Vista ou posterior. Em versões anteriores do Windows, esse parâmetro é ignorado. Se *bVistaStyle* for definido como true, quando você compilar um programa com o Visual Studio 2008 ou posterior, a caixa de **diálogo novo arquivo** de estilo do vista será usada. Caso contrário, a caixa de **diálogo de arquivo** de estilo MFC anterior será usada.

Não há suporte para modelos de caixa de diálogo em caixas de diálogo com base em *bVistaStyle*

### <a name="example"></a>Exemplo

  Consulte o exemplo de [CFileDialog::D omodal](#domodal).

##  <a name="domodal"></a>CFileDialog::D oModal

Chame essa função para exibir a caixa de diálogo arquivo comum do Windows e permitir que o usuário procure arquivos e diretórios e insira um nome de arquivo.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Valor de retorno

IDOK ou IDCANCEL. Se IDCANCEL for retornado, chame a função [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror) do Windows para determinar se ocorreu um erro.

IDOK e IDCANCEL são constantes que indicam se o usuário selecionou o botão OK ou cancelar.

### <a name="remarks"></a>Comentários

Se você quiser inicializar as várias opções de caixa de diálogo de arquivo definindo os membros da `m_ofn` estrutura, faça isso antes de chamar `DoModal`, mas depois que o objeto da caixa de diálogo for construído.

Por exemplo, se você quiser permitir que o usuário Selecione vários arquivos, defina o sinalizador OFN_ALLOWMULTISELECT antes de chamar `DoModal`, conforme mostrado no exemplo de código neste tópico.

Quando o usuário clica nos botões OK ou cancelar da caixa de diálogo, ou seleciona a opção fechar no menu controle da caixa de diálogo, o controle é retornado ao seu aplicativo. Em seguida, você pode chamar outras funções de membro para recuperar as configurações ou informações que o usuário insere na caixa de diálogo.

`DoModal`é uma função virtual substituída da `CDialog`classe.

### <a name="example"></a>Exemplo

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

##  <a name="enableopendropdown"></a>  CFileDialog::EnableOpenDropDown

Habilita uma lista suspensa no botão abrir ou salvar na caixa de diálogo.

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID da lista suspensa.

### <a name="remarks"></a>Comentários

##  <a name="endvisualgroup"></a>  CFileDialog::EndVisualGroup

Interrompe a adição de elementos a um grupo Visual na caixa de diálogo.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>Valor de retorno

Retornará S_OK se for bem-sucedido; caso contrário, será um valor de erro.

### <a name="remarks"></a>Comentários

##  <a name="getcheckbuttonstate"></a>  CFileDialog::GetCheckButtonState

Recupera o estado atual de um botão de verificação (caixa de seleção) no diálogo.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID da caixa de seleção.

*bChecked*<br/>
O estado da caixa de seleção. VERDADEIRO indica marcado; FALSE indica desmarcado.

### <a name="remarks"></a>Comentários

##  <a name="getcontrolitemstate"></a>  CFileDialog::GetControlItemState

Recupera o estado atual de um item em um controle de contêiner encontrado na caixa de diálogo.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle de contêiner.

*dwIDItem*<br/>
A ID do item.

*dwState*<br/>
Uma referência a uma variável que recebe um ou mais valores da enumeração CDCONTROLSTATE que indica o estado atual do controle.

### <a name="remarks"></a>Comentários

##  <a name="getcontrolstate"></a>  CFileDialog::GetControlState

Recupera a visibilidade atual e os Estados habilitados de um determinado controle.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle.

*dwState*<br/>
Uma referência a uma variável que recebe um ou mais valores da enumeração CDCONTROLSTATE que indica o estado atual do controle.

### <a name="remarks"></a>Comentários

##  <a name="geteditboxtext"></a>  CFileDialog::GetEditBoxText

Recupera o texto atual em um controle de caixa de edição.

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID da caixa de edição.

*strText*<br/>
O valor do texto.

### <a name="remarks"></a>Comentários

##  <a name="getfileext"></a>  CFileDialog::GetFileExt

Chame essa função para recuperar a extensão do nome de arquivo inserido na caixa de diálogo.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>Valor de retorno

A extensão do nome de arquivo.

### <a name="remarks"></a>Comentários

Por exemplo, se o nome do arquivo inserido for DATA. Txt, `GetFileExt` retorna "txt".

Se `m_ofn.Flags` tiver o sinalizador OFN_ALLOWMULTISELECT definido, essa cadeia de caracteres conterá uma sequência de cadeias de caracteres terminadas em nulo, com a primeira cadeia de caracteres do caminho do diretório do grupo de arquivos selecionado, seguida pelos nomes de todos os arquivos selecionados pelo usuário. Para recuperar os caminhos de arquivo, use as funções de membro [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) .

##  <a name="getfilename"></a>  CFileDialog::GetFileName

Chame essa função para recuperar o nome do nome de arquivo inserido na caixa de diálogo.

```
CString GetFileName() const;
```

### <a name="return-value"></a>Valor de retorno

O nome do arquivo.

### <a name="remarks"></a>Comentários

O nome do arquivo inclui o prefixo e a extensão. Por exemplo, `GetFileName` retornará "Text. DAT "para o arquivo C:\FILES\TEXT.DAT.

Se `m_ofn.Flags` tiver o `OFN_ALLOWMULTISELECT` sinalizador definido, você deverá chamar [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) para recuperar um nome de caminho de arquivo.

##  <a name="getfiletitle"></a>  CFileDialog::GetFileTitle

Chame essa função para recuperar o título do arquivo inserido na caixa de diálogo.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>Valor de retorno

O título do arquivo.

### <a name="remarks"></a>Comentários

O título do arquivo inclui apenas seu prefixo, sem o caminho ou a extensão. Por exemplo, `GetFileTitle` retornará "text" para o arquivo C:\FILES\TEXT.dat.

Se `m_ofn.Flags` tiver o sinalizador OFN_ALLOWMULTISELECT definido, essa cadeia de caracteres conterá uma sequência de cadeias de caracteres terminadas em nulo, com a primeira cadeia de caracteres do caminho do diretório do grupo de arquivos selecionado, seguida pelos nomes de todos os arquivos selecionados pelo usuário. Por esse motivo, use as funções de membro [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) para recuperar o próximo nome de arquivo na lista.

### <a name="example"></a>Exemplo

  Consulte o exemplo de [CFileDialog::D omodal](#domodal).

##  <a name="getfolderpath"></a>  CFileDialog::GetFolderPath

Chame essa função de membro para recuperar o caminho da pasta ou do diretório aberto no momento para uma caixa de diálogo aberta no estilo do Explorer ou salvar como comum.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>Valor de retorno

Um objeto [CString](../../atl-mfc-shared/reference/cstringt-class.md) que contém a pasta ou o diretório aberto no momento.

### <a name="remarks"></a>Comentários

A caixa de diálogo deve ter sido criada com o estilo OFN_EXPLORER; caso contrário, o método falhará com uma asserção.

Você pode chamar esse método somente enquanto a caixa de diálogo está sendo exibida. Depois que a caixa de diálogo for fechada, essa função não funcionará mais, e o método falhará com uma asserção.

##  <a name="getifiledialogcustomize"></a>  CFileDialog::GetIFileDialogCustomize

Recupera um ponteiro para o objeto COM interno para um determinado [CFileDialog](../../mfc/reference/cfiledialog-class.md).

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>Valor de retorno

O ponteiro para o objeto COM interno para o `CFileDialog`. É sua responsabilidade liberar esse ponteiro adequadamente.

### <a name="remarks"></a>Comentários

Use essa função somente no Windows Vista ou posterior com um objeto que tenha *bVistaStyle* definido como true. Se você usar essa função quando *bVistaStyle* for false, ela retornará NULL no modo de liberação e lançará uma asserção no modo de depuração.

Para obter mais informações sobre `IFileDialogCustomize` a interface, consulte [IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

### <a name="example"></a>Exemplo

Este exemplo recupera o objeto COM interno. Para executar este exemplo de código, você deve compilá-lo no Windows Vista ou posterior.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

##  <a name="getifileopendialog"></a>  CFileDialog::GetIFileOpenDialog

Recupera um ponteiro para o objeto COM interno para um determinado `CFileDialog`.

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>Valor de retorno

O ponteiro para o objeto COM interno para o `CFileDialog`. É sua responsabilidade liberar esse ponteiro adequadamente.

### <a name="remarks"></a>Comentários

Use essa função somente no Windows Vista ou posterior com um objeto que tenha *bVistaStyle* definido como true. Essa função retornará NULL se o `CFileDialog` não for uma caixa de diálogo **aberta** ou se *bVistaStyle* estiver definido como false. Nesse último caso, a função retorna apenas NULL no modo de versão – no modo de depuração, ele gerará uma asserção.

Para obter mais informações sobre `IFileOpenDialog` a interface, consulte [IFileOpenDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifileopendialog).

### <a name="example"></a>Exemplo

Este exemplo recupera o objeto COM interno. Para executar esse código, você deve compilá-lo no Windows Vista ou posterior.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

##  <a name="getifilesavedialog"></a>  CFileDialog::GetIFileSaveDialog

Recupera um ponteiro para o objeto COM interno para um determinado `CFileDialog`.

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>Valor de retorno

O ponteiro para o objeto COM interno para o `CFileDialog`. É sua responsabilidade liberar esse ponteiro adequadamente.

### <a name="remarks"></a>Comentários

Use essa função somente no Windows Vista ou posterior com um objeto que tenha *bVistaStyle* definido como true. Essa função retornará NULL se `CFileDialog` não for uma caixa de diálogo de **salvamento** ou se *bVistaStyle* for definido como false. Nesse último caso, a função retorna apenas NULL no modo de versão – no modo de depuração, ele gerará uma asserção.

Para obter mais informações sobre `IFileSaveDialog` a interface, consulte [IFileSaveDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog).

### <a name="example"></a>Exemplo

Este exemplo recupera o objeto COM interno. Para executar este exemplo de código, você deve compilá-lo no Windows Vista ou posterior.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

##  <a name="getnextpathname"></a>  CFileDialog::GetNextPathName

Chame essa função para recuperar o próximo nome de arquivo do grupo selecionado na caixa de diálogo.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>Parâmetros

*pos*<br/>
Uma referência a um valor de posição retornado por uma `GetNextPathName` chamada `GetStartPosition` de função ou anterior. NULL se o final da lista tiver sido atingido.

### <a name="return-value"></a>Valor de retorno

O caminho completo do arquivo.

### <a name="remarks"></a>Comentários

O caminho do nome de arquivo inclui o título do arquivo e o caminho do diretório inteiro. Por exemplo, `GetNextPathName` retornará "C:\FILES\TEXT. DAT "para o arquivo C:\FILES\TEXT.DAT. Você pode usar `GetNextPathName` em um loop de iteração progressiva se estabelecer a posição inicial com uma chamada `GetStartPosition`para.

Se a seleção consistir em apenas um arquivo, esse nome de arquivo será retornado.

##  <a name="getofn"></a>  CFileDialog::GetOFN

Recupera a estrutura `OPENFILENAME` associada.

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>Valor de retorno

Uma estrutura [da OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) .

### <a name="remarks"></a>Comentários

Use a segunda versão dessa função para inicializar a aparência de uma caixa de diálogo **Abrir arquivo** ou **arquivo salvar como** depois que ela é construída, mas antes de ser exibida `DoModal` com a função de membro. Por exemplo, você pode definir o `lpstrTitle` membro de `m_ofn` para a legenda que deseja que a caixa de diálogo tenha.

##  <a name="getpathname"></a>  CFileDialog::GetPathName

Chame essa função para recuperar o caminho completo do arquivo inserido na caixa de diálogo.

```
CString GetPathName() const;
```

### <a name="return-value"></a>Valor de retorno

O caminho completo do arquivo.

### <a name="remarks"></a>Comentários

O caminho do nome de arquivo inclui o título do arquivo e o caminho do diretório inteiro. Por exemplo, `GetPathName` retornará "C:\FILES\TEXT. DAT "para o arquivo C:\FILES\TEXT.DAT.

Se `m_ofn.Flags` tiver o sinalizador OFN_ALLOWMULTISELECT definido, essa cadeia de caracteres conterá uma sequência de cadeias de caracteres NULL-teminated, com a primeira cadeia de caracteres do caminho do diretório do grupo de arquivos selecionado, seguida pelos nomes de todos os arquivos selecionados pelo usuário. Por esse motivo, use as funções de membro [GetStartPosition](#getstartposition) e [GetNextPathName](#getnextpathname) para recuperar o próximo nome de arquivo na lista.

### <a name="example"></a>Exemplo

  Consulte o exemplo de [CFileDialog::D omodal](#domodal).

##  <a name="getreadonlypref"></a>  CFileDialog::GetReadOnlyPref

Chame essa função para determinar se a caixa de seleção somente leitura foi selecionada nas caixas de diálogo abrir arquivo do Windows padrão e salvar arquivo como.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se a caixa de seleção somente leitura na caixa de diálogo estiver marcada; caso contrário, 0.

### <a name="remarks"></a>Comentários

Você pode ocultar a caixa de seleção somente leitura definindo o estilo OFN_HIDEREADONLY no `CFileDialog` Construtor.

> [!NOTE]
> Os objetos de estilo `CFileDialog` do Windows Vista ou posterior não oferecem suporte a essa função. A tentativa de usar essa função em um estilo `CFileDialog` do Windows Vista ou posterior gerará [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="getresult"></a>  CFileDialog::GetResult

Recupera a opção que o usuário fez na caixa de diálogo.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para um IShellItem que representa a opção do usuário.

### <a name="remarks"></a>Comentários

##  <a name="getresults"></a>  CFileDialog::GetResults

Recupera as opções do usuário em uma caixa de diálogo que permite seleção múltipla.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para um IShellItemArray por meio do qual os itens selecionados na caixa de diálogo podem ser acessados.

### <a name="remarks"></a>Comentários

##  <a name="getselectedcontrolitem"></a>  CFileDialog::GetSelectedControlItem

Recupera um item específico do controle de contêiner especificado na caixa de diálogo.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle de contêiner.

*dwIDItem*<br/>
A ID do item que o usuário selecionou no controle.

### <a name="remarks"></a>Comentários

##  <a name="getstartposition"></a>  CFileDialog::GetStartPosition

Chame essa função de membro para recuperar a posição do primeiro nome de caminho de arquivo na lista `m_ofn.Flags` , se tiver o sinalizador OFN_ALLOWMULTISELECT definido.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>Valor de retorno

Um valor de posição que pode ser usado para iteração; NULL se a lista estiver vazia.

##  <a name="hidecontrol"></a>  CFileDialog::HideControl

Chame essa função de membro para ocultar o controle especificado em uma caixa de diálogo abrir no estilo do Explorer ou salvar como comum.

```
void HideControl(int nID);
```

### <a name="parameters"></a>Parâmetros

*nID*<br/>
A ID do controle a ser ocultada.

### <a name="remarks"></a>Comentários

A caixa de diálogo deve ter sido criada com o estilo OFN_EXPLORER; caso contrário, a função falhará com uma asserção.

##  <a name="ispickfoldersmode"></a>  CFileDialog::IsPickFoldersMode

Determina se a caixa de diálogo atual está no modo de seletor de pasta.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>Valor de retorno

TRUE se a caixa de diálogo estiver no modo de seletor de pasta; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

##  <a name="m_ofn"></a>CFileDialog:: m_ofn

`m_ofn`é uma estrutura do tipo `OPENFILENAME`. Os dados nessa estrutura representam o estado atual do `CFileDialog`.

### <a name="remarks"></a>Comentários

Use essa estrutura para inicializar a aparência de uma caixa de diálogo **abrir** arquivo ou **arquivo salvar como** depois de construí-la, mas antes de exibi-la com o método [DoModal](#domodal) . Por exemplo, você pode definir o membro *lpstrTitle* de `m_ofn` para a legenda que você deseja que a caixa de diálogo tenha.

Com o estilo Windows Vista ou posterior de [CFileDialog](../../mfc/reference/cfiledialog-class.md), `m_ofn` não há garantia de que sempre corresponda ao estado da caixa de diálogo. Ele é sincronizado com a caixa de diálogo em versões anteriores do Windows. Consulte [CFileDialog:: ApplyOFNToShellDialog](#applyofntoshelldialog) e [CFileDialog:: UpdateOFNFromShellDialog](#updateofnfromshelldialog) para obter mais informações sobre a sincronização `m_ofn` da estrutura e `CFileDialog` o estado no Windows Vista ou posterior.

As caixas de diálogo de arquivo de estilo do Windows Vista ou posterior não dão suporte a `CFileDialog`determinados membros e sinalizadores do. Como resultado, elas não terão efeito.

Veja a seguir uma lista dos membros que não têm suporte do Windows Vista ou posterior:

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

Os seguintes sinalizadores não têm suporte e, portanto, não têm efeito quando você usa o estilo Windows Vista ou `CFileDialog`posterior de:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES-sempre no Windows Vista ou posterior

- OFN_NOLONGNAMES-efetivamente sempre no Windows Vista ou posterior

- OFN_NONETWORKBUTTON-sempre no Windows Vista ou posterior

- OFN_READONLY

- OFN_SHOWHELP

Para obter mais informações sobre essa estrutura, consulte a estrutura [da OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) no SDK do Windows.

##  <a name="makeprominent"></a>  CFileDialog::MakeProminent

Coloca um controle na caixa de diálogo para que ele se destaque em comparação com outros controles.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle.

### <a name="remarks"></a>Comentários

##  <a name="onbuttonclicked"></a>  CFileDialog::OnButtonClicked

Chamado quando o botão é clicado.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do botão.

### <a name="remarks"></a>Comentários

##  <a name="oncheckbuttontoggled"></a>  CFileDialog::OnCheckButtonToggled

Chamado quando a caixa de seleção está marcada ou desmarcada.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID da caixa de seleção.

*bChecked*<br/>
Marcado ou desmarcado.

### <a name="remarks"></a>Comentários

##  <a name="oncontrolactivating"></a>  CFileDialog::OnControlActivating

Chamado quando o controle é ativado.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle.

### <a name="remarks"></a>Comentários

##  <a name="onfilenamechange"></a>  CFileDialog::OnFileNameChange

Substitua esse método se você quiser manipular a mensagem WM_NOTIFY CDN_SELCHANGE.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Comentários

O sistema envia a mensagem CDN_SELCHANGE quando o usuário seleciona um novo arquivo ou pasta na lista de arquivos da caixa de diálogo **abrir** ou **salvar como** . Substitua esse método se você quiser executar qualquer ação em resposta a esta mensagem.

O sistema enviará essa mensagem somente se a caixa de diálogo tiver sido criada com o sinalizador OFN_EXPLORER ativado. Para obter mais informações sobre a notificação, consulte [CDN_SELCHANGE](/windows/desktop/dlgbox/cdn-selchange). Para obter informações sobre o sinalizador OFN_EXPLORER, consulte as caixas de diálogo estrutura [da OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) e [abrir e salvar como](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="onfilenameok"></a>  CFileDialog::OnFileNameOK

Substitua essa função somente se desejar fornecer validação personalizada de nomes de arquivos inseridos em uma caixa de diálogo de arquivo comum.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>Valor de retorno

1 se o nome do arquivo não for um nome de arquivo válido; caso contrário, 0.

### <a name="remarks"></a>Comentários

Essa função permite rejeitar um nome de arquivo para qualquer motivo específico do aplicativo. Normalmente, você não precisa usar essa função, pois a estrutura fornece validação padrão de nomes de arquivo e exibe uma caixa de mensagem se um nome inválido for inserido.

Se 1 for retornado, a caixa de diálogo permanecerá exibida para que o usuário insira outro nome de arquivo. O procedimento da caixa de diálogo ignora a caixa de diálogo se o retorno for 0. Outros valores de retorno diferentes de zero estão atualmente reservados e não devem ser usados.

##  <a name="onfolderchange"></a>  CFileDialog::OnFolderChange

Substitua essa função para manipular a mensagem WM_NOTIFYCDN_FOLDERCHANGE.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Comentários

A mensagem de notificação é enviada quando uma nova pasta é aberta na caixa de diálogo abrir ou salvar como.

A notificação será enviada somente se a caixa de diálogo tiver sido criada com o estilo OFN_EXPLORER. Para obter mais informações sobre a notificação, consulte [CDN_FOLDERCHANGE](/windows/desktop/dlgbox/cdn-folderchange). Para obter informações sobre o estilo OFN_EXPLORER, consulte a estrutura [da OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) e as [caixas de diálogo abrir e salvar como](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="oninitdone"></a>  CFileDialog::OnInitDone

Substitua essa função para manipular a mensagem WM_NOTIFY CDN_INITDONE.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Comentários

O sistema envia essa mensagem de notificação quando o sistema termina de organizar controles na caixa de diálogo **abrir** ou **salvar como** para liberar espaço para os controles da caixa de diálogo filho.

O sistema enviará isso somente se a caixa de diálogo tiver sido criada com o estilo OFN_EXPLORER. Para obter mais informações sobre a notificação, consulte [CDN_INITDONE](/windows/desktop/dlgbox/cdn-initdone). Para obter informações sobre o estilo OFN_EXPLORER, consulte a estrutura [da OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) e as [caixas de diálogo abrir e salvar como](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

> [!NOTE]
> As caixas de diálogo de arquivo de estilo do Windows Vista ou posterior não oferecem suporte a essa função. A tentativa de usar essa função em uma caixa de diálogo de arquivo de estilo do Windows Vista ou posterior gerará [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="onitemselected"></a>  CFileDialog::OnItemSelected

Chamado quando o item de contêiner é selecionado.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle de contêiner.

*dwIDItem*<br/>
A ID do item.

### <a name="remarks"></a>Comentários

##  <a name="onlbselchangednotify"></a>  CFileDialog::OnLBSelChangedNotify

Essa função é chamada sempre que a seleção atual em uma caixa de listagem está prestes a ser alterada.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>Parâmetros

*nIDBox*<br/>
A ID da caixa de listagem ou da caixa de combinação na qual a seleção ocorreu.

*iCurSel*<br/>
O índice da seleção atual.

*nCode*<br/>
O código de notificação de controle. Esse parâmetro deve ter um dos seguintes valores:

- CD_LBSELCHANGE especifica *iCurSel* é o item selecionado em uma caixa de listagem de seleção única.

- CD_LBSELSUB Especifica que o *iCurSel* não está mais selecionado em uma caixa de listagem de seleção.

- CD_LBSELADD especifica que *iCurSel* está selecionado em uma caixa de listagem de seleção multiseleções.

- CD_LBSELNOITEMS especifica que nenhuma seleção existe em uma caixa de listagem de seleção.

### <a name="remarks"></a>Comentários

Substitua essa função para fornecer manipulação personalizada de alterações de seleção na caixa de listagem. Por exemplo, você pode usar essa função para exibir os direitos de acesso ou a data da última modificação de cada arquivo que o usuário seleciona.

##  <a name="onshareviolation"></a>  CFileDialog::OnShareViolation

Substitua essa função para fornecer manipulação personalizada de violações de compartilhamento.

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Parâmetros

*lpszPathName*<br/>
O caminho do arquivo no qual ocorreu a violação de compartilhamento.

### <a name="return-value"></a>Valor de retorno

Um dos seguintes valores:

- OFN_SHAREFALLTHROUGH o nome do arquivo é retornado da caixa de diálogo.

- OFN_SHARENOWARN nenhuma ação adicional precisa ser executada.

- OFN_SHAREWARN o usuário recebe a mensagem de aviso padrão para esse erro.

### <a name="remarks"></a>Comentários

Normalmente, você não precisa usar essa função porque a estrutura fornece verificação padrão de violações de compartilhamento e exibe uma caixa de mensagem se ocorrer uma violação de compartilhamento.

Se você quiser desabilitar a verificação de violação de compartilhamento, use o operador OR bit a bit para combinar `m_ofn.Flags`o sinalizador OFN_SHAREAWARE com.

##  <a name="ontypechange"></a>CFileDialog:: OnTypeChange

Substitua essa função para manipular a mensagem WM_NOTIFYCDN_TYPECHANGE.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Comentários

A mensagem de notificação é enviada quando o usuário seleciona um novo tipo de arquivo na lista de tipos de arquivo na caixa de diálogo abrir ou salvar como.

A notificação será enviada somente se a caixa de diálogo tiver sido criada com o estilo OFN_EXPLORER. Para obter mais informações sobre a notificação, consulte [CDN_TYPECHANGE](/windows/desktop/dlgbox/cdn-typechange). Para obter informações sobre o estilo OFN_EXPLORER, consulte a estrutura [da OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) e as [caixas de diálogo abrir e salvar como](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="removecontrolitem"></a>  CFileDialog::RemoveControlItem

Remove um item de um controle de contêiner na caixa de diálogo.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle de contêiner do qual remover o item.

*dwIDItem*<br/>
A ID do item.

### <a name="remarks"></a>Comentários

##  <a name="setcheckbuttonstate"></a>  CFileDialog::SetCheckButtonState

Define o estado atual de um botão de verificação (caixa de seleção) no diálogo.

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID da caixa de seleção.

*bChecked*<br/>
O estado da caixa de seleção. VERDADEIRO indica marcado; FALSE indica desmarcado.

### <a name="remarks"></a>Comentários

##  <a name="setcontrolitemstate"></a>  CFileDialog::SetControlItemState

Define o estado atual de um item em um controle de contêiner encontrado na caixa de diálogo.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle de contêiner.

*dwIDItem*<br/>
A ID do item.

*dwState*<br/>
Um ou mais valores da enumeração CDCONTROLSTATE que indicam o novo estado do controle.

### <a name="remarks"></a>Comentários

##  <a name="setcontrolitemtext"></a>  CFileDialog::SetControlItemText

Define o texto de um item de controle. Por exemplo, o texto que acompanha um botão de opção ou um item em um menu.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle de contêiner.

*dwIDItem*<br/>
A ID do item.

*strLabel*<br/>
Texto do item.

### <a name="remarks"></a>Comentários

##  <a name="setcontrollabel"></a>  CFileDialog::SetControlLabel

Define o texto associado a um controle, como um texto de botão ou um rótulo de caixa de edição.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle.

*strLabel*<br/>
O nome do controle.

### <a name="remarks"></a>Comentários

##  <a name="setcontrolstate"></a>  CFileDialog::SetControlState

Define a visibilidade atual e os Estados habilitados de um determinado controle.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle.

*dwState*<br/>
Um ou mais valores da enumeração CDCONTROLSTATE que indicam o estado atual do controle.

### <a name="remarks"></a>Comentários

##  <a name="setcontroltext"></a>  CFileDialog::SetControlText

Chame esse método para definir o texto para o controle especificado em uma caixa de diálogo **abrir** no estilo do Explorer ou **salvar como** .

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>Parâmetros

*nID*<br/>
no A ID do controle para o qual definir o texto.

*lpsz*<br/>
no Um ponteiro para a cadeia de caracteres que contém o texto a ser definido para o controle.

### <a name="remarks"></a>Comentários

Ambas as versões dessa função são válidas para aplicativos que usam Unicode. No entanto, somente a versão com o tipo LPCSTR é válida para aplicativos que usam ANSI.

Para usar esse método, você deve criar a caixa de diálogo com o estilo OFN_EXPLORER. Caso contrário, a função falhará com uma asserção.

##  <a name="setdefext"></a>  CFileDialog::SetDefExt

Chame essa função para definir a extensão de nome de arquivo padrão para uma caixa de diálogo aberta no estilo do Explorer ou salvar como comum.

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>Parâmetros

*lpsz*<br/>
Um ponteiro para uma cadeia de caracteres que contém a extensão padrão a ser usada para o objeto da caixa de diálogo. Esta cadeia de caracteres não deve conter um ponto (.).

### <a name="remarks"></a>Comentários

A caixa de diálogo deve ter sido criada com o estilo OFN_EXPLORER; caso contrário, a função falhará com uma asserção.

##  <a name="seteditboxtext"></a>  CFileDialog::SetEditBoxText

Define o texto atual em um controle de caixa de edição.

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID da caixa de edição.

*strText*<br/>
O valor do texto.

### <a name="remarks"></a>Comentários

##  <a name="setproperties"></a>  CFileDialog::SetProperties

Fornece um repositório de propriedades que define os valores padrão a serem usados para o item que está sendo salvo.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>Parâmetros

*lpszPropList*<br/>
Uma lista de propriedades predefinidas separadas por ";". Para obter uma lista dos sinalizadores, consulte a seção **flags** de [da OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew).

### <a name="remarks"></a>Comentários

##  <a name="setselectedcontrolitem"></a>  CFileDialog::SetSelectedControlItem

Define o estado selecionado de um item específico em um grupo de botões de opção ou de uma caixa de combinação encontrada no diálogo.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do controle de contêiner.

*dwIDItem*<br/>
A ID do item que o usuário selecionou no controle.

### <a name="remarks"></a>Comentários

##  <a name="settemplate"></a>  CFileDialog::SetTemplate

Define o modelo de caixa de diálogo para o objeto [CFileDialog](../../mfc/reference/cfiledialog-class.md) .

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>Parâmetros

*nWin3ID*<br/>
no Contém o número de ID do recurso de modelo para o objeto que `CFileDialog` não é do Explorer. Este modelo só é usado no Windows NT 3,51 ou quando o estilo OFN_EXPLORER não está presente.

*nWin4ID*<br/>
no Contém o número de ID do recurso de modelo para o `CFileDialog` objeto do Gerenciador. Esse modelo é usado somente no Windows NT 4,0 e versões posteriores, Windows 95 e versões posteriores ou quando o estilo OFN_EXPLORER está presente.

*lpWin3ID*<br/>
no Contém o nome do recurso de modelo para o objeto que não `CFileDialog` é do Explorer. Este modelo só é usado no Windows NT 3,51 ou quando o estilo OFN_EXPLORER não está presente.

*lpWin4ID*<br/>
no Contém o nome do recurso de modelo do objeto Explorer `CFileDialog` . Esse modelo é usado somente no Windows NT 4,0 e versões posteriores, Windows 95 e versões posteriores ou quando o estilo OFN_EXPLORER está presente.

### <a name="remarks"></a>Comentários

O sistema usará apenas um dos modelos especificados. O sistema determina qual modelo usar com base na presença do estilo OFN_EXPLORER e no sistema operacional em que o aplicativo está sendo executado. Ao especificar um modelo que não seja o Explorer e o estilo do Explorer, é fácil dar suporte ao Windows NT 3,51, ao Windows NT 4,0 e às versões posteriores e ao Windows 95 e versões posteriores.

> [!NOTE]
> As caixas de diálogo de arquivo de estilo do Windows Vista ou posterior não oferecem suporte a essa função. A tentativa de usar essa função em uma caixa de diálogo de arquivo de estilo do Windows Vista ou posterior gerará [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). Uma alternativa é usar uma caixa de diálogo personalizada. Para obter mais informações sobre como usar `CFileDialog`um personalizado, consulte [IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

##  <a name="startvisualgroup"></a>  CFileDialog::StartVisualGroup

Declara um grupo Visual na caixa de diálogo. As chamadas subsequentes para qualquer método "Add" adicionam esses elementos a esse grupo.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Parâmetros

*dwIDCtl*<br/>
A ID do grupo Visual.

*strLabel*<br/>
O nome do grupo.

### <a name="remarks"></a>Comentários

##  <a name="updateofnfromshelldialog"></a>  CFileDialog::UpdateOFNFromShellDialog

Atualiza a `m_ofn` estrutura de dados do [CFileDialog](../../mfc/reference/cfiledialog-class.md) com base no estado atual do objeto interno.

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Comentários

Nas versões do Windows anteriores ao Windows Vista, a estrutura de dados [da OPENFILENAME](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) do membro foi sincronizada continuamente com `CFileDialog`o estado do. Qualquer alteração na variável de membro [m_ofn](#m_ofn) afetou diretamente o estado da caixa de diálogo. Além disso, todas as alterações no estado da caixa de diálogo atualizaram imediatamente a variável de membro m_ofn.

No Windows Vista ou posterior, a `m_ofn` estrutura de dados não é atualizada automaticamente. Para garantir a precisão dos dados na `m_ofn` variável de membro, você deve chamar a `UpdateOFNFromShellDialog` função antes de acessar os dados. O Windows chama essa função automaticamente durante o processamento de [IFileDialog:: OnFileOk](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok).

Para obter mais informações sobre como usar a `CFileDialog` classe no Windows Vista ou posterior, consulte [classe CFileDialog](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Exemplo

Este exemplo atualiza o `CFileDialog` antes de exibi-lo. Antes de atualizar `m_ofn` a variável de membro, precisamos sincronizá-la para o estado atual da caixa de diálogo.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>Consulte também

[Classe CCommonDialog](../../mfc/reference/ccommondialog-class.md)<br/>
[Gráfico da hierarquia](../../mfc/hierarchy-chart.md)
