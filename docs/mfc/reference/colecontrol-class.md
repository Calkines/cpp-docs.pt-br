---
title: Classe COleControl
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 30d73d546ee68a25f1e59776020477d038da65e8
ms.sourcegitcommit: 72583d30170d6ef29ea5c6848dc00169f2c909aa
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/18/2019
ms.locfileid: "58771494"
---
# <a name="colecontrol-class"></a>Classe COleControl

Uma classe base poderosa para desenvolvimento de controles OLE.

## <a name="syntax"></a>Sintaxe

```
class COleControl : public CWnd
```

## <a name="members"></a>Membros

### <a name="public-constructors"></a>Construtores públicos

|Nome|Descrição|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Cria um objeto `COleControl`.|

### <a name="public-methods"></a>Métodos públicos

|Nome|Descrição|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|Recupera a aparência atual do controle.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Retorna o valor da propriedade BackColor ambiente.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Retorna o nome do controle conforme especificado pelo contêiner.|
|[COleControl::AmbientFont](#ambientfont)|Retorna o valor da propriedade Font ambiente.|
|[COleControl::AmbientForeColor](#ambientforecolor)|Retorna o valor da propriedade de cor de primeiro plano ambiente.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Retorna a ID de localidade. do contêiner|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Retorna o tipo de unidades usadas pelo contêiner.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Determina se as alças de captura devem ser exibidas.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Determina se a hachura deve ser exibida.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Retorna o tipo de alinhamento de texto especificado pelo contêiner.|
|[COleControl::AmbientUIDead](#ambientuidead)|Determina se o controle deve responder às ações de interface do usuário.|
|[COleControl::AmbientUserMode](#ambientusermode)|Determina o modo do contêiner.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Notifica o contêiner que uma propriedade associada foi alterada.|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Solicita permissão para editar o valor da propriedade.|
|[COleControl::ClientToParent](#clienttoparent)|Converte um ponto relativo à origem do controle para um ponto relativo à origem do seu contêiner.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Ajusta a um retângulo de cursor se ele é sobreposto por um controle.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|Chame essa função depois que o conjunto de mnemônicos manipulados pelo controle foi alterado.|
|[COleControl::DisplayError](#displayerror)|Exibe eventos de erro de estoque ao usuário do controle.|
|[COleControl::DoClick](#doclick)|A implementação das ações `DoClick` método.|
|[COleControl::DoPropExchange](#dopropexchange)|Serializa as propriedades de um `COleControl` objeto.|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Redesenha a um controle OLE que tenha sido derivado de um controle do Windows.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Habilita o suporte de quadro simples para um controle.|
|[COleControl::ExchangeExtent](#exchangeextent)|Serializa a largura e altura do controle.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Serializa as propriedades de estoque do controle.|
|[COleControl::ExchangeVersion](#exchangeversion)|Serializa o número de versão do controle.|
|[COleControl::FireClick](#fireclick)|Aciona o estoque `Click` eventos.|
|[COleControl::FireDblClick](#firedblclick)|Aciona o estoque `DblClick` eventos.|
|[COleControl::FireError](#fireerror)|Aciona o estoque `Error` eventos.|
|[COleControl::FireEvent](#fireevent)|Dispara um evento personalizado.|
|[COleControl::FireKeyDown](#firekeydown)|Aciona o estoque `KeyDown` eventos.|
|[COleControl::FireKeyPress](#firekeypress)|Aciona o estoque `KeyPress` eventos.|
|[COleControl::FireKeyUp](#firekeyup)|Aciona o estoque `KeyUp` eventos.|
|[COleControl::FireMouseDown](#firemousedown)|Aciona o estoque `MouseDown` eventos.|
|[COleControl::FireMouseMove](#firemousemove)|Aciona o estoque `MouseMove` eventos.|
|[COleControl::FireMouseUp](#firemouseup)|Aciona o estoque `MouseUp` eventos.|
|[COleControl::FireReadyStateChange](#firereadystatechange)|Dispara um evento quando muda o estado do controle pronto.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Altera o comportamento padrão de ativação de um controle que suporta o `IPointerInactive` interface.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Retorna o valor da propriedade de ambiente especificada.|
|[COleControl::GetAppearance](#getappearance)|Retorna o valor da propriedade Appearance estoque.|
|[COleControl::GetBackColor](#getbackcolor)|Retorna o valor da propriedade BackColor estoque.|
|[COleControl::GetBorderStyle](#getborderstyle)|Retorna o valor da propriedade BorderStyle estoque.|
|[COleControl::GetCapture](#getcapture)|Determina se um objeto de controle sem janelas, ativado tem a captura do mouse.|
|[COleControl::GetClassID](#getclassid)|Recupera a ID de classe OLE do controle.|
|[COleControl::GetClientOffset](#getclientoffset)|Recupera a diferença entre o canto superior esquerdo da área retangular do controle e o canto superior esquerdo da sua área de cliente.|
|[COleControl::GetClientRect](#getclientrect)|Recupera o tamanho da área de cliente do controle.|
|[COleControl::GetClientSite](#getclientsite)|Consultas de um objeto para o ponteiro para seu site atual do cliente dentro de seu contêiner.|
|[COleControl::GetControlFlags](#getcontrolflags)|Recupera as configurações de sinalizador de controle.|
|[COleControl::GetControlSize](#getcontrolsize)|Retorna a posição e o tamanho do controle OLE.|
|[COleControl::GetDC](#getdc)|Fornece um meio para um controle sem janelas obter um contexto de dispositivo de seu contêiner.|
|[COleControl::GetEnabled](#getenabled)|Retorna o valor da propriedade Enabled de ação.|
|[COleControl::GetExtendedControl](#getextendedcontrol)|Recupera um ponteiro para um objeto de controle estendido que pertence ao contêiner.|
|[COleControl::GetFocus](#getfocus)|Determina se o controle tem o foco.|
|[COleControl::GetFont](#getfont)|Retorna o valor da propriedade de fonte de estoque.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Retorna as métricas de um `CFontHolder` objeto.|
|[COleControl::GetForeColor](#getforecolor)|Retorna o valor da propriedade ForeColor estoque.|
|[COleControl::GetHwnd](#gethwnd)|Retorna o valor da propriedade de estoque hWnd.|
|[COleControl::GetMessageString](#getmessagestring)|Fornece o texto da barra de status para um item de menu.|
|[COleControl::GetNotSupported](#getnotsupported)|Impede o acesso ao valor da propriedade do controle pelo usuário.|
|[COleControl::GetReadyState](#getreadystate)|Retorna o estado de preparação do controle.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Retorna o retângulo do controle relativo ao respectivo contêiner.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Retorna as métricas de propriedade de fonte de estoque.|
|[COleControl::GetText](#gettext)|Retorna o valor da propriedade de texto ou uma legenda estoque.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Substitua para permitir que um controle sem janelas ser o destino de arrastar e soltar operações.|
|[COleControl::InitializeIIDs](#initializeiids)|Informa as IIDs o controle usará a classe base.|
|[COleControl::InternalGetFont](#internalgetfont)|Retorna um `CFontHolder` objeto para a propriedade de fonte de estoque.|
|[COleControl::InternalGetText](#internalgettext)|Recupera a propriedade de legenda ou texto de estoque.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Define o estado de preparação do controle e aciona o evento de alteração de estado pronto.|
|[COleControl::InvalidateControl](#invalidatecontrol)|Invalida a uma área do controle exibido, fazendo com que ele seja redesenhado.|
|[COleControl::InvalidateRgn](#invalidatergn)|Invalida a área de cliente da janela do contêiner em determinada região. Pode ser usado para redesenhar os controles sem janelas na região.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Permite o carregamento especializado de um controle OLE.|
|[COleControl::IsModified](#ismodified)|Determina se o estado do controle foi alterado.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Indica se o contêiner suporta desenho otimizado para a operação atual de desenho.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Chamado para determinar se o controle subdivide um Windows controlar.|
|[COleControl::Load](#load)|Redefine todos os dados anteriores assíncronos e inicia uma nova carga da propriedade do controle assíncrono.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Determina se o controle pode ser desativado pelo contêiner.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Chamado quando uma propriedade de ambiente é alterada.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Chamado quando a estoque propriedade Appearance é alterada.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Chamado quando a propriedade de estoque BackColor é alterada.|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Chamado quando a propriedade de estoque BorderStyle é alterada.|
|[COleControl::OnClick](#onclick)|Chamado para acionar o estoque, clique em eventos.|
|[COleControl::OnClose](#onclose)|Notifica o controle que `IOleControl::Close` foi chamado.|
|[COleControl::OnDoVerb](#ondoverb)|Chamado depois que um verbo de controle foi executado.|
|[COleControl::OnDraw](#ondraw)|Chamado quando um controle é solicitado para redesenhar a mesmo.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Chamado pelo contêiner quando um controle é solicitado para redesenhar a mesmo usando um contexto de dispositivo de metarquivo.|
|[COleControl::OnEdit](#onedit)|Chamado pelo contêiner de interface do usuário ativar um controle OLE.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Chamado quando a propriedade Enabled de estoque é alterada.|
|[COleControl::OnEnumVerbs](#onenumverbs)|Chamado pelo contêiner para enumerar os verbos do controle.|
|[COleControl::OnEventAdvise](#oneventadvise)|Chamado quando manipuladores de eventos estão conectados ou desconectados de um controle.|
|[COleControl::OnFontChanged](#onfontchanged)|Chamado quando a propriedade de fonte de estoque é alterada.|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Chamado quando a propriedade de estoque ForeColor é alterada.|
|[COleControl::OnFreezeEvents](#onfreezeevents)|Chamado quando os eventos de um controle são congelados ou descongelados.|
|[COleControl::OnGetColorSet](#ongetcolorset)|Notifica o controle que `IOleObject::GetColorSet` foi chamado.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Fornece informações mnemônicos ao contêiner.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Chamado para obter uma cadeia de caracteres para representar um valor da propriedade.|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Solicita o identificador do menu do controle que será mesclado com o menu de contêiner.|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Substitua para recuperar o tamanho do controle exibição mais próximo para o modo de tamanho e a extensão proposto.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Retorna cadeias de caracteres que representa os valores possíveis para uma propriedade.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Retorna o valor correspondente a uma cadeia de caracteres predefinida.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|Substitua para recuperar o tamanho das áreas de exibição do controle (pode ser usado para habilitar o desenho de duas etapas).|
|[COleControl::OnGetViewRect](#ongetviewrect)|Substituição para converter o tamanho do controle em um retângulo que começa em uma posição específica.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Substitua para recuperar o status do modo de exibição do controle.|
|[COleControl::OnHideToolBars](#onhidetoolbars)|Chamado pelo contêiner quando o controle é desativado pela IU.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Substitua para ter o contêiner para o controle inativo em que as mensagens de WM_MOUSEMOVE de expedição de ponteiro do mouse para o controle.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Substitua para ter o contêiner para o controle inativo em que as mensagens de WM_SETCURSOR de expedição de ponteiro do mouse para o controle.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Chamado depois que o evento KeyDown estoque foi acionado.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Chamado depois que o evento KeyPress estoque foi acionado.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Chamado depois que o evento KeyUp estoque foi acionado.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Indica qual página de propriedade a ser usado para editar uma propriedade.|
|[COleControl::OnMnemonic](#onmnemonic)|Chamado quando uma tecla mnemônica do controle foi pressionada.|
|[COleControl::OnProperties](#onproperties)|Chamado quando o verbo de "Propriedades" do controle foi invocado.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Substitua a consulta se a exibição de um controle se sobrepõe a um determinado ponto.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Substitua a consulta se a exibição de um controle se sobrepõe a qualquer ponto em um retângulo determinado.|
|[COleControl::OnRenderData](#onrenderdata)|Chamado pelo framework para recuperar dados no formato especificado.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|Chamado pelo framework para recuperar dados de um arquivo no formato especificado.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Chamado pelo framework para recuperar dados de memória global no formato especificado.|
|[COleControl::OnResetState](#onresetstate)|Redefine as propriedades de um controle com os valores padrão.|
|[COleControl::OnSetClientSite](#onsetclientsite)|Notifica o controle que `IOleControl::SetClientSite` foi chamado.|
|[COleControl::OnSetData](#onsetdata)|Substitui os dados do controle com outro valor.|
|[COleControl::OnSetExtent](#onsetextent)|Chamado depois que a extensão do controle foi alterado.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Chamado depois que foram alteradas dimensões do controle.|
|[COleControl::OnShowToolBars](#onshowtoolbars)|Chamado quando o controle tiver sido ativada de interface do usuário.|
|[COleControl::OnTextChanged](#ontextchanged)|Chamado quando o estoque de texto ou a propriedade de legenda é alterada.|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Processa as mensagens de janela (diferente de mensagens de mouse e teclado) para controles sem janelas.|
|[COleControl::ParentToClient](#parenttoclient)|Converte um ponto relativo à origem do contêiner para um ponto relativo à origem do controle.|
|[COleControl::PostModalDialog](#postmodaldialog)|Notifica o contêiner que uma caixa de diálogo modal foi fechada.|
|[COleControl::PreModalDialog](#premodaldialog)|Notifica o contêiner que uma caixa de diálogo modal está prestes a ser exibido.|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Destrói e cria novamente a janela do controle.|
|[COleControl::Refresh](#refresh)|Força um redesenho da aparência de um controle.|
|[COleControl::ReleaseCapture](#releasecapture)|Libera a captura do mouse.|
|[COleControl::ReleaseDC](#releasedc)|Libera o contexto de dispositivo de exibição de um contêiner de um controle sem janelas.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Redefine o pai da janela de controle.|
|[COleControl::ResetStockProps](#resetstockprops)|Inicializa `COleControl` propriedades para seus valores padrão de estoque.|
|[COleControl::ResetVersion](#resetversion)|Inicializa o número de versão para um determinado valor.|
|[COleControl::ScrollWindow](#scrollwindow)|Permite que um controle sem janelas rolar uma área dentro de sua imagem de Active Directory no local na exibição.|
|[COleControl::SelectFontObject](#selectfontobject)|Seleciona uma propriedade de fonte personalizada em um contexto de dispositivo.|
|[COleControl::SelectStockFont](#selectstockfont)|Seleciona a propriedade de fonte de estoque em um contexto de dispositivo.|
|[COleControl::SerializeExtent](#serializeextent)|Serializa ou inicializa o espaço de exibição para o controle.|
|[COleControl::SerializeStockProps](#serializestockprops)|Serializa ou inicializa o `COleControl` propriedades de estoque.|
|[COleControl::SerializeVersion](#serializeversion)|Serializa ou inicializa as informações de versão do controle.|
|[COleControl::SetAppearance](#setappearance)|Define o valor da propriedade Appearance estoque.|
|[COleControl::SetBackColor](#setbackcolor)|Define o valor da propriedade BackColor estoque.|
|[COleControl::SetBorderStyle](#setborderstyle)|Define o valor da propriedade BorderStyle estoque.|
|[COleControl::SetCapture](#setcapture)|Faz com que a janela do controle recipiente entrem em posse da captura do mouse no nome do controle.|
|[COleControl::SetControlSize](#setcontrolsize)|Define a posição e o tamanho do controle OLE.|
|[COleControl::SetEnabled](#setenabled)|Define o valor da propriedade Enabled de ação.|
|[COleControl::SetFocus](#setfocus)|Faz com que a janela do controle recipiente tomar posse do foco de entrada em nome do controle.|
|[COleControl::SetFont](#setfont)|Define o valor da propriedade de fonte de estoque.|
|[COleControl::SetForeColor](#setforecolor)|Define o valor da propriedade ForeColor estoque.|
|[COleControl::SetInitialSize](#setinitialsize)|Define o tamanho de um controle OLE quando exibido pela primeira vez em um contêiner.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Altera o estado modificado de um controle.|
|[COleControl::SetNotPermitted](#setnotpermitted)|Indica que uma solicitação de edição falhou.|
|[COleControl::SetNotSupported](#setnotsupported)|Impede a modificação para o valor da propriedade do controle pelo usuário.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Define o retângulo do controle relativo ao respectivo contêiner.|
|[COleControl::SetText](#settext)|Define o valor da propriedade de texto ou uma legenda estoque.|
|[COleControl::ThrowError](#throwerror)|Indica que ocorreu um erro em um controle OLE.|
|[COleControl::TransformCoords](#transformcoords)|Transformações de coordenam os valores entre um contêiner e o controle.|
|[COleControl::TranslateColor](#translatecolor)|Converte um valor OLE_COLOR para um valor COLORREF.|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Determina se propriedades de ambiente estarão disponíveis na próxima vez que o controle for carregado.|
|[COleControl::WindowProc](#windowproc)|Fornece um procedimento do Windows para um `COleControl` objeto.|

### <a name="protected-methods"></a>Métodos Protegidos

|Nome|Descrição|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|Chamado pelo framework quando a aparência do controle precisa ser atualizado.|
|[COleControl::DrawMetafile](#drawmetafile)|Chamado pelo framework quando o contexto de dispositivo de metarquivo está sendo usado.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Permite a invocação de método de automação.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Chamado pelo framework para inicializar a lista de formatos de dados compatível com o controle.|

## <a name="remarks"></a>Comentários

Derivada de `CWnd`, essa classe herda a funcionalidade adicional específica para OLE, como o acionamento do evento e a capacidade de dar suporte a métodos e propriedades além de toda a funcionalidade de um objeto de janela do Windows.

Controles OLE podem ser inseridos em aplicativos de contêiner OLE e se comunicar com o contêiner usando um sistema bidirecional de acionamento do evento e expõe métodos e propriedades para o contêiner. Observe que os contêineres OLE padrão suportam apenas a funcionalidade básica de um controle OLE. Eles não conseguem dar suporte a recursos estendidos de um controle OLE. Acionamento de evento ocorre quando eventos são enviados para o contêiner como resultado de determinadas ações que estão ocorrendo no controle. Por sua vez, o contêiner se comunica com o controle por meio de um conjunto de métodos e propriedades análogas às funções de membro de expostos e membros de dados de uma classe C++. Essa abordagem permite ao desenvolvedor controlar a aparência do controle e notificar o contêiner quando certas ações ocorrem.

## <a name="windowless-controls"></a>Controles sem janelas

Controles OLE podem ser ativado usado sem uma janela. Controles sem janelas tem vantagens significativas:

- Controles sem janelas podem ser transparente e não retangulares

- Controles sem janelas reduzem o tempo de criação e o tamanho de instância do objeto

Controles não precisam de uma janela. Serviços que oferece uma janela podem ser fornecidos com facilidade por meio de uma única janela compartilhada (normalmente do contêiner) e um pouco de código de expedição. Ter uma janela é principalmente uma complicação desnecessária no objeto.

Quando a ativação sem janelas for usada, o contêiner (que têm uma janela) é responsável por fornecer os serviços que seriam caso contrário, foram fornecidos pela janela do controle. Por exemplo, se seu controle precisa consultar o foco do teclado, consulte a captura do mouse ou obter um contexto de dispositivo, essas operações são gerenciadas pelo contêiner. O `COleControl` funções de membro de operação sem janelas invocam essas operações no contêiner.

Quando a ativação sem janelas é habilitada, os delegados de contêiner do controle de mensagens de entrada `IOleInPlaceObjectWindowless` interface (uma extensão da [IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject) para suporte sem janelas). `COleControl`da implementação dessa interface enviará essas mensagens por meio do mapa de mensagens do seu controle, depois de ajustar o mouse coordena adequadamente. Você pode processar essas mensagens, como mensagens de janela normal, adicionando as entradas correspondentes no mapa de mensagem.

Em um controle sem janelas, você sempre deve usar o `COleControl` funções de membro em vez de correspondente `CWnd` funções de membro ou as funções de API do Windows relacionadas.

Objetos de controle OLE também podem criar uma janela somente quando eles se tornar ativos, mas aumenta a quantidade de trabalho necessário para a transição de ativos inativos e a velocidade da transição é desativado. Há casos em que esse é um problema: por exemplo, considere uma grade de caixas de texto. Quando o cursor para cima e para baixo por meio da coluna, cada controle deve ser in-loco ativado e, em seguida, desativado. A velocidade da transição inativos/ativo irá afetar diretamente a velocidade de rolagem.

Para obter mais informações sobre como desenvolver uma estrutura de controle OLE, consulte os artigos [controles ActiveX do MFC](../../mfc/mfc-activex-controls.md) e [visão geral: Criando um programa de controle ActiveX do MFC](../../mfc/reference/mfc-activex-control-wizard.md). Para obter informações sobre como otimizar a controles OLE, incluindo controles sem janelas e sem cintilação, consulte [controles ActiveX MFC: Otimização](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Hierarquia de herança

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Requisitos

**Cabeçalho:** afxctl. h

##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor

Retorna o valor da propriedade BackColor ambiente.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Valor de retorno

O valor atual do BackColor propriedade de ambiente do contêiner, se houver. Se não há suporte para a propriedade, essa função retorna a cor de plano de fundo do Windows definida pelo sistema.

### <a name="remarks"></a>Comentários

A propriedade BackColor do ambiente está disponível para todos os controles e é definida pelo contêiner. Observe que o contêiner não é necessário para dar suporte a essa propriedade.

##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName

O nome que o contêiner foi atribuído ao controle pode ser usado em mensagens de erro exibidas para o usuário.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Valor de retorno

O nome do controle OLE. O padrão é uma cadeia de caracteres de comprimento zero.

### <a name="remarks"></a>Comentários

Observe que o contêiner não é necessário para dar suporte a essa propriedade.

##  <a name="ambientfont"></a>  COleControl::AmbientFont

Retorna o valor da propriedade Font ambiente.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para a interface de expedição de fonte ambiente do contêiner. O valor padrão é NULL. Se o retorno não for igual a NULL, você será responsável por liberar a fonte chamando seus [IUnknown:: Release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) função de membro.

### <a name="remarks"></a>Comentários

A propriedade da fonte do ambiente é definido pelo contêiner e disponível para todos os controles. Observe que o contêiner não é necessário para dar suporte a essa propriedade.

##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor

Retorna o valor da propriedade de cor de primeiro plano ambiente.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Valor de retorno

O valor atual do ForeColor propriedade de ambiente do contêiner, se houver. Se não tiver suporte, essa função retorna a cor do texto definido pelo sistema Windows.

### <a name="remarks"></a>Comentários

A propriedade de cor de primeiro plano ambiente está disponível para todos os controles e é definida pelo contêiner. Observe que o contêiner não é necessário para dar suporte a essa propriedade.

##  <a name="ambientlocaleid"></a>  COleControl::AmbientLocaleID

Retorna a ID de localidade. do contêiner

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Valor de retorno

O valor da propriedade de identificação de localidade do contêiner, se houver. Se não há suporte para essa propriedade, essa função retorna 0.

### <a name="remarks"></a>Comentários

O controle pode usar a identificação de localidade para adaptar sua interface do usuário para localidades específicas. Observe que o contêiner não é necessário para dar suporte a essa propriedade.

##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance

Recupera a configuração atual de aparência para o objeto de controle.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Valor de retorno

A aparência do controle:

- **0** simples aparência

- **1** aparência 3D

### <a name="remarks"></a>Comentários

Chame essa função para recuperar o valor atual da propriedade DISPID_AMBIENT_APPEARANCE para o controle.

##  <a name="ambientscaleunits"></a>  COleControl::AmbientScaleUnits

Retorna o tipo de unidades usadas pelo contêiner.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Valor de retorno

Uma cadeia de caracteres que contém o ambiente ScaleUnits do contêiner. Se não há suporte para essa propriedade, essa função retorna uma cadeia de caracteres de comprimento zero.

### <a name="remarks"></a>Comentários

Propriedade ScaleUnits de ambiente do contêiner pode ser usada para exibir posições ou dimensões, rotuladas com a unidade escolhida, como twips ou centímetros. Observe que o contêiner não é necessário para dar suporte a essa propriedade.

##  <a name="ambientshowgrabhandles"></a>  COleControl::AmbientShowGrabHandles

Determina se o contêiner permite o controle para exibir as alças de captura para si mesmo quando ativo.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se as alças de captura devem ser exibidas; Caso contrário, 0. Se não há suporte para essa propriedade, essa função retorna não zero.

### <a name="remarks"></a>Comentários

Observe que o contêiner não é necessário para dar suporte a essa propriedade.

##  <a name="ambientshowhatching"></a>  COleControl::AmbientShowHatching

Determina se o contêiner permite o controle para exibir a mesmo com um tracejada padrão quando o ativo de interface do usuário.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o padrão de hachurado deve ser mostrado; Caso contrário, 0. Se não há suporte para essa propriedade, essa função retorna não zero.

### <a name="remarks"></a>Comentários

Observe que o contêiner não é necessário para dar suporte a essa propriedade.

##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign

Determina o alinhamento de texto de ambiente preferido pelo contêiner de controle.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Valor de retorno

O status da propriedade TextAlign de ambiente do contêiner. Se não há suporte para essa propriedade, essa função retorna 0.

A seguir está uma lista de valores de retornados válidos:

|Valor retornado|Significado|
|------------------|-------------|
|0|Alinhamento geral (números no texto à direita, à esquerda).|
|1|Justificar à esquerda|
|2|Centralizado |
|3|Justificar à direita|

### <a name="remarks"></a>Comentários

Essa propriedade está disponível para todos os controles incorporados e é definida pelo contêiner. Observe que o contêiner não é necessário para dar suporte a essa propriedade.

##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead

Determina se o contêiner quiser o controle para responder às ações de interface do usuário.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o controle deve responder às ações de interface do usuário; Caso contrário, 0. Se não há suporte para essa propriedade, essa função retorna 0.

### <a name="remarks"></a>Comentários

Por exemplo, um contêiner pode definir isso como TRUE no modo de design.

##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode

Determina se o contêiner estiver em modo de design ou modo de usuário.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o contêiner estiver no modo de usuário; Caso contrário, 0 (no modo de design). Se não há suporte para essa propriedade, essa função retorna TRUE.

### <a name="remarks"></a>Comentários

Por exemplo, um contêiner pode definir isso como FALSE no modo de design.

##  <a name="boundpropertychanged"></a>  COleControl::BoundPropertyChanged

Indica que o valor da propriedade associada é alterado.

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Parâmetros

*dispid*<br/>
A ID de expedição de uma propriedade associada do controle.

### <a name="remarks"></a>Comentários

Isso deve ser chamado sempre que o método de definir o valor da propriedade é alterada, mesmo nos casos em que a alteração não foi feita por meio da propriedade. Lembre-se principalmente de propriedades associadas que são mapeadas para variáveis de membro. Sempre que tal um membro variável for alterado, `BoundPropertyChanged` deve ser chamado.

##  <a name="boundpropertyrequestedit"></a>  COleControl::BoundPropertyRequestEdit

Solicita permissão do `IPropertyNotifySink` interface para alterar um valor de propriedade associada fornecido pelo controle.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Parâmetros

*dispid*<br/>
A ID de expedição de uma propriedade associada do controle.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se a alteração for permitida; Caso contrário, 0. O valor padrão é diferente de zero.

### <a name="remarks"></a>Comentários

Se a permissão é negada, o controle não deve permitir que o valor da alteração da propriedade. Isso pode ser feito por ignorando ou falhando a ação que tentou alterar o valor da propriedade.

##  <a name="clienttoparent"></a>  COleControl::ClientToParent

Converte as coordenadas de *pPoint* em coordenadas do pai.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Parâmetros

*lprcBounds*<br/>
Ponteiro para os limites do controle OLE dentro do contêiner. A área de todo o controle incluindo bordas e barras de rolagem, mas não a área de cliente.

*pPoint*<br/>
Ponteiro para o ponto de área de cliente OLE ser traduzida para as coordenadas do pai (contêiner).

### <a name="remarks"></a>Comentários

Na entrada *pPoint* é relativo à origem da área de cliente do controle OLE (canto superior esquerdo da área de cliente do controle). Na saída *pPoint* é relativo à origem do pai (canto superior esquerdo do contêiner).

##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect

Ajusta a um retângulo de cursor se ele é totalmente ou parcialmente coberto por objetos sobrepostos, opacos.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Parâmetros

*lpRect*<br/>
Na entrada, um ponteiro para um [RECT](/windows/desktop/api/windef/ns-windef-tagrect) estrutura que contém a área de cursor a ser ajustado. Na área de saída, a cursor ajustada, ou nulo se o retângulo de cursor está completamente coberto.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se bem-sucedido; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Um cursor é uma linha, bloco ou bitmap que normalmente indica onde texto ou elementos gráficos serão inseridos piscando.

Um objeto sem janelas com segurança não é possível mostrar um acento circunflexo sem verificar primeiro se o cursor está parcialmente ou totalmente oculto por objetos sobrepostos. Para fazer com que possível, um objeto pode usar `ClipCaretRect` para obter o cursor ajustado (reduzido) para garantir que ela se encaixa na região de recorte.

Objetos de criação de um cursor do sistema devem enviar o retângulo de cursor para `ClipCaretRect` e usar o retângulo ajustado para o cursor. Se o cursor estiver oculta completamente, esse método retornará FALSE e o cursor não deve ser mostrado em todos os nesse caso.

##  <a name="colecontrol"></a>  COleControl::COleControl

Constrói um objeto `COleControl`.

```
COleControl();
```

### <a name="remarks"></a>Comentários

Essa função normalmente não é chamada diretamente. Em vez disso, o controle OLE é geralmente criado por sua fábrica de classe.

##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged

Chame essa função quando o conjunto de mnemônicos compatíveis com o controle foi alterado.

```
void ControlInfoChanged();
```

### <a name="remarks"></a>Comentários

Ao receber essa notificação, o contêiner do controle obtém o novo conjunto de mnemônicos, fazendo uma chamada para [IOleControl::GetControlInfo](/windows/desktop/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Observe que o contêiner não é necessário para responder a essa notificação.

##  <a name="displayerror"></a>  COleControl::DisplayError

Chamado pelo framework depois que o evento de erro estoque foi tratado (a menos que o manipulador de eventos suprimiu a exibição do erro).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Parâmetros

*scode*<br/>
O valor do código de status a ser relatado. Para obter uma lista completa de códigos de possíveis, consulte o artigo [controles ActiveX: Tópicos avançados](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
A descrição do erro que está sendo relatado.

*lpszSource*<br/>
O nome do módulo gera o erro (normalmente, o nome do módulo de controle OLE).

*lpszHelpFile*<br/>
O nome do arquivo de Ajuda que contém uma descrição do erro.

*nHelpID*<br/>
A ID do contexto de Ajuda do erro que está sendo relatado.

### <a name="remarks"></a>Comentários

O comportamento padrão exibe uma caixa de mensagem que contém a descrição do erro, contido em *lpszDescription*.

Substitua essa função para personalizar como os erros são exibidos.

##  <a name="doclick"></a>  COleControl::DoClick

Simula um mouse clique em ação no controle.

```
void DoClick();
```

### <a name="remarks"></a>Comentários

O substituível `COleControl::OnClick` será chamada uma função de membro e um clique de evento será acionado, se compatível com o controle de estoque.

Essa função dá suporte a `COleControl` classe base como um método de estoque, chamado DoClick. Para obter mais informações, consulte o artigo [controles ActiveX: Métodos](../../mfc/mfc-activex-controls-methods.md).

##  <a name="dopropexchange"></a>  COleControl::DoPropExchange

Chamado pelo framework quando carregar ou armazenar um controle de uma representação de armazenamento persistente, como um conjunto de fluxo ou propriedade.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Parâmetros

*pPX*<br/>
Um ponteiro para um `CPropExchange` objeto. A estrutura fornece esse objeto para estabelecer o contexto da troca de propriedade, incluindo sua direção.

### <a name="remarks"></a>Comentários

Normalmente, essa função faz chamadas para o **px _** família de funções para carregar ou armazenar propriedades específicas definidas pelo usuário de um controle OLE.

Se o Assistente de controle foi usado para criar o projeto de controle OLE, a versão substituída dessa função serializa as propriedades de estoque com suporte `COleControl` com uma chamada para a função de classe base, `COleControl::DoPropExchange`. Conforme você adiciona propriedades definidas pelo usuário ao seu controle OLE que você precisará modificar essa função para serializar suas novas propriedades. Para obter mais informações sobre serialização, consulte o artigo [controles ActiveX: Serializando](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="dosuperclasspaint"></a>  COleControl::DoSuperclassPaint

Redesenha a um controle OLE que tenha sido derivado de um controle do Windows.

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
Um ponteiro para o contexto de dispositivo do contêiner de controle.

*rcBounds*<br/>
A área na qual o controle deve ser desenhado.

### <a name="remarks"></a>Comentários

Chame essa função para manipular adequadamente a pintura de um controle OLE não ativo. Essa função deve ser usada somente se o OLE controlar subclasses de um controle do Windows e deve ser chamado no `OnDraw` função do seu controle.

Para obter mais informações sobre esta função e subclasses de um controle do Windows, consulte o artigo [controles ActiveX: Subclasses de um controle de Windows](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

##  <a name="drawcontent"></a>  COleControl::DrawContent

Chamado pelo framework quando a aparência do controle precisa ser atualizado.

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
Ponteiro para o contexto de dispositivo.

*rc*<br/>
Área retangular a ser desenhada em.

### <a name="remarks"></a>Comentários

Essa função chama diretamente o substituível `OnDraw` função.

##  <a name="drawmetafile"></a>  COleControl::DrawMetafile

Chamado pelo framework quando o contexto de dispositivo de metarquivo está sendo usado.

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
Ponteiro para o contexto de dispositivo de metarquivo.

*rc*<br/>
Área retangular a ser desenhada em.

##  <a name="enablesimpleframe"></a>  COleControl::EnableSimpleFrame

Habilita a característica de quadro simples para um controle OLE.

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>Comentários

Essa característica permite que um controle dar suporte a visual confinamento de outros controles, mas não é verdade confinamento de OLE. Um exemplo seria com vários controles dentro de uma caixa de grupo. Esses controles não são OLE contido, mas eles estão na mesma caixa de grupo.

##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent

Serializa ou inicializa o estado de extensão do controle (suas dimensões em unidades HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Parâmetros

*pPX*<br/>
Um ponteiro para um [CPropExchange](../../mfc/reference/cpropexchange-class.md) objeto. A estrutura fornece esse objeto para estabelecer o contexto da troca de propriedade, incluindo sua direção.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se a função for bem-sucedida; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Normalmente, essa função é chamada pela implementação do padrão de `COleControl::DoPropExchange`.

##  <a name="exchangestockprops"></a>  COleControl::ExchangeStockProps

Serializa ou inicializa o estado do controle propriedades de estoque.

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Parâmetros

*pPX*<br/>
Um ponteiro para um [CPropExchange](../../mfc/reference/cpropexchange-class.md) objeto. A estrutura fornece esse objeto para estabelecer o contexto da troca de propriedade, incluindo sua direção.

### <a name="remarks"></a>Comentários

Normalmente, essa função é chamada pela implementação do padrão de `COleControl::DoPropExchange`.

##  <a name="exchangeversion"></a>  COleControl::ExchangeVersion

Serializa ou inicializa o estado das informações de versão do controle.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parâmetros

*pPX*<br/>
Um ponteiro para um `CPropExchange` objeto. A estrutura fornece esse objeto para estabelecer o contexto da troca de propriedade, incluindo sua direção.

*dwVersionDefault*<br/>
O número de versão atual do controle.

*bConvert*<br/>
Indica se os dados persistentes devem ser convertidos para o formato mais recente quando salvo ou mantidos no mesmo formato que foi carregado.

### <a name="return-value"></a>Valor de retorno

Diferente de zero da função for bem-sucedida; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Normalmente, esta será a primeira função chamada pela substituição do controle do `COleControl::DoPropExchange`. Ao carregar, essa função lê o número de versão dos dados persistentes e define o atributo de versão dos [CPropExchange](../../mfc/reference/cpropexchange-class.md) objeto adequadamente. Ao salvar, essa função grava o número de versão dos dados persistentes.

Para obter mais informações sobre a persistência e controle de versão, consulte o artigo [controles ActiveX: Serializando](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="fireclick"></a>  COleControl::FireClick

Chamado pelo framework quando o mouse é clicado sobre um controle ativo.

```
void FireClick();
```

### <a name="remarks"></a>Comentários

Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.

Para acionamento automático de um evento de clique ocorrer, o mapa de evento do controle deve ter um estoque clique evento definido.

##  <a name="firedblclick"></a>  COleControl::FireDblClick

Chamado pelo framework quando o mouse é clicado duas vezes ao longo de um controle ativo.

```
void FireDblClick();
```

### <a name="remarks"></a>Comentários

Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.

Para acionamento automático de um evento DblClick ocorra, o mapa de evento do controle deve ter um evento DblClick estoque definido.

##  <a name="fireerror"></a>  COleControl::FireError

Aciona o evento de erro de estoque.

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parâmetros

*scode*<br/>
O valor do código de status a ser relatado. Para obter uma lista completa de códigos de possíveis, consulte o artigo [controles ActiveX: Tópicos avançados](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
A descrição do erro que está sendo relatado.

*nHelpID*<br/>
A identificação de Ajuda do erro que está sendo relatado.

### <a name="remarks"></a>Comentários

Esse evento fornece uma maneira de sinalização em locais apropriados no seu código, que ocorreu um erro dentro do seu controle. Ao contrário de outros eventos de estoque, como clique ou MouseMove, erro nunca é acionado pela estrutura.

Para relatar um erro que ocorre durante uma função de get de propriedade, função de conjunto de propriedade ou método de automação, chame [COleControl::ThrowError](#throwerror).

A implementação de evento de erro de estoque de um controle OLE usa um valor SCODE. Se o controle usa esse evento e se destina a ser usado no Visual Basic 4.0, você receberá erros porque não há suporte para o valor SCODE no Visual Basic.

Para corrigir esse problema, altere manualmente o parâmetro SCODE no controle do. Arquivos ODL para um **longo**. Além disso, qualquer evento personalizado, método ou propriedade que usa um parâmetro SCODE também faz com que o mesmo problema.

##  <a name="fireevent"></a>  COleControl::FireEvent

Dispara um evento definido pelo usuário de seu controle com qualquer número de argumentos opcionais.

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Parâmetros

*dispid*<br/>
A ID de expedição do evento a ser acionado.

*pbParams*<br/>
Um descritor para tipos de parâmetro do evento.

### <a name="remarks"></a>Comentários

Normalmente, essa função não deve ser chamada diretamente. Em vez disso, você chamará as funções de acionamento do evento na seção de mapa de evento da declaração de classe do seu controle.

O *pbParams* argumento é uma lista separada por espaço **VTS_**. Um ou mais desses valores, separados por espaços (não a vírgula), especifica a lista de parâmetros da função. Os valores possíveis são:

|Símbolo|Tipo de parâmetro|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  Constantes de variant adicionais foram definidos para todos os tipos variantes, com exceção do VTS_FONT e VTS_PICTURE, que fornecem um ponteiro para a constante de dados variant. Essas constantes são nomeadas usando o **VTS_P** `constantname` convenção. Por exemplo, VTS_PCOLOR é um ponteiro para uma constante VTS_COLOR.

##  <a name="firekeydown"></a>  COleControl::FireKeyDown

Chamado pelo framework quando uma tecla é pressionada enquanto o controle é a interface do usuário do Active Directory.

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parâmetros

*pnChar*<br/>
Ponteiro para o valor de código de tecla virtual da tecla pressionada. Para obter uma lista de códigos de tecla virtuais padrão, consulte WinUser. h

*nShiftState*<br/>
Contém uma combinação dos sinalizadores a seguir:

- Tecla SHIFT The do SHIFT_MASK foi pressionada durante a ação.

- Tecla CTRL The do CTRL_MASK foi pressionada durante a ação.

- ALT de ALT_MASK a tecla foi pressionada durante a ação.

### <a name="remarks"></a>Comentários

Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.

Para acionamento automático de um evento KeyDown ocorra, o mapa de evento do controle deve ter um evento KeyDown estoque definido.

##  <a name="firekeypress"></a>  COleControl::FireKeyPress

Chamado pelo framework quando uma tecla é pressionada e liberada enquanto o controle personalizado está ativo de interface do usuário dentro do contêiner.

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Parâmetros

*pnChar*<br/>
Um ponteiro para o valor do caractere da tecla pressionada.

### <a name="remarks"></a>Comentários

Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.

O destinatário do evento pode modificar *pnChar*, por exemplo, converter todos os caracteres minúsculos em maiusculos. Se você quiser examinar o caractere modificado, substituir `OnKeyPressEvent`.

Para acionamento automático de um evento KeyPress ocorra, o mapa de evento do controle deve ter um evento KeyPress estoque definido.

##  <a name="firekeyup"></a>  COleControl::FireKeyUp

Chamado pelo framework quando uma tecla é liberada enquanto o controle personalizado está ativo de interface do usuário dentro do contêiner.

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parâmetros

*pnChar*<br/>
Ponteiro para o valor de código de tecla virtual da chave lançado. Para obter uma lista de códigos de tecla virtuais padrão, consulte WinUser. h

*nShiftState*<br/>
Contém uma combinação dos sinalizadores a seguir:

- Tecla SHIFT The do SHIFT_MASK foi pressionada durante a ação.

- Tecla CTRL The do CTRL_MASK foi pressionada durante a ação.

- ALT de ALT_MASK a tecla foi pressionada durante a ação.

### <a name="remarks"></a>Comentários

Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.

Para acionamento automático de um evento KeyUp ocorra, o mapa de evento do controle deve ter um evento KeyUp estoque definido.

##  <a name="firemousedown"></a>  COleControl::FireMouseDown

Chamado pelo framework quando um botão do mouse é pressionado sobre um controle personalizado ativo.

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parâmetros

*nButton*<br/>
O valor numérico do botão do mouse é pressionado. Ele pode conter um dos seguintes valores:

- LEFT_BUTTON botão esquerdo do mouse foi pressionado.

- MIDDLE_BUTTON o botão do meio foi pressionado.

- RIGHT_BUTTON o botão direito do mouse foi pressionado.

*nShiftState*<br/>
Contém uma combinação dos sinalizadores a seguir:

- Tecla SHIFT The do SHIFT_MASK foi pressionada durante a ação.

- Tecla CTRL The do CTRL_MASK foi pressionada durante a ação.

- ALT de ALT_MASK a tecla foi pressionada durante a ação.

*x*<br/>
A coordenada x do cursor quando um botão do mouse foi pressionado. A coordenada é relativa ao canto superior esquerdo da janela de controle.

*y*<br/>
A coordenada y do cursor quando um botão do mouse foi pressionado. A coordenada é relativa ao canto superior esquerdo da janela de controle.

### <a name="remarks"></a>Comentários

Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.

Para acionamento automático de um evento MouseDown ocorra, o mapa de evento do controle deve ter um evento MouseDown estoque definido.

##  <a name="firemousemove"></a>  COleControl::FireMouseMove

Chamado pelo framework quando o cursor é movido sobre um controle personalizado ativo.

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parâmetros

*nButton*<br/>
O valor numérico dos botões do mouse é pressionado. Contém uma combinação dos seguintes valores:

- LEFT_BUTTON botão esquerdo do mouse foi pressionado durante a ação.

- MIDDLE_BUTTON o botão do meio foi pressionado durante a ação.

- RIGHT_BUTTON o botão direito do mouse foi pressionado durante a ação.

*nShiftState*<br/>
Contém uma combinação dos sinalizadores a seguir:

- Tecla SHIFT The do SHIFT_MASK foi pressionada durante a ação.

- Tecla CTRL The do CTRL_MASK foi pressionada durante a ação.

- ALT de ALT_MASK a tecla foi pressionada durante a ação.

*x*<br/>
A coordenada x do cursor. A coordenada é relativa ao canto superior esquerdo da janela de controle.

*y*<br/>
A coordenada y do cursor. A coordenada é relativa ao canto superior esquerdo da janela de controle.

### <a name="remarks"></a>Comentários

Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.

Para acionamento automático de um evento MouseMove ocorra, o mapa de evento do controle deve ter um evento MouseMove estoque definido.

##  <a name="firemouseup"></a>  COleControl::FireMouseUp

Chamado pelo framework quando um botão do mouse é liberado sobre um controle personalizado ativo.

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parâmetros

*nButton*<br/>
O valor numérico do botão do mouse liberado. Ele pode ter um dos seguintes valores:

- LEFT_BUTTON o botão esquerdo do mouse foi liberado.

- MIDDLE_BUTTON o botão do meio foi liberado.

- RIGHT_BUTTON o botão direito do mouse foi liberado.

*nShiftState*<br/>
Contém uma combinação dos sinalizadores a seguir:

- Tecla SHIFT The do SHIFT_MASK foi pressionada durante a ação.

- Tecla CTRL The do CTRL_MASK foi pressionada durante a ação.

- ALT de ALT_MASK a tecla foi pressionada durante a ação.

*x*<br/>
A coordenada x do cursor quando um botão do mouse foi liberado. A coordenada é relativa ao canto superior esquerdo da janela de controle.

*y*<br/>
A coordenada y de um cursor quando um botão do mouse foi liberado. A coordenada é relativa ao canto superior esquerdo da janela de controle.

### <a name="remarks"></a>Comentários

Se esse evento é definido como um evento personalizado, você deve determinar quando o evento é acionado.

Para acionamento automático de um evento MouseUp ocorra, o mapa de evento do controle deve ter um evento MouseUp estoque definido.

##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange

Dispara um evento com o valor atual do estado pronto do controle.

```
void FireReadyStateChange();
```

### <a name="remarks"></a>Comentários

O estado pronto pode ser um dos seguintes valores:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Estado de inicialização padrão|
|READYSTATE_LOADING|Controle atualmente está carregando suas propriedades|
|READYSTATE_LOADED|Controle foi inicializado|
|READYSTATE_INTERACTIVE|Controle tem dados suficientes para ser interativa, mas não assíncronos dados ainda são carregados|
|READYSTATE_COMPLETE|Controle tem todos os seus dados|

Use [GetReadyState](#getreadystate) para determinar a preparação atual do controle.

[InternalSetReadyState](#internalsetreadystate) altera o estado pronto para o valor fornecido, em seguida, chama `FireReadyStateChange`.

##  <a name="getactivationpolicy"></a>  COleControl::GetActivationPolicy

Altera o comportamento padrão de ativação de um controle que suporta o `IPointerInactive` interface.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Valor de retorno

Uma combinação de sinalizadores da enumeração POINTERINACTIVE. Sinalizadores de possíveis são:

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|O objeto deve ser ativado quando o mouse entra ele durante uma operação de movimentação do mouse no local.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|O objeto deve ser desativado quando o mouse deixa o objeto durante uma operação de movimentação do mouse.|
|POINTERINACTIVE_ACTIVATEONDRAG|O objeto deve ser ativado quando o mouse é arrastado para ele durante uma operação de arrastar no local e operação de remoção.|

### <a name="remarks"></a>Comentários

Quando o `IPointerInactive` interface está habilitada, o contêiner delegará WM_SETCURSOR e WM_MOUSEMOVE mensagens para ela. `COleControl`da implementação dessa interface enviará essas mensagens por meio do mapa de mensagens do seu controle, depois de ajustar o mouse coordena adequadamente.

Sempre que o contêiner recebe uma mensagem WM_SETCURSOR ou WM_MOUSEMOVE com o ponteiro do mouse sobre um objeto inativo que dão suporte a `IPointerInactive`, ele deverá chamar `GetActivationPolicy` na interface e retornados sinalizadores da enumeração POINTERINACTIVE.

Você pode processar essas mensagens, assim como mensagens de janela normal, adicionando as entradas correspondentes no mapa de mensagem. Em seus manipuladores, evite usar o `m_hWnd` variável de membro (ou todas as funções membro que usa a ele) sem primeiro verificando se seu valor é não nulo.

Qualquer objeto que se destina a mais do que definir o cursor do mouse e/ou acionar um evento de movimentação do mouse, como fornecer comentários visuais especial, deve retornar o sinalizador POINTERINACTIVE_ACTIVATEONENTRY e desenhar os comentários ao Active Directory. Se o objeto retornar esse sinalizador, o contêiner deve ativá-lo em vigor imediatamente e, em seguida, encaminhá-lo a mesma mensagem que disparou a chamada para `GetActivationPolicy`.

Se os POINTERINACTIVE_ACTIVATEONENTRY POINTERINACTIVE_DEACTIVATEONLEAVE sinalizadores e forem retornados, o objeto somente será ativado quando o mouse está sobre o objeto. Se apenas o sinalizador POINTERINACTIVE_ACTIVATEONENTRY for retornado, o objeto somente será ativado depois que quando o mouse entra pela primeira vez o objeto.

Talvez você queira um controle inativo para ser o destino de uma operação de arrastar OLE e operação de remoção. Isso requer ativando o controle no momento em que o usuário arrasta um objeto sobre ele, para que a janela do controle pode ser registrada como um destino de soltar. Para fazer com que a ativação ocorrer durante uma operação de arrastar, retornam o sinalizador POINTERINACTIVE_ACTIVATEONDRAG:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

As informações são comunicadas por `GetActivationPolicy` deve não ser armazenado em cache por um contêiner. Em vez disso, esse método deve ser chamado sempre que o mouse entra em um objeto inativo.

Se um objeto inativo não solicitar para ser ativado quando o mouse entra-lo no local, seu contêiner deve expedir mensagens WM_SETCURSOR subsequentes para este objeto chamando [OnInactiveSetCursor](#oninactivesetcursor) , enquanto o ponteiro do mouse permanece sobre o objeto.

Habilitando o `IPointerInactive` interface normalmente significa que você deseja que o controle para ser capaz de processar mensagens do mouse em todos os momentos. Para obter esse comportamento em um contêiner que não oferece suporte a `IPointerInactive` interface, você precisará ter o controle sempre ativado quando visível, que significa que o controle deve ter o sinalizador OLEMISC_ACTIVATEWHENVISIBLE entre seus diversos sinalizadores. No entanto, para impedir que esse sinalizador de entrarem em vigor em um contêiner que dá suporte `IPointerInactive`, você também pode especificar o sinalizador OLEMISC_IGNOREACTIVATEWHENVISIBLE:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>  COleControl::GetAmbientProperty

Obtém o valor de uma propriedade de ambiente do contêiner.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Parâmetros

*dwDispid*<br/>
A ID de expedição da propriedade de ambiente desejada.

*vtProp*<br/>
Uma marca de tipo variante que especifica o tipo do valor a ser retornado em *pvProp*.

*pvProp*<br/>
Um ponteiro para o endereço da variável que receberá o valor da propriedade ou valor de retorno. O tipo deste ponteiro real deve corresponder ao tipo especificado pelo *vtProp*.

|vtProp|Tipo de pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Valor de retorno

Diferente de zero se houver suporte para a propriedade de ambiente; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Se você usar `GetAmbientProperty` para recuperar as propriedades DisplayName e ScaleUnits ambiente, defina *vtProp* para VT_BSTR e *pvProp* para `CString*`. Se você estiver recuperando a propriedade da fonte do ambiente, defina *vtProp* para VT_FONT e *pvProp* para LPFONTDISP *.

Observe que funções já foram fornecidas para propriedades de ambiente comuns, tais como [AmbientBackColor](#ambientbackcolor) e [AmbientFont](#ambientfont).

##  <a name="getappearance"></a>  COleControl::GetAppearance

Implementa a função Get da propriedade de aparência do seu controle estoque.

```
short GetAppearance ();
```

### <a name="return-value"></a>Valor de retorno

O valor de retorno Especifica a configuração de aparência atual como uma **curto** valor (VT_I2), se for bem-sucedido. Esse valor é zero, se a aparência do controle é simples e 1, se a aparência do controle é 3D.

##  <a name="getbackcolor"></a>  COleControl::GetBackColor

Implementa a função Get da propriedade BackColor de estoque do seu controle.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Valor de retorno

O valor de retorno Especifica a cor de plano de fundo atual como um valor OLE_COLOR, se for bem-sucedido. Esse valor pode ser traduzido para um valor COLORREF com uma chamada para `TranslateColor`.

##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle

Implementa a função Get da propriedade BorderStyle de estoque do seu controle.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Valor de retorno

1 se o controle tem uma borda normal; 0 se o controle não tem nenhuma borda.

##  <a name="getcapture"></a>  COleControl::GetCapture

Determina se o `COleControl` objeto tem a captura do mouse.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Valor de retorno

Se o controle é ativado e sem janelas, retornará **isso** se o controle atualmente tiver o mouse capturar (conforme determinado pelo contêiner do controle), ou nulo se não tiver a captura.

Caso contrário, retorna o `CWnd` objeto que tem a captura do mouse (mesmo que `CWnd::GetCapture`).

### <a name="remarks"></a>Comentários

Um controle sem janelas ativado recebe o mouse capturar quando [SetCapture](#setcapture) é chamado.

##  <a name="getclassid"></a>  COleControl::GetClassID

Chamado pelo framework para recuperar a ID de classe OLE do controle.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Parâmetros

*pclsid*<br/>
Ponteiro para o local da ID da classe.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se a chamada não foi bem-sucedida; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Geralmente é implementado pelos [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

##  <a name="getclientoffset"></a>  COleControl::GetClientOffset

Recupera a diferença entre o canto superior esquerdo da área retangular do controle e o canto superior esquerdo da sua área de cliente.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Parâmetros

*pdxOffset*<br/>
Ponteiro para o deslocamento horizontal da área de cliente do controle OLE.

*pdyOffset*<br/>
Ponteiro para o deslocamento vertical da área de cliente do controle OLE.

### <a name="remarks"></a>Comentários

O controle OLE tem uma área retangular dentro do seu contêiner. A área de cliente do controle é a área de controle, excluindo as bordas e barras de rolagem. O deslocamento é recuperada por `GetClientOffset` é a diferença entre o canto superior esquerdo da sua área de cliente e o canto superior esquerdo da área retangular do controle. Se o controle tiver elementos não clientes que não seja o padrão bordas e barras de rolagem, substituem essa função de membro para especificar o deslocamento.

##  <a name="getclientrect"></a>  COleControl::GetClientRect

Recupera o tamanho da área de cliente do controle.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Parâmetros

*lpRect*<br/>
Ponteiro para um `RECT` estrutura que contém as dimensões da área de cliente do controle sem janelas; ou seja, o tamanho do controle menos quadros, bordas das janelas, barras de rolagem e assim por diante. O *lpRect* parâmetro indica o tamanho do retângulo do cliente do controle, não sua posição.

##  <a name="getclientsite"></a>  COleControl::GetClientSite

Consultas de um objeto para o ponteiro para seu site atual do cliente dentro de seu contêiner.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para o site de cliente atual do controle em seu contêiner.

### <a name="remarks"></a>Comentários

O ponteiro retornado aponta para uma instância de `IOleClientSite`. O `IOleClientSite` interface implementada por contêineres, é o modo de exibição do objeto de seu contexto: onde ela está ancorada no documento, onde ele obtém seu armazenamento, a interface do usuário e outros recursos.

##  <a name="getcontrolflags"></a>  COleControl::GetControlFlags

Recupera as configurações de sinalizador de controle.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Valor de retorno

Uma combinação ORed dos sinalizadores na enumeração ControlFlags:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Comentários

Por padrão, `GetControlFlags` retorna `fastBeginPaint | clipPaintDC`.

|||
|-|-|
|`fastBeginPaint`|Se definido, função usa uma lata de begin adaptado para controles OLE em vez do [BeginPaint](/windows/desktop/api/winuser/nf-winuser-beginpaint) API (definido por padrão).|
|`clipPaintDC`|Se não for definido, desabilita a chamada para `IntersectClipRect` feitas pelo `COleControl` e ganha uma vantagem da velocidade de pequenos. Se você estiver usando a ativação sem janelas, o sinalizador não tem efeito.|
|`pointerInactive`|Se definido, fornece a interação do mouse enquanto o controle estiver inativo, permitindo `COleControl`da implementação do `IPointerInactive` interface, que é desabilitado por padrão.|
|`noFlickerActivate`|Se definido, elimina a cintilação de visual que acompanha este artigo e de operações de desenho extra. Use quando seu controle se desenha identicamente nos estados ativos e inativos. Se você estiver usando a ativação sem janelas, o sinalizador não tem efeito.|
|`windowlessActivate`|Se configurado, indica que o controle usará a ativação sem janelas.|
|`canOptimizeDraw`|Se configurado, indica que o controle irá executar o desenho otimizado, se o contêiner dá suporte a ele.|

Para obter mais informações sobre `GetControlFlags` e outras otimizações de controles OLE, consulte [controles ActiveX: Otimização](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="getcontrolsize"></a>  COleControl::GetControlSize

Recupera o tamanho da janela de controle OLE.

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Parâmetros

*pcx*<br/>
Especifica a largura do controle em pixels.

*pcy*<br/>
Especifica a altura do controle em pixels.

### <a name="remarks"></a>Comentários

Observe que todas as coordenadas para o windows de controle são relativas ao canto superior esquerdo do controle.

##  <a name="getdc"></a>  COleControl::GetDC

Fornece para um objeto sem janelas para o contexto de dispositivo get uma tela (ou compatível) de seu contêiner.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Parâmetros

*lprcRect*<br/>
Um ponteiro para o retângulo do controle sem janelas deseja redesenhar, nas coordenadas do cliente do controle. NULL significa que a extensão do objeto completo.

*dwFlags*<br/>
Atributos de desenho do contexto do dispositivo. As opções são:

- OLEDC_NODRAW indica que o objeto não usa o contexto de dispositivo para executar qualquer desenho, mas simplesmente para obter informações sobre o dispositivo de vídeo. O contêiner deve simplesmente passar de controlador de domínio da janela sem processamento adicional.

- Solicitações de OLEDC_PAINTBKGND que o contêiner de pintar a tela de fundo antes de retornar o controlador de domínio. Um objeto deve usar esse sinalizador se ele está solicitando um controlador de domínio para redesenhar a uma área com um plano de fundo transparente.

- OLEDC_OFFSCREEN informa o contêiner que o objeto deseja renderizar em um bitmap fora da tela que, em seguida, deve ser copiado para a tela. Um objeto deve usar esse sinalizador quando ele está prestes a realizar a operação de desenho gera muita cintilação. O contêiner está livre para honram esta solicitação ou não. No entanto, se esse sinalizador não for definido, o contêiner deverá devolver na tela DC. Isso permite que os objetos executar operações diretamente na tela como mostrar uma seleção (por meio de um **XOR** operação).

### <a name="return-value"></a>Valor de retorno

Ponteiro para o contexto de dispositivo de exibição para o contêiner `CWnd` área de cliente se bem-sucedido; caso contrário, o valor de retorno será NULL. O contexto de dispositivo de exibição pode ser usado em funções GDI subsequentes para desenhar na área de cliente da janela do contêiner.

### <a name="remarks"></a>Comentários

O [ReleaseDC](#releasedc) função de membro deve ser chamada para liberar o contexto depois de pintura. Ao chamar `GetDC`, objetos de passam o retângulo que desejam desenhar nas suas próprias coordenadas de cliente. `GetDC` converte em coordenadas da área de cliente de contêiner. O objeto não deve solicitar um retângulo de desenho desejado maior do que seu próprio retângulo da área de cliente, do tamanho que pode ser recuperado com [GetClientRect](#getclientrect). Isso impede que objetos de desenho inadvertidamente onde eles não se destinam a.

##  <a name="getenabled"></a>  COleControl::GetEnabled

Implementa a função Get da propriedade Enabled de estoque do seu controle.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o controle estiver habilitado; Caso contrário, 0.

##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl

Obtém um ponteiro para um objeto mantido pelo contêiner que representa o controle com um extenso conjunto de propriedades.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para o contêiner estendidos do objeto de controle. Se não houver nenhum objeto disponível, o valor é NULL.

Esse objeto pode ser manipulado por meio de seu `IDispatch` interface. Você também pode usar `QueryInterface` para obter outras interfaces disponíveis fornecidos pelo objeto. No entanto, o objeto não é necessário para dar suporte a um conjunto específico de interfaces. Observe que contar com os recursos específicos do objeto de controle estendido do contêiner limita a portabilidade do seu controle para outros contêineres arbitrários.

### <a name="remarks"></a>Comentários

A função que chama essa função é responsável por liberar o ponteiro quando terminar com o objeto. Observe que o contêiner não é necessário para dar suporte a esse objeto.

##  <a name="getfocus"></a>  COleControl::GetFocus

Determina se o `COleControl` objeto tem o foco.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Valor de retorno

Se o controle é ativado e sem janelas, retornará **isso** se o controle atualmente tiver o teclado se concentrar (conforme determinado pelo contêiner do controle), ou nulo se não tiver o foco.

Caso contrário, retorna o `CWnd` objeto que tem o foco (mesmo que `CWnd::GetFocus`).

### <a name="remarks"></a>Comentários

Um controle sem janelas ativado recebe o foco quando [SetFocus](#setfocus) é chamado.

##  <a name="getfont"></a>  COleControl::GetFont

Implementa a função Get da propriedade de fonte de estoque.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para a interface de expedição de fonte de estoque do controle propriedade Font.

### <a name="remarks"></a>Comentários

Observe que o chamador deve liberar o objeto quando terminado. Dentro da implementação do controle, use `InternalGetFont` para acessar o objeto de fonte das ações do controle. Para obter mais informações sobre como usar fontes em seu controle, consulte o artigo [controles ActiveX: Usando fontes em um controle ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).

##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics

Mede as métricas de texto para qualquer `CFontHolder` objeto possuído pelo controle.

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parâmetros

*lptm*<br/>
Ponteiro para um [TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica) estrutura.

*fontHolder*<br/>
Referência a um [CFontHolder](../../mfc/reference/cfontholder-class.md) objeto.

### <a name="remarks"></a>Comentários

A fonte pode ser selecionada com o [COleControl::SelectFontObject](#selectfontobject) função. `GetFontTextMetrics` irá inicializar os `TEXTMETRIC` estrutura apontada por *lptm* com informações de métricas válidas sobre `fontHolder`da fonte se for bem-sucedido ou a estrutura de preenchimento com zeros se não for bem-sucedido. Você deve usar essa função em vez de [GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics) quando seu controle de pintura, como controles, como qualquer inserido o objeto OLE, podem ser necessário para se renderizar sozinhos em um metarquivo.

O `TEXTMETRIC` estrutura para a fonte padrão é atualizada quando o [SelectFontObject](#selectfontobject) função é chamada. Você deve chamar `GetFontTextMetrics` somente depois de selecionar a propriedade de fonte de estoque para garantir que as informações fornecidas é válido.

##  <a name="getforecolor"></a>  COleControl::GetForeColor

Implementa a função Get da propriedade ForeColor estoque.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Valor de retorno

O valor de retorno Especifica a cor de primeiro plano atual como um valor OLE_COLOR, se for bem-sucedido. Esse valor pode ser convertido para um [COLORREF](/windows/desktop/gdi/colorref) valor com uma chamada para `TranslateColor`.

##  <a name="gethwnd"></a>  COleControl::GetHwnd

Implementa a função Get da propriedade de estoque hWnd.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Valor de retorno

Identificador de janela do controle OLE, se houver; Caso contrário, nulo.

##  <a name="getmessagestring"></a>  COleControl::GetMessageString

Chamado pelo framework para obter uma cadeia de caracteres curta que descreve a finalidade do item de menu identificado por *nID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Parâmetros

*nID*<br/>
Uma ID de item de menu.

*rMessage*<br/>
Uma referência a um [CString](../../atl-mfc-shared/reference/cstringt-class.md) objeto por meio do qual uma cadeia de caracteres será retornada.

### <a name="remarks"></a>Comentários

Isso pode ser usado para obter uma mensagem para exibição em uma barra de status, enquanto o item de menu é realçado. A implementação padrão tenta carregar um recurso de cadeia de caracteres identificado pelo *nID*.

##  <a name="getnotsupported"></a>  COleControl::GetNotSupported

Impede o acesso ao valor da propriedade do controle pelo usuário.

```
void GetNotSupported();
```

### <a name="remarks"></a>Comentários

Chame essa função em vez da função Get de qualquer propriedade em que não há suporte para recuperação da propriedade pelo usuário do controle. Um exemplo seria uma propriedade que é somente gravação.

##  <a name="getreadystate"></a>  COleControl::GetReadyState

Retorna o estado de preparação do controle.

```
long GetReadyState();
```

### <a name="return-value"></a>Valor de retorno

O estado de preparação do controle, um dos seguintes valores:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Estado de inicialização padrão|
|READYSTATE_LOADING|Controle atualmente está carregando suas propriedades|
|READYSTATE_LOADED|Controle foi inicializado|
|READYSTATE_INTERACTIVE|Controle tem dados suficientes para ser interativa, mas não assíncronos dados ainda são carregados|
|READYSTATE_COMPLETE|Controle tem todos os seus dados|

### <a name="remarks"></a>Comentários

A maioria dos controles simples nunca precisa diferenciar LOADED e interativo. No entanto, os controles que dão suporte a propriedades de caminho de dados podem não estar prontos para ser interativa até que pelo menos alguns dados são recebidos assincronicamente. Um controle deve tentar se tornar interativas assim que possível.

##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer

Obtém as coordenadas do retângulo do controle relativo ao contêiner, expressado em unidades de dispositivo.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Parâmetros

*lpRect*<br/>
Um ponteiro para a estrutura do retângulo no qual as coordenadas do controle serão copiadas.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o controle está ativo no local; Caso contrário, 0.

### <a name="remarks"></a>Comentários

O retângulo só será válido se o controle está ativo no local.

##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics

Mede as métricas de texto para a propriedade do controle stock Font, que pode ser selecionada com o [SelectStockFont](#selectstockfont) função.

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Parâmetros

*lptm*<br/>
Um ponteiro para um [TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica) estrutura.

### <a name="remarks"></a>Comentários

O `GetStockTextMetrics` função inicializará o `TEXTMETRIC` estrutura apontada por *lptm* com informações de métricas válidas se for bem-sucedido ou preenchimento a estrutura com zeros se não for bem-sucedido. Use essa função em vez de [GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics) quando seu controle de pintura, como controles, como qualquer inserido o objeto OLE, podem ser necessário para se renderizar sozinhos em um metarquivo.

O `TEXTMETRIC` estrutura para a fonte padrão é atualizada quando o `SelectStockFont` função é chamada. Você deve chamar essa função somente depois de selecionar a fonte de estoque para garantir que as informações fornecidas é válido.

##  <a name="gettext"></a>  COleControl::GetText

Implementa a função Get da propriedade de texto ou uma legenda estoque.

```
BSTR GetText();
```

### <a name="return-value"></a>Valor de retorno

O valor atual da cadeia de caracteres de texto da controle ou uma cadeia de caracteres de comprimento zero se nenhuma cadeia de caracteres estiver presente.

> [!NOTE]
>  Para obter mais informações sobre o tipo de dados BSTR, consulte [tipos de dados](../../mfc/reference/data-types-mfc.md) na seção de Macros e globais.

### <a name="remarks"></a>Comentários

Observe que o chamador dessa função deve chamar `SysFreeString` na cadeia de caracteres retornado para gratuitamente o recurso. Dentro da implementação do controle, use `InternalGetText` para acessar a propriedade do controle estoque texto ou uma legenda.

##  <a name="getwindowlessdroptarget"></a>  COleControl::GetWindowlessDropTarget

Substituir `GetWindowlessDropTarget` quando desejar um controle sem janelas para ser o destino de um OLE arraste e solte a operação.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Valor de retorno

Ponteiro para o objeto `IDropTarget` interface. Uma vez que ele não tem uma janela, um objeto sem janelas não é possível registrar um `IDropTarget` interface. No entanto, para participar de arrastar e soltar, um objeto sem janelas ainda poderão implementar a interface e retorná-lo no `GetWindowlessDropTarget`.

### <a name="remarks"></a>Comentários

Normalmente, isso exigiria que a janela do controle ser registrado como um destino de soltar. Mas uma vez que o controle não tem nenhuma janela de seu próprio, o contêiner usará sua própria janela como um destino de soltar. O controle simplesmente precisa fornecer uma implementação de `IDropTarget` interface à qual o contêiner pode delegar chamadas no momento apropriado. Por exemplo:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>  COleControl::InitializeIIDs

Informa as IIDs o controle usará a classe base.

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Parâmetros

*piidPrimary*<br/>
Ponteiro para a ID de interface da interface de expedição primária do controle.

*piidEvents*<br/>
Ponteiro para a ID de interface da interface de eventos do controle.

### <a name="remarks"></a>Comentários

Chame essa função no construtor do controle para informar a classe base da interface IDs usando o seu controle.

##  <a name="internalgetfont"></a>  COleControl::InternalGetFont

Acessa a propriedade de fonte de estoque de seu controle

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Valor de retorno

Uma referência a um [CFontHolder](../../mfc/reference/cfontholder-class.md) objeto que contém o objeto de fonte de estoque.

##  <a name="internalgettext"></a>  COleControl::InternalGetText

Acessa a propriedade de texto ou uma legenda de estoque do seu controle.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Valor de retorno

Uma referência para a cadeia de caracteres de texto do controle.

##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState

Define o estado de preparação do controle.

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Parâmetros

*lNewReadyState*<br/>
O estado de preparação a ser definido para o controle, um dos seguintes valores:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Estado de inicialização padrão|
|READYSTATE_LOADING|Controle atualmente está carregando suas propriedades|
|READYSTATE_LOADED|Controle foi inicializado|
|READYSTATE_INTERACTIVE|Controle tem dados suficientes para ser interativa, mas não assíncronos dados ainda são carregados|
|READYSTATE_COMPLETE|Controle tem todos os seus dados|

### <a name="remarks"></a>Comentários

A maioria dos controles simples nunca precisa diferenciar LOADED e interativo. No entanto, os controles que dão suporte a propriedades de caminho de dados podem não estar prontos para ser interativa até que pelo menos alguns dados são recebidos assincronicamente. Um controle deve tentar se tornar interativas assim que possível.

##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl

Força o controle para redesenhar a mesmo.

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parâmetros

*lpRect*<br/>
Um ponteiro para a região do controle a ser invalidado.

*bErase*<br/>
Especifica se o plano de fundo dentro da região de atualização a ser apagado quando a região de atualização é processada.

### <a name="remarks"></a>Comentários

Se *lpRect* tem um valor nulo, todo o controle será redesenhado. Se *lpRect* não for nulo, isso indica que a parte do retângulo do controle a ser invalidada. Em casos em que o controle não tem nenhuma janela ou não está ativo no momento, o retângulo é ignorado, e é feita uma chamada para o site do cliente [IAdviseSink::OnViewChange](/windows/desktop/api/objidl/nf-objidl-iadvisesink-onviewchange) função de membro. Use essa função em vez de `CWnd::InvalidateRect` ou `InvalidateRect`.

##  <a name="invalidatergn"></a>  COleControl::InvalidateRgn

Invalida a área de cliente da janela do contêiner em determinada região.

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parâmetros

*pRgn*<br/>
Um ponteiro para um [CRgn](../../mfc/reference/crgn-class.md) objeto que identifica a região de exibição do objeto OLE a ser invalidada, nas coordenadas do cliente da janela. Se esse parâmetro for NULL, a extensão é o objeto inteiro.

*bErase*<br/>
Especifica se o plano de fundo dentro da região invalidado a ser apagado. Se for TRUE, o plano de fundo é apagado. Se for FALSE, o plano de fundo permanece inalterado.

### <a name="remarks"></a>Comentários

Isso pode ser usado para redesenhar os controles sem janelas dentro do contêiner. A região invalidada, juntamente com todas as outras áreas na região de atualização, está marcada para pintura quando a próxima [WM_PAINT](/windows/desktop/gdi/wm-paint) mensagem é enviada.

Se *bErase* é verdadeiro para qualquer parte da região de atualização, o plano de fundo em toda a região, não apenas em determinada parte, é apagado.

##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX

Permite o carregamento especializado de um controle OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o controle está sendo convertido; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Quando a conversão de um formulário que usa VBX controles para um que usa controles OLE, o código de carregamento de especial para os controles OLE pode ser necessário. Por exemplo, se você estiver carregando uma instância do seu controle OLE, você pode ter uma chamada para [PX_Font](persistence-of-ole-controls.md#px_font) em seu `DoPropExchange`:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

No entanto, os controles VBX não tem um objeto de fonte; cada propriedade de fonte foi salvo individualmente. Nesse caso, você usaria `IsConvertingVBX` para distinguir entre esses dois casos:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Outro caso seria se o controle VBX salvas proprietários dados binários (em seu manipulador de mensagem VBM_SAVEPROPERTY) e seu controle OLE salva os dados binários em um formato diferente. Se você quiser que o controle OLE para ser compatível com o controle VBX, você pode ler dois formatos novos e antigos usando o `IsConvertingVBX` função pela distinguir se o controle VBX ou o controle OLE estava sendo carregado.

Em seu controle `DoPropExchange` função, você pode verificar essa condição e se for true, executar o código de carga específicas para essa conversão (como nos exemplos anteriores). Se o controle não está sendo convertido, você pode executar o código de carga normal. Esse recurso só é aplicável aos controles que está sendo convertidos de contrapartes VBX.

##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed

Permite a invocação de método de automação.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o controle foi inicializado; Caso contrário, 0.

### <a name="remarks"></a>Comentários

A implementação da estrutura de `IDispatch::Invoke` chamadas `IsInvokeAllowed` para determinar se uma determinada função (identificado por `dispid`) pode ser invocado. O comportamento padrão para um controle OLE é permitir que os métodos de automação a ser invocado apenas se o controle foi inicializado; No entanto, `IsInvokeAllowed` é uma função virtual e pode ser substituída se for necessário (por exemplo, quando o controle está sendo usado como um servidor de automação).

##  <a name="ismodified"></a>  COleControl::IsModified

Determina se o estado do controle foi modificado.

```
BOOL IsModified();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o estado do controle tiver sido modificado desde que foi salvo pela última vez; Caso contrário, 0.

### <a name="remarks"></a>Comentários

O estado de um controle é modificado quando uma propriedade de valor é alterado.

##  <a name="isoptimizeddraw"></a>  COleControl::IsOptimizedDraw

Determina se o contêiner dá suporte ao desenho otimizado para a operação atual de desenho.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Valor de retorno

TRUE se o contêiner que dá suporte a desenho otimizado para a operação atual de desenho; Caso contrário, FALSE.

### <a name="remarks"></a>Comentários

Se há suporte para desenho otimizado, o controle precisa não selecionar objetos antigos (canetas, pincéis, fontes, etc.) no contexto de dispositivo ao desenho é concluído.

##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl

Chamado pelo framework para determinar se o controle subdivide um Windows controlar.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o controle é uma subclasse; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Você deve substituir essa função e retornam TRUE se o OLE controlar subclasses de um controle do Windows.

##  <a name="load"></a>  COleControl::Load

Redefine todos os dados anteriores carregados de forma assíncrona e inicia um novo carregamento da propriedade do controle assíncrono.

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Parâmetros

*strNewPath*<br/>
Um ponteiro para uma cadeia de caracteres que contém o caminho que referencia o local absoluto da propriedade de controle assíncrono.

*prop*<br/>
Um [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) objeto que implementa uma propriedade de controle assíncrono.

##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive

Impede que o contêiner desativando seu controle.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Parâmetros

*bLock*<br/>
TRUE se o estado de Active Directory no local do controle precisar ser bloqueada; FALSE se ele deve ser desbloqueado.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o bloqueio tiver sido bem-sucedida; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Observe que cada bloqueio do controle deve ser emparelhado com um desbloqueio do controle quando terminar. Você só deve bloquear seu controle por curtos períodos, como ao acionar um evento.

##  <a name="onambientpropertychange"></a>  COleControl::OnAmbientPropertyChange

Chamado pelo framework quando uma propriedade de ambiente do contêiner tiver alterado o valor.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Parâmetros

*dispID*<br/>
A ID de expedição da propriedade de ambiente que foi alterada ou DISPID_UNKNOWN se várias propriedades foram alteradas.

##  <a name="onappearancechanged"></a>  COleControl::OnAppearanceChanged

Chamado pelo framework quando o valor da propriedade Appearance estoque foi alterado.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Comentários

Substitua essa função se você quiser que a notificação após a alteração de propriedade. A implementação padrão chama `InvalidateControl`.

##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged

Chamado pelo framework quando o valor da propriedade BackColor estoque é alterado.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Comentários

Substitua essa função se você quiser que a notificação após a alteração de propriedade. A implementação padrão chama `InvalidateControl`.

##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged

Chamado pelo framework quando o valor da propriedade BorderStyle estoque é alterado.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Comentários

A implementação padrão chama `InvalidateControl`.

Substitua essa função se você quiser que a notificação após a alteração de propriedade.

##  <a name="onclick"></a>  COleControl::OnClick

Chamado pelo framework quando um botão do mouse foi clicado ou o método stock de DoClick foi invocado.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Parâmetros

*iButton*<br/>
Índice de um botão do mouse. Pode ter um dos seguintes valores:

- LEFT_BUTTON o botão esquerdo do mouse foi clicado.

- MIDDLE_BUTTON o botão do meio foi clicado.

- RIGHT_BUTTON o botão direito do mouse foi clicado.

### <a name="remarks"></a>Comentários

A implementação padrão chama `COleControl::FireClick`.

Substitua essa função de membro para modificar ou estender o tratamento padrão.

##  <a name="onclose"></a>  COleControl::OnClose

Chamado pelo framework quando o contêiner é chamado do controle `IOleControl::Close` função.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Parâmetros

*dwSaveOption*<br/>
Sinalizador que indica se o objeto deve ser salvo antes de carregar. Os valores válidos são:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Comentários

Por padrão, `OnClose` salva o objeto de controle se ele tiver sido modificado e *dwSaveOption* é OLECLOSE_SAVEIFDIRTY ou OLECLOSE_PROMPTSAVE.

##  <a name="ondoverb"></a>  COleControl::OnDoVerb

Chamado pelo framework quando contêiner chama o `IOleObject::DoVerb` função de membro.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parâmetros

*iVerb*<br/>
O índice do verbo de controle a ser invocado.

*lpMsg*<br/>
Um ponteiro para a mensagem do Windows que causou o verbo a ser invocado.

*hWndParent*<br/>
O identificador da janela pai do controle. Se a execução do verbo cria uma janela (ou windows) *hWndParent* deve ser usado como o pai.

*lpRect*<br/>
Um ponteiro para uma estrutura RECT em que as coordenadas do controle, relativo ao contêiner, serão copiadas.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se a chamada foi bem-sucedida; Caso contrário, 0.

### <a name="remarks"></a>Comentários

A implementação padrão usa as entradas de mapa de mensagem ON_OLEVERB e ON_STDOLEVERB para determinar a função adequada para invocar.

Substitua essa função para alterar o tratamento padrão de verbo.

##  <a name="ondraw"></a>  COleControl::OnDraw

Chamado pelo framework para desenhar o controle OLE no retângulo delimitador especificado usando o contexto de dispositivo especificado.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
O contexto de dispositivo no qual o desenho ocorre.

*rcBounds*<br/>
A área retangular do controle, incluindo a borda.

*rcInvalid*<br/>
A área retangular do controle que é inválido.

### <a name="remarks"></a>Comentários

`OnDraw` Normalmente, é chamada para exibição na tela, passando um contexto de dispositivo de tela como *pDC*. O *rcBounds* parâmetro identifica o retângulo no contexto de dispositivo de destino (relativo ao seu modo de mapeamento atual). O *rcInvalid* parâmetro é o retângulo real que é inválido. Em alguns casos, isso será uma área menor que *rcBounds*.

##  <a name="ondrawmetafile"></a>  COleControl::OnDrawMetafile

Chamado pelo framework para desenhar o controle OLE no retângulo delimitador especificado usando o contexto de dispositivo de metarquivo especificado.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
O contexto de dispositivo no qual o desenho ocorre.

*rcBounds*<br/>
A área retangular do controle, incluindo a borda.

### <a name="remarks"></a>Comentários

A implementação padrão chama o [OnDraw](#ondraw) função.

##  <a name="onedit"></a>  COleControl::OnEdit

Faz com que o controle a ser ativada de interface do usuário.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parâmetros

*lpMsg*<br/>
Um ponteiro para a mensagem do Windows que invocou o verbo.

*hWndParent*<br/>
Um identificador para a janela pai do controle.

*lpRect*<br/>
Um ponteiro para o retângulo usado pelo controle no contêiner.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se a chamada for bem-sucedida; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Isso tem o mesmo efeito de invocar o verbo OLEIVERB_UIACTIVATE do controle.

Esta função geralmente é usada como a função do manipulador para uma entrada de mapa de mensagem ON_OLEVERB. Isso disponibiliza um verbo de "Editar" no menu de "Objeto" do controle. Por exemplo:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>  COleControl::OnEnabledChanged

Chamado pelo framework quando o valor da propriedade Enabled de estoque é alterado.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Comentários

Substitua essa função se você quiser que a notificação após a alteração de propriedade. A implementação padrão chama [InvalidateControl](#invalidatecontrol).

##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs

Chamado pelo framework quando contêiner chama o `IOleObject::EnumVerbs` função de membro.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Parâmetros

*ppenumOleVerb*<br/>
Um ponteiro para o `IEnumOLEVERB` objeto que enumera os verbos do controle.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se verbos estão disponíveis; Caso contrário, 0.

### <a name="remarks"></a>Comentários

A implementação padrão enumera as entradas ON_OLEVERB no mapa de mensagens.

Substitua essa função para alterar a maneira padrão de verbos de enumeração.

##  <a name="oneventadvise"></a>  COleControl::OnEventAdvise

Chamado pelo framework quando um manipulador de eventos está conectado ou desconectado de um controle OLE.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Parâmetros

*bAdvise*<br/>
TRUE indica que um manipulador de eventos foi conectado ao controle. FALSE indica que um manipulador de eventos foi desconectado do controle.

##  <a name="onfontchanged"></a>  COleControl::OnFontChanged

Chamado pelo framework quando o valor da propriedade stock Font é alterado.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Comentários

A implementação padrão chama `COleControl::InvalidateControl`. Se o controle é subclasses de um controle do Windows, a implementação padrão também envia uma mensagem WM_SETFONT para a janela do controle.

Substitua essa função se você quiser que a notificação após a alteração de propriedade.

### <a name="example"></a>Exemplo

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged

Chamado pelo framework quando o valor da propriedade ForeColor estoque é alterado.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Comentários

A implementação padrão chama `InvalidateControl`.

Substitua essa função se você quiser que a notificação após a alteração de propriedade.

##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents

Chamado pelo framework depois das chamadas de contêiner `IOleControl::FreezeEvents`.

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Parâmetros

*bFreeze*<br/>
TRUE se o controle a manipulação de eventos está congelada; Caso contrário, FALSE.

### <a name="remarks"></a>Comentários

A implementação padrão não faz nada.

Se você quiser o comportamento adicional quando a manipulação de eventos é congelada ou descongelada, substituem essa função.

##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet

Chamado pelo framework quando contêiner chama o `IViewObject::GetColorSet` função de membro.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Parâmetros

*ptd*<br/>
Aponta para o dispositivo de destino para o qual a imagem deve ser renderizada. Se esse valor for NULL, a imagem deve ser renderizada para um dispositivo de destino padrão, geralmente um dispositivo de vídeo.

*hicTargetDev*<br/>
Especifica o contexto de informações no dispositivo de destino indicado por *ptd*. Esse parâmetro pode ser um contexto de dispositivo, mas não é um necessariamente. Se *ptd* for NULL, *hicTargetDev* também deve ser NULL.

*ppColorSet*<br/>
Um ponteiro para o local no qual o conjunto de cores que seria usado deve ser copiado. Se a função não retornar o conjunto de cores, NULL será retornado.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se for retornado um conjunto de cores válidos; Caso contrário, 0.

### <a name="remarks"></a>Comentários

O contêiner chama esta função para obter todas as cores necessárias para desenhar o controle OLE. O contêiner pode usar os conjuntos de cor obtidos em conjunto com as cores que ele precisa para definir a paleta de cores geral. A implementação padrão retorna falso.

Substitua essa função para fazer qualquer processamento especial dessa solicitação.

##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo

Chamado pelo framework quando o contêiner do controle solicitou informações sobre o controle.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Parâmetros

*pControlInfo*<br/>
Ponteiro para um [CONTROLINFO](/windows/desktop/api/ocidl/ns-ocidl-tagcontrolinfo) estrutura a ser preenchido.

### <a name="remarks"></a>Comentários

Essas informações consistem basicamente em uma descrição das chaves de mnemônica do controle. Os preenchimentos de implementação do padrão *pControlInfo* com informações padrão.

Substitua essa função se o seu controle precisa processar teclas mnemônicas.

##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString

Chamado pelo framework para obter uma cadeia de caracteres que representa o valor atual da propriedade identificado pelo *dispid*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Parâmetros

*dispid*<br/>
A ID de expedição de uma propriedade do controle.

*strValue*<br/>
Uma referência a um [CString](../../atl-mfc-shared/reference/cstringt-class.md) objeto por meio do qual uma cadeia de caracteres será retornada.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se uma cadeia de caracteres foi retornada em *strValue;* caso contrário, 0.

### <a name="remarks"></a>Comentários

Substitua essa função se o controle tem uma propriedade cujo valor não pode ser convertido diretamente em uma cadeia de caracteres e você deseja que o valor da propriedade a ser exibido em um navegador de propriedade fornecidos pelo contêiner.

##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu

Chamado pelo framework quando o controle é ativado para obter o menu a ser mesclado com o menu de existente do contêiner de interface do usuário.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Valor de retorno

O identificador do menu, ou nulo se o controle não tiver nenhum do controle. A implementação padrão retorna NULL.

### <a name="remarks"></a>Comentários

Para obter mais informações sobre a mesclagem dos recursos do OLE, consulte o artigo [Menus e recursos (OLE)](../../mfc/menus-and-resources-ole.md).

##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent

Chamado pelo framework em resposta a um contêiner `IViewObjectEx::GetNaturalExtent` solicitação.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Parâmetros

*dwAspect*<br/>
Especifica como o objeto deve ser representado. Representações de incluem o conteúdo, um ícone, uma miniatura ou um documento impresso. Os valores válidos são tirados da enumeração [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) ou DVASPECT2.

*lindex*<br/>
A parte do objeto que é de interesse. No momento, somente a -1 é válido.

*ptd*<br/>
Aponta para o [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) estrutura definindo o dispositivo de destino para o qual o tamanho do objeto deve ser retornado.

*hicTargetDev*<br/>
Especifica o contexto de informações do dispositivo de destino indicado pela *ptd* parâmetro do qual o objeto pode extrair métricas do dispositivo e as funcionalidades do dispositivo de teste. Se *ptd* for NULL, o objeto deve ignorar o valor de *hicTargetDev* parâmetro.

*pExtentInfo*<br/>
Aponta para o `DVEXTENTINFO` estrutura que especifica os dados de dimensionamento. O `DVEXTENTINFO` estrutura é:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

O membro da estrutura `dwExtentMode` pode assumir um dos dois valores:

- DVEXTENT_CONTENT consultar o tamanho máximo que o controle deve ser ajustar exatamente o conteúdo (snap para tamanho)

- DVEXTENT_INTEGRAL ao redimensionar, passar o tamanho proposto para controle

*psizel*<br/>
Pontos de dados retornados pelo controle de tamanho. Os dados retornados de dimensionamento são definidos como -1 para todas as dimensões não foi ajustada.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se ele retorna com êxito ou ajusta o tamanho; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Substituir essa função para retornar o tamanho de exibição do objeto mais próximo para o modo de tamanho e a extensão proposto no `DVEXTENTINFO` estrutura. A implementação padrão retorna falso e não faz com que nenhum ajuste ao tamanho.

##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings

Chamado pelo framework para obter um conjunto de cadeias de caracteres predefinidas, que representa os valores possíveis para uma propriedade.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Parâmetros

*dispid*<br/>
A ID de expedição de uma propriedade do controle.

*pStringArray*<br/>
Uma matriz de cadeia de caracteres a ser preenchida com valores de retorno.

*pCookieArray*<br/>
Uma matriz de DWORD para ser preenchido com valores de retorno.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se os elementos foram adicionados ao *pStringArray* e *pCookieArray*.

### <a name="remarks"></a>Comentários

Substitua essa função se o controle tem uma propriedade com um conjunto de valores possíveis que podem ser representadas por cadeias de caracteres. Para cada elemento adicionado à *pStringArray*, você deve adicionar um elemento correspondente do "cookie" para *pCookieArray.* Esses valores de "cookie" mais tarde podem ser passados pelo framework para o `COleControl::OnGetPredefinedValue` função.

##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue

Chamado pelo framework para obter o valor correspondente a uma das cadeias de caracteres predefinidas retornadas anteriormente por uma substituição do `COleControl::OnGetPredefinedStrings`.

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Parâmetros

*dispid*<br/>
A ID de expedição de uma propriedade do controle.

*dwCookie*<br/>
Um valor de cookie retornado anteriormente por uma substituição do `COleControl::OnGetPredefinedStrings`.

*lpvarOut*<br/>
Ponteiro para um `VARIANT` estrutura por meio do qual um valor da propriedade será retornado.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se um valor foi retornado em *lpvarOut*; caso contrário, 0.

##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent

Chamado pelo framework em resposta a um contêiner [IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent) solicitação.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Parâmetros

*dwDrawAspect*<br/>
DWORD que descreve qual formulário ou o aspecto de um objeto deve ser exibido. Os valores válidos são tirados da enumeração [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) ou DVASPECT2.

*lindex*<br/>
A parte do objeto que é de interesse. No momento, somente a -1 é válido.

*ptd*<br/>
Aponta para o [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) estrutura definindo o dispositivo de destino para o qual o tamanho do objeto deve ser retornado.

*lpsizel*<br/>
Aponta para o local em que o tamanho do objeto é retornado.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se informações de extensão são retornadas com êxito; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Substitua essa função se o controle usa duas passagens desenho e suas partes transparentes e opacos têm diferentes dimensões.

##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect

Chamado pelo framework em resposta a um contêiner `IViewObjectEx::GetRect` solicitação.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Parâmetros

*dwAspect*<br/>
DWORD que descreve qual formulário ou o aspecto de um objeto deve ser exibido. Os valores válidos são tirados da enumeração [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) ou DVASPECT2:

- Retângulo DVASPECT_CONTENT delimitadora do objeto inteiro. O canto superior esquerdo na origem do objeto e o tamanho igual a extensão retornada por `GetViewExtent` *.*

- Objetos DVASPECT_OPAQUE com uma região retangular de opaca retornar esse retângulo. Outras que apresentam falhas.

- Retângulo DVASPECT_TRANSPARENT que abrange todas as partes transparentes ou irregulares.

*pRect*<br/>
Aponta para o [RECTL](https://msdn.microsoft.com/library/windows/desktop/dd162907) estrutura especificando o retângulo no qual o objeto deve ser desenhado. Este parâmetro controla o posicionamento e alongamento do objeto.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o retângulo em tamanho ao objeto é retornado com êxito; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Tamanho do objeto é convertido pelo `OnGetViewRect` em um retângulo que começa em uma posição específica (o padrão é o canto superior esquerdo da tela). Substitua essa função se o controle usa duas passagens desenho e suas partes transparentes e opacos têm diferentes dimensões.

##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus

Chamado pelo framework em resposta a um contêiner `IViewObjectEx::GetViewStatus` solicitação.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Valor de retorno

Um dos valores da enumeração VIEWSTATUS se bem-sucedido; Caso contrário, 0. Os valores possíveis são qualquer combinação das seguintes opções:

|||
|-|-|
|VIEWSTATUS_OPAQUE|Objeto é completamente opaco. Se este bit não está definido, o objeto contém partes transparentes. Esse bit aplica-se somente a aspectos relacionados ao conteúdo e não a DVASPECT_ICON ou DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|O objeto tem um plano de fundo sólido (consistindo em uma cor sólida, não é um padrão de pincel). Esse bit é significativa somente se VIEWSTATUS_OPAQUE é definida e aplicada apenas nos aspectos relacionados ao conteúdo e não a DVASPECT_ICON ou DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|Objeto dá suporte a DVASPECT_OPAQUE. Todos os métodos de IViewObjectEx que levam um aspecto de desenho como um parâmetro pode ser chamado com esse aspecto.|
|VIEWSTATUS_DVASPECTTRANSPARENT|Objeto dá suporte a DVASPECT_TRANSPARENT. Todos os `IViewObjectEx` métodos que usam um aspecto de desenho como um parâmetro pode ser chamado com esse aspecto.|

### <a name="remarks"></a>Comentários

Substitua essa função se o controle usa o desenho de duas etapas. A implementação padrão retorna VIEWSTATUS_OPAQUE.

##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars

Chamado pelo framework quando o controle é desativado pela IU.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Comentários

A implementação deve ocultar todas as barras de ferramentas exibidas por `OnShowToolbars`.

##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove

Chamado pelo contêiner para o objeto inativo sob o ponteiro do mouse no recebimento de uma mensagem WM_MOUSEMOVE.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Parâmetros

*lprcBounds*<br/>
O objeto de retângulo, nas coordenadas do cliente da janela delimitador. Informa ao objeto sua posição exata e o tamanho na tela quando a mensagem WM_MOUSEMOVE foi recebida.

*x*<br/>
A coordenada x do local do mouse nas coordenadas de cliente da janela.

*y*<br/>
A coordenada y do local do mouse nas coordenadas de cliente da janela.

*dwKeyState*<br/>
Identifica o estado atual das teclas modificadoras do teclado. Os valores válidos podem ser uma combinação de qualquer um dos sinalizadores MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON e MK_RBUTTON.

### <a name="remarks"></a>Comentários

Observe que o coordenadas de cliente da janela (pixels) são usadas para transmitir a posição do cursor do mouse. Isso se tornou possível, também passando o retângulo delimitador do objeto no mesmo sistema de coordenadas.

##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor

Chamado pelo contêiner para o objeto inativo sob o ponteiro do mouse no recebimento de uma mensagem WM_SETCURSOR.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Parâmetros

*lprcBounds*<br/>
O objeto de retângulo, nas coordenadas do cliente da janela delimitador. Informa ao objeto sua posição exata e o tamanho na tela quando a mensagem WM_SETCURSOR foi recebida.

*x*<br/>
A coordenada x do local do mouse nas coordenadas de cliente da janela.

*y*<br/>
A coordenada y do local do mouse nas coordenadas de cliente da janela.

*dwMouseMsg*<br/>
O identificador da mensagem de mouse para a qual uma mensagem WM_SETCURSOR ocorreu.

*bSetAlways*<br/>
Especifica se o objeto deve definir o cursor. Se for TRUE, o objeto deve definir o cursor; Se for FALSE, o cursor não está obrigado a definir o cursor e deve retornar S_FALSE nesse caso.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se bem-sucedido; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Observe que o coordenadas de cliente da janela (pixels) são usadas para transmitir a posição do cursor do mouse. Isso se tornou possível, também passando o retângulo delimitador do objeto no mesmo sistema de coordenadas.

##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent

Chamado pelo framework depois que um evento KeyDown estoque foi processado.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parâmetros

*nChar*<br/>
O valor de código de tecla virtual da tecla pressionada. Para obter uma lista de códigos de tecla virtuais padrão, consulte WinUser. h

*nShiftState*<br/>
Contém uma combinação dos sinalizadores a seguir:

- Tecla SHIFT The do SHIFT_MASK foi pressionada durante a ação.

- Tecla CTRL The do CTRL_MASK foi pressionada durante a ação.

- ALT de ALT_MASK a tecla foi pressionada durante a ação.

### <a name="remarks"></a>Comentários

Substitua essa função se seu controle precisa acessar as informações da chave depois que o evento foi acionado.

##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent

Chamado pelo framework após o evento KeyPress foi acionado de estoque.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Parâmetros

*nChar*<br/>
Contém o valor de código de tecla virtual da tecla pressionada. Para obter uma lista de códigos de tecla virtuais padrão, consulte WinUser. h

### <a name="remarks"></a>Comentários

Observe que o *nChar* valor pode ter sido modificado pelo contêiner.

Substitua essa função se desejar notificação após esse evento ocorre.

##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent

Chamado pelo framework depois que um evento KeyDown estoque foi processado.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parâmetros

*nChar*<br/>
O valor de código de tecla virtual da tecla pressionada. Para obter uma lista de códigos de tecla virtuais padrão, consulte WinUser. h

*nShiftState*<br/>
Contém uma combinação dos sinalizadores a seguir:

- Tecla SHIFT The do SHIFT_MASK foi pressionada durante a ação.

- Tecla CTRL The do CTRL_MASK foi pressionada durante a ação.

- ALT de ALT_MASK a tecla foi pressionada durante a ação.

### <a name="remarks"></a>Comentários

Substitua essa função se seu controle precisa acessar as informações da chave depois que o evento foi acionado.

##  <a name="onmappropertytopage"></a>  COleControl::OnMapPropertyToPage

Chamado pelo framework para obter a ID de classe de uma página de propriedade que implementa a edição da propriedade especificada.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Parâmetros

*dispid*<br/>
A ID de expedição de uma propriedade do controle.

*lpclsid*<br/>
Ponteiro para um `CLSID` estrutura por meio do qual uma ID de classe será retornada.

*pbPageOptional*<br/>
Retorna um indicador de se o uso da página de propriedades especificada é opcional.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se uma ID de classe foi retornada em *lpclsid*; caso contrário, 0.

### <a name="remarks"></a>Comentários

Substitua essa função para fornecer uma maneira de invocar páginas de propriedades do controle de navegador de propriedade do contêiner.

##  <a name="onmnemonic"></a>  COleControl::OnMnemonic

Chamado pelo framework quando o contêiner detectou que uma tecla mnemônica do controle OLE foi pressionada.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Parâmetros

*pMsg*<br/>
Ponteiro para a mensagem de Windows gerado por um pressionamento de tecla mnemônico.

##  <a name="onproperties"></a>  COleControl::OnProperties

Chamado pelo framework quando o verbo de propriedades do controle foi invocado pelo contêiner.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parâmetros

*lpMsg*<br/>
Um ponteiro para a mensagem do Windows que invocou o verbo.

*hWndParent*<br/>
Um identificador para a janela pai do controle.

*lpRect*<br/>
Um ponteiro para o retângulo usado pelo controle no contêiner.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se a chamada for bem-sucedida; Caso contrário, 0.

### <a name="remarks"></a>Comentários

A implementação padrão exibe uma caixa de diálogo de propriedades restrita.

Você também pode usar essa função para fazer com que a exibição das páginas de propriedades do seu controle. Fazer uma chamada para o `OnProperties` função, passando o identificador do pai do controle no *hWndParent* parâmetro. Nesse caso, os valores de *lpMsg* e *lpRect* parâmetros serão ignorados.

##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint

Chamado pelo framework em resposta a um contêiner `IViewObjectEx::QueryHitPoint` solicitação.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parâmetros

*dwAspect*<br/>
Especifica como o objeto é representado. Os valores válidos são tirados da enumeração [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) ou DVASPECT2.

*pRectBounds*<br/>
Ponteiro para um `RECT` estrutura especificando o retângulo delimitador da área de cliente de controle OLE.

*ptlLoc*<br/>
Ponteiro para o `POINT` estrutura especificando o ponto a ser verificado para uma ocorrência. O ponto é especificado nas coordenadas de área de cliente OLE.

*lCloseHint*<br/>
A distância que define "Fechar" para o ponto de verificada para uma ocorrência.

*pHitResult*<br/>
Ponteiro para o resultado da consulta de visita. Um dos seguintes valores:

- HITRESULT_OUTSIDE *ptlLoc* está fora do OLE do objeto e não feche.

- HITRESULT_TRANSPARENT *ptlLoc* está dentro dos limites do objeto OLE, mas não perto da imagem. Por exemplo, um ponto no meio de um círculo transparente poderia ser HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* está dentro ou fora o objeto OLE, mas fechar o suficiente para o objeto a ser considerado dentro. Objetos pequenos, finos ou detalhados podem usar esse valor. Mesmo se um ponto está fora de delimitação retângulo de um objeto que ele ainda pode ser fechar (Isso é necessário para atingir objetos pequenos).

- HITRESULT_HIT *ptlLoc* está dentro da imagem do objeto.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se um resultado de ocorrência for retornado com êxito; Caso contrário, 0. Uma ocorrência é uma sobreposição com a área de exibição de controle OLE.

### <a name="remarks"></a>Comentários

Consulta se o retângulo de exibição de um objeto se sobrepõe o determinado ponto (atinge o ponto). `QueryHitPoint` pode ser substituído para testar as ocorrências para objetos não retangulares.

##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect

Chamado pelo framework em resposta a um contêiner `IViewObjectEx::QueryHitRect` solicitação.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parâmetros

*dwAspect*<br/>
Especifica como o objeto deve ser representado. Os valores válidos são tirados da enumeração [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) ou DVASPECT2.

*pRectBounds*<br/>
Ponteiro para um `RECT` estrutura especificando o retângulo delimitador da área de cliente de controle OLE.

*prcLoc*<br/>
Ponteiro para o `RECT` estrutura especificando o retângulo a ser verificado para uma ocorrência (sobreposição com o retângulo de objeto), em relação ao canto superior esquerdo do objeto.

*lCloseHint*<br/>
Não usado.

*pHitResult*<br/>
Ponteiro para o resultado da consulta de visita. Um dos seguintes valores:

- HITRESULT_OUTSIDE nenhuma razão para o retângulo for atingida por objeto OLE.

- HITRESULT_HIT pelo menos um ponto no retângulo seria um impacto no objeto.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se um resultado de ocorrência for retornado com êxito; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Consulta se o retângulo de exibição de um objeto se sobrepõe a qualquer ponto no retângulo determinado (atinge o retângulo). `QueryHitRect` pode ser substituído para testar as ocorrências para objetos não retangulares.

##  <a name="onrenderdata"></a>  COleControl::OnRenderData

Chamado pelo framework para recuperar dados no formato especificado.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Parâmetros

*lpFormatEtc*<br/>
Aponta para o [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) estrutura especificando o formato no qual as informações são solicitadas.

*lpStgMedium*<br/>
Aponta para um [STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium) estrutura na qual os dados deve ser retornado.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se bem-sucedido; Caso contrário, 0.

### <a name="remarks"></a>Comentários

O formato especificado é um colocado anteriormente no objeto de controle usando o [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) ou [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) funções de membro para renderização atrasada. A implementação padrão dessa função chama `OnRenderFileData` ou `OnRenderGlobalData`, respectivamente, se a mídia de armazenamento fornecido é um arquivo ou memória. Se o formato solicitado for CF_METAFILEPICT ou o formato de conjunto de propriedade persistente, a implementação padrão processa os dados apropriados e retorna não zero. Caso contrário, ele retorna 0 e não faz nada.

Se *lpStgMedium -> tymed* é TYMED_NULL, o STGMEDIUM deve ser alocado e preenchido conforme especificado por *lpFormatEtc -> tymed*. Se não for TYMED_NULL, o STGMEDIUM deve ser preenchido em vigor com os dados.

Substitua essa função para fornecer seus dados no formato solicitado e média. Dependendo de seus dados, você talvez queira substituir uma das outras versões dessa função em vez disso. Se os dados forem pequenos e com o tamanho fixo, substituir `OnRenderGlobalData`. Se os dados estiverem em um arquivo ou é de tamanho variável, substituir `OnRenderFileData`.

Para obter mais informações, consulte o `FORMATETC` e `STGMEDIUM` estruturas no SDK do Windows.

##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData

Chamado pelo framework para recuperar dados no formato especificado quando a mídia de armazenamento é um arquivo.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Parâmetros

*lpFormatEtc*<br/>
Aponta para o [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) estrutura especificando o formato no qual as informações são solicitadas.

*pFile*<br/>
Aponta para um [CFile](../../mfc/reference/cfile-class.md) objeto no qual os dados a serem renderizados.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se bem-sucedido; Caso contrário, 0.

### <a name="remarks"></a>Comentários

O formato especificado é um colocado anteriormente no objeto de controle usando o [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) a função de membro para renderização atrasada. A implementação padrão dessa função simplesmente retorna FALSE.

Substitua essa função para fornecer seus dados no formato solicitado e média. Dependendo de seus dados, você talvez queira substituir uma das outras versões dessa função em vez disso. Se você quiser manipular vários meios de armazenamento, substituir `OnRenderData`. Se os dados estiverem em um arquivo ou é de tamanho variável, substituir `OnRenderFileData`.

Para obter mais informações, consulte o `FORMATETC` estrutura no SDK do Windows.

##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData

Chamado pelo framework para recuperar dados no formato especificado quando a mídia de armazenamento especificado é memória global.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Parâmetros

*lpFormatEtc*<br/>
Aponta para o [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) estrutura especificando o formato no qual as informações são solicitadas.

*phGlobal*<br/>
Aponta para um identificador para a memória global no qual os dados deve ser retornado. Se nenhuma memória foi alocada, esse parâmetro pode ser NULL.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se bem-sucedido; Caso contrário, 0.

### <a name="remarks"></a>Comentários

O formato especificado é um colocado anteriormente no objeto de controle usando o [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) a função de membro para renderização atrasada. A implementação padrão dessa função simplesmente retorna FALSE.

Se *phGlobal* for NULL, e em seguida, um novo HGLOBAL deve ser alocado e retornado na *phGlobal*. Caso contrário, o HGLOBAL especificado por *phGlobal* deve ser preenchido com os dados. A quantidade de dados colocados no HGLOBAL não deve exceder o tamanho atual do bloco de memória. Além disso, o bloco não pode ser realocado para um tamanho maior.

Substitua essa função para fornecer seus dados no formato solicitado e média. Dependendo de seus dados, você talvez queira substituir uma das outras versões dessa função em vez disso. Se você quiser manipular vários meios de armazenamento, substituir `OnRenderData`. Se os dados estiverem em um arquivo ou é de tamanho variável, substituir `OnRenderFileData`.

Para obter mais informações, consulte o `FORMATETC` estrutura no SDK do Windows.

##  <a name="onresetstate"></a>  COleControl::OnResetState

Chamado pelo framework quando as propriedades do controle devem ser definidas para seus valores padrão.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Comentários

A implementação padrão chama [DoPropExchange](#dopropexchange), passando um `CPropExchange` objeto que faz com que as propriedades sejam definidas para seus valores padrão.

O gravador de controle possa inserir o código de inicialização para o controle OLE desta substituível. Essa função é chamada quando [IPersistStream::Load](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) ou [IPersistStorage::Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load) falhar, ou [IPersistStreamInit::InitNew](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) ou [IPersistStorage: : InitNew](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-initnew) é chamado sem primeiro chamar `IPersistStream::Load` ou `IPersistStorage::Load`.

##  <a name="onsetclientsite"></a>  COleControl::OnSetClientSite

Chamado pelo framework quando o contêiner é chamado do controle `IOleControl::SetClientSite` função.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Comentários

Por padrão, `OnSetClientSite` verifica se as propriedades de caminho de dados são carregadas e, se elas forem, chama `DoDataPathPropExchange`.

Substitua essa função para fazer qualquer processamento especial dessa notificação. Em particular, substituições dessa função devem chamar a classe base.

##  <a name="onsetdata"></a>  COleControl::OnSetData

Chamado pelo framework para substituir os dados do controle com os dados especificados.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Parâmetros

*lpFormatEtc*<br/>
Ponteiro para um [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) estrutura especificando o formato dos dados.

*lpStgMedium*<br/>
Ponteiro para um [STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium) estrutura na qual os dados residem.

*bRelease*<br/>
TRUE se o controle deve liberar o meio de armazenamento; FALSE se o controle não deve liberar o meio de armazenamento.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se bem-sucedido; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Se os dados estão na propriedade persistente de formato definidos, a implementação padrão modifica o estado do controle adequadamente. Caso contrário, a implementação padrão não faz nada. Se *bRelease* é TRUE e, em seguida, uma chamada para `ReleaseStgMedium` for feita; caso contrário, não.

Substitua essa função para substituir os dados do controle com os dados especificados.

Para obter mais informações, consulte o `FORMATETC` e `STGMEDIUM` estruturas no SDK do Windows.

##  <a name="onsetextent"></a>  COleControl::OnSetExtent

Chamado pelo framework quando a extensão do controle precisa ser alterado, como resultado de uma chamada para [IOleObject::SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Parâmetros

*lpSizeL*<br/>
Um ponteiro para o `SIZEL` estrutura que usa inteiros longos para representar a largura e altura do controle, expressada em unidades HIMETRIC.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se a alteração de tamanho foi aceita; Caso contrário, 0.

### <a name="remarks"></a>Comentários

A implementação padrão lida com o redimensionamento de extensão do controle. Se o controle estiver ativo no local, uma chamada para o contêiner `OnPosRectChanged` é feita.

Substitua essa função para alterar o padrão de redimensionamento do seu controle.

##  <a name="onsetobjectrects"></a>  COleControl::OnSetObjectRects

Chamado pelo framework para implementar uma chamada para [IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Parâmetros

*lpRectPos*<br/>
Um ponteiro para um `RECT` estrutura que indica a nova posição e tamanho relativo ao contêiner do controle.

*lpRectClip*<br/>
Um ponteiro para um `RECT` estrutura indicando uma área retangular ao qual o controle deve ser recortada.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o reposicionamento foi aceita; Caso contrário, 0.

### <a name="remarks"></a>Comentários

A implementação padrão automaticamente manipula a reposicionamento e redimensionamento da janela de controle e retorna TRUE.

Substitua essa função para alterar o comportamento padrão dessa função.

##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars

Chamado pelo framework quando o controle tiver sido ativada de interface do usuário.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Comentários

A implementação padrão não faz nada.

##  <a name="ontextchanged"></a>  COleControl::OnTextChanged

Chamado pelo framework quando o valor da propriedade legenda ou texto estoque foi alterado.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Comentários

A implementação padrão chama `InvalidateControl`.

Substitua essa função se você quiser que a notificação após a alteração de propriedade.

##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage

Chamado pelo framework em resposta a um contêiner `IOleInPlaceObjectWindowless::OnWindowMessage` solicitação.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Parâmetros

*msg*<br/>
Identificador de mensagem passados pelo Windows.

*wParam*<br/>
Passados pelo Windows. Especifica informações adicionais de mensagem específica. O conteúdo desse parâmetro depende do valor da *msg* parâmetro.

*lParam*<br/>
Passados pelo Windows. Especifica informações adicionais de mensagem específica. O conteúdo desse parâmetro depende do valor da *msg* parâmetro.

*plResult*<br/>
Código de resultado do Windows. Especifica o resultado do processamento da mensagem e depende da mensagem enviada.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se bem-sucedido; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Processa as mensagens de janela para os controles sem janelas. `COleControl`do `OnWindowlessMessage` deve ser usado para mensagens de janela diferentes mensagens de mouse e teclado. `COleControl` Fornece [SetCapture](#setcapture) e [SetFocus](#setfocus) especificamente para obter o foco do teclado e de captura do mouse para os objetos OLE sem janelas.

Como objetos sem janelas não têm uma janela, eles precisam de um mecanismo para permitir que as mensagens de expedição de contêiner para eles. Um objeto OLE sem janelas obtém mensagens de seu contêiner, por meio de `OnWindowMessage` método na `IOleInPlaceObjectWindowless` interface (uma extensão da [IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject) para suporte sem janelas). `OnWindowMessage` Não utilize um `HWND` parâmetro.

##  <a name="parenttoclient"></a>  COleControl::ParentToClient

Converte as coordenadas de *pPoint* nas coordenadas do cliente.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Parâmetros

*lprcBounds*<br/>
Ponteiro para os limites do controle OLE dentro do contêiner. A área de todo o controle incluindo bordas e barras de rolagem, mas não a área de cliente.

*pPoint*<br/>
Ponteiro para o pai (contêiner) apontam para ser convertido em coordenadas de área de cliente do controle.

*bHitTest*<br/>
Especifica se ou não teste de clique deve ser feito no ponto.

### <a name="return-value"></a>Valor de retorno

Se *bHitTest* for FALSE, retornará HTNOWHERE. Se *bHitTest* for TRUE, retorna o local no qual o pai (contêiner) aponte foram descarregadas na área de cliente de controle OLE e é um dos seguinte mouse valores de teste de clique:

- HTBORDER na borda de uma janela que não tem uma borda de dimensionamento.

- HTBOTTOM na borda horizontal inferior da janela.

- HTBOTTOMLEFT no canto inferior esquerdo da borda da janela.

- HTBOTTOMRIGHT no canto inferior direito da borda da janela.

- HTCAPTION em uma área da barra de título.

- HTCLIENT em uma área de cliente.

- HTERROR no plano de fundo de tela ou em uma linha divisória entre as janelas (mesmo que HTNOWHERE, exceto que o `DefWndProc` função Windows produz um alarme sonoro do sistema para indicar um erro).

- HTGROWBOX em uma caixa de tamanho.

- HTHSCROLL na barra de rolagem horizontal.

- HTLEFT na borda esquerda da janela.

- Botão HTMAXBUTTON em um maximizar.

- HTMENU em uma área de menu.

- Botão HTMINBUTTON um minimizar.

- HTNOWHERE no plano de fundo de tela ou em uma linha divisória entre as janelas.

- Botão HTREDUCE um minimizar.

- HTRIGHT na borda direita da janela.

- HTSIZE em uma caixa de tamanho (mesmo que HTGROWBOX).

- Menu HTSYSMENU em um controle ou em um botão Fechar em uma janela filho.

- HTTOP na borda horizontal superior da janela.

- HTTOPLEFT no canto superior esquerdo da borda da janela.

- HTTOPRIGHT no canto superior direito da borda da janela.

- HTTRANSPARENT em uma janela abordada no momento por outra janela.

- HTVSCROLL na barra de rolagem vertical.

- Botão HTZOOM em um maximizar.

### <a name="remarks"></a>Comentários

Na entrada *pPoint* é relativo à origem do pai (canto superior esquerdo do contêiner). Na saída *pPoint* é relativo à origem da área de cliente do controle OLE (canto superior esquerdo da área de cliente do controle).

##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog

Notifica o contêiner que uma caixa de diálogo modal foi fechada.

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parâmetros

*hWndParent*<br/>
Identificador da janela pai da caixa de diálogo modal.

### <a name="remarks"></a>Comentários

Chame essa função depois de exibir qualquer caixa de diálogo modal. Você deve chamar essa função para que o contêiner pode habilitar qualquer janela de nível superior desabilitada por `PreModalDialog`. Essa função deve ser emparelhada com uma chamada para `PreModalDialog`.

##  <a name="premodaldialog"></a>  COleControl::PreModalDialog

Notifica o contêiner que uma caixa de diálogo modal está prestes a ser exibido.

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parâmetros

*hWndParent*<br/>
Identificador da janela pai da caixa de diálogo modal.

### <a name="remarks"></a>Comentários

Chame essa função antes de exibir qualquer caixa de diálogo modal. Você deve chamar essa função para que o contêiner pode desabilitar todas as suas janelas de nível superior. Depois que a caixa de diálogo modal foi exibida, em seguida, você deve chamar `PostModalDialog`.

##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow

Destrói e cria novamente a janela do controle.

```
void RecreateControlWindow();
```

### <a name="remarks"></a>Comentários

Isso pode ser necessário se você precisar alterar os bits de estilo da janela.

##  <a name="refresh"></a>  COleControl::Refresh

Força um redesenho do controle OLE.

```
void Refresh();
```

### <a name="remarks"></a>Comentários

Essa função dá suporte a `COleControl` classe base como um método de estoque, chamado de atualização. Isso permite que os usuários do seu controle OLE redesenhar o controle em um momento específico. Para obter mais informações sobre esse método, consulte o artigo [controles ActiveX: Métodos](../../mfc/mfc-activex-controls-methods.md).

##  <a name="releasecapture"></a>  COleControl::ReleaseCapture

Libera a captura do mouse.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se bem-sucedido; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Se o controle atualmente tiver a captura do mouse, a captura é liberada. Caso contrário, essa função não tem efeito.

##  <a name="releasedc"></a>  COleControl::ReleaseDC

Libera o contexto de dispositivo de exibição de um contêiner de um controle sem janelas, liberando o contexto de dispositivo para uso por outros aplicativos.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
Identifica o contexto de dispositivo do contêiner a ser liberado.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se bem-sucedido; Caso contrário, 0.

### <a name="remarks"></a>Comentários

O aplicativo deve chamar `ReleaseDC` para cada chamada para [GetDC](#getdc).

##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow

Define o pai do controle.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Parâmetros

*hWndOuter*<br/>
O identificador da janela de controle.

*hWndParent*<br/>
O identificador da nova janela pai.

### <a name="remarks"></a>Comentários

Chame essa função para redefinir o pai da janela de controle.

##  <a name="resetstockprops"></a>  COleControl::ResetStockProps

Inicializa o estado do `COleControl` propriedades para seus valores padrão de estoque.

```
void ResetStockProps();
```

### <a name="remarks"></a>Comentários

As propriedades são: Aparência, BackColor, BorderStyle, legenda, habilitado, fonte, cor de primeiro plano, hWnd e texto. Para obter uma descrição de propriedades de estoque, consulte [controles ActiveX: Adicionando propriedades de estoque](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Você pode melhorar o desempenho de inicialização binário de um controle usando `ResetStockProps` e `ResetVersion` substituir `COleControl::OnResetState`. Consulte o exemplo abaixo. Para obter mais informações sobre como otimizar a inicialização, consulte [controles ActiveX: Otimização](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Exemplo

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>  COleControl::ResetVersion

Inicializa o número de versão para o valor especificado.

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Parâmetros

*dwVersionDefault*<br/>
O número de versão a ser atribuído ao controle.

### <a name="remarks"></a>Comentários

Você pode melhorar o desempenho de inicialização binário de um controle usando `ResetVersion` e `ResetStockProps` substituir `COleControl::OnResetState`. Veja o exemplo na [ResetStockProps](#resetstockprops). Para obter mais informações sobre como otimizar a inicialização, consulte [controles ActiveX: Otimização](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="scrollwindow"></a>  COleControl::ScrollWindow

Permite que um objeto OLE sem janelas rolar uma área dentro de sua imagem de Active Directory no local na tela.

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parâmetros

*xAmount*<br/>
Especifica a quantidade, em unidades de dispositivo de rolagem horizontal. Esse parâmetro deve ser um valor negativo para rolar para a esquerda.

*yAmount*<br/>
Especifica a quantidade, em unidades de dispositivo de rolagem vertical. Esse parâmetro deve ser um valor negativo para rolar para cima.

*lpRect*<br/>
Aponta para um [CRect](../../atl-mfc-shared/reference/crect-class.md) objeto ou estrutura RECT que especifica a parte da área de cliente do objeto OLE a rolar, nas coordenadas do cliente da janela. Se *lpRect* for NULL, área de cliente do objeto OLE inteiro é rolada.

*lpClipRect*<br/>
Aponta para um `CRect` objeto ou `RECT` estrutura que especifica o retângulo de recorte para. Somente os pixels dentro do retângulo são rolados. Bits fora do retângulo não são afetadas, mesmo se eles estiverem na *lpRect* retângulo. Se *lpClipRect* for NULL, sem recorte é executada no retângulo de rolagem.

##  <a name="selectfontobject"></a>  COleControl::SelectFontObject

Seleciona uma fonte em um contexto de dispositivo.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
Ponteiro para um objeto de contexto de dispositivo.

*fontHolder*<br/>
Referência para o [CFontHolder](../../mfc/reference/cfontholder-class.md) objeto que representa a fonte a ser selecionado.

### <a name="return-value"></a>Valor de retorno

Um ponteiro para a fonte selecionada anteriormente. Quando o chamador foi concluído todas as operações de desenho que usam *fontHolder,* deve selecionar novamente a fonte selecionada anteriormente, passando-o como um parâmetro para [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject).

##  <a name="selectstockfont"></a>  COleControl::SelectStockFont

Seleciona a propriedade de fonte de estoque em um contexto de dispositivo.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
O contexto de dispositivo no qual a fonte será selecionada.

### <a name="return-value"></a>Valor de retorno

Um ponteiro para o selecionado anteriormente `CFont` objeto. Você deve usar [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject) para selecionar essa fonte volta para o contexto de dispositivo quando tiver terminado.

##  <a name="serializeextent"></a>  COleControl::SerializeExtent

Serializa ou inicializa o estado do espaço de exibição alocado para o controle.

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Parâmetros

*ar*<br/>
Um `CArchive` objeto a ser serializado para ou do.

### <a name="remarks"></a>Comentários

Você pode melhorar o desempenho de persistência binário de um controle usando `SerializeExtent`, `SerializeStockProps`, e `SerializeVersion` substituir `COleControl::Serialize`. Consulte o exemplo abaixo. Para obter mais informações sobre como otimizar a inicialização, consulte [controles ActiveX: Otimização](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Exemplo

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps

Serializa ou inicializa o estado do `COleControl` propriedades de estoque: Aparência, BackColor, BorderStyle, legenda, habilitada, fonte, cor de primeiro plano e texto.

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Parâmetros

*ar*<br/>
Um `CArchive` objeto a ser serializado para ou do.

### <a name="remarks"></a>Comentários

Para obter uma descrição de propriedades de estoque, consulte [controles ActiveX: Adicionando propriedades de estoque](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Você pode melhorar o desempenho de persistência binário de um controle usando `SerializeStockProps`, `SerializeExtent`, e `SerializeVersion` substituir `COleControl::Serialize`. Por exemplo, consulte o código no [SerializeExtent](#serializeextent). Para obter mais informações sobre como otimizar a inicialização, consulte [controles ActiveX: Otimização](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="serializeversion"></a>  COleControl::SerializeVersion

Serializa ou inicializa o estado das informações de versão do controle.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parâmetros

*ar*<br/>
Um `CArchive` objeto a ser serializado para ou do.

*dwVersionDefault*<br/>
O número de versão atual do controle.

*bConvert*<br/>
Indica se os dados persistentes devem ser convertidos para o formato mais recente quando ele é salvo ou mantido no mesmo formato que tinha quando ele foi carregado.

### <a name="return-value"></a>Valor de retorno

O número de versão do controle. Se o arquivo morto especificado está carregando, `SerializeVersion` retorna a versão carregada a partir desse arquivo. Caso contrário, ele retorna à versão carregada atualmente.

### <a name="remarks"></a>Comentários

Você pode melhorar o desempenho de persistência binário de um controle usando `SerializeVersion`, `SerializeExtent`, e `SerializeStockProps` substituir `COleControl::Serialize`. Por exemplo, consulte o código no [SerializeExtent](#serializeextent). Para obter mais informações sobre como otimizar a inicialização, consulte [controles ActiveX: Otimização](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="setappearance"></a>  COleControl::SetAppearance

Define o valor da propriedade Appearance estoque de seu controle.

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Parâmetros

*sAppearance*<br/>
Um **curto** (VT_I2) o valor a ser usado para a aparência do seu controle. Um valor de zero define a aparência do controle para simples e um valor de 1 define a aparência do controle para 3D.

### <a name="remarks"></a>Comentários

Para obter mais informações sobre propriedades de estoque, consulte [controles ActiveX: Propriedades](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setbackcolor"></a>  COleControl::SetBackColor

Define o valor da propriedade BackColor estoque de seu controle.

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Parâmetros

*dwBackColor*<br/>
Um valor OLE_COLOR a ser usado para o plano de fundo de desenho do seu controle.

### <a name="remarks"></a>Comentários

Para obter mais informações sobre como usar essa propriedade e outras propriedades relacionadas, consulte o artigo [controles ActiveX: Propriedades](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle

Define o valor da propriedade BorderStyle estoque de seu controle.

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Parâmetros

*sBorderStyle*<br/>
O novo estilo de borda para o controle; 0 não indica que nenhuma borda e 1 indica uma borda normal.

### <a name="remarks"></a>Comentários

A janela de controle, em seguida, será recriada e `OnBorderStyleChanged` chamado.

##  <a name="setcapture"></a>  COleControl::SetCapture

Faz com que a janela do controle recipiente entrem em posse da captura do mouse no nome do controle.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para o `CWnd` objeto window que recebeu anteriormente uma entrada de mouse.

### <a name="remarks"></a>Comentários

Se o controle é ativado e sem janelas, essa função faz com que a janela do controle recipiente entrem em posse da captura do mouse, em nome do controle. Caso contrário, essa função faz com que o controle em si entrem em posse da captura do mouse (mesmo que `CWnd::SetCapture`).

##  <a name="setcontrolsize"></a>  COleControl::SetControlSize

Define o tamanho da janela de controle OLE e notifica o contêiner que o site do controle está sendo alterada.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Parâmetros

*cx*<br/>
Especifica a nova largura do controle em pixels.

*cy*<br/>
Especifica a nova altura do controle em pixels.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se a chamada foi bem-sucedida; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Essa função não deve ser usada no construtor do seu controle.

Observe que todas as coordenadas para o windows de controle são relativas ao canto superior esquerdo do controle.

##  <a name="setenabled"></a>  COleControl::SetEnabled

Define o valor da propriedade Enabled do controle de estoque.

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Parâmetros

*bEnabled*<br/>
TRUE se o controle deve ser habilitada; Caso contrário, FALSE.

### <a name="remarks"></a>Comentários

Depois de definir essa propriedade, `OnEnabledChange` é chamado.

##  <a name="setfocus"></a>  COleControl::SetFocus

Faz com que a janela do controle recipiente tomar posse do foco de entrada em nome do controle.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para o `CWnd` objeto de janela que anteriormente tinha a entrada se concentrar, ou nulo se não houver nenhuma janela.

### <a name="remarks"></a>Comentários

Se o controle é ativado e sem janelas, essa função faz com que a janela do controle recipiente tomar posse do foco de entrada, em nome do controle. O foco de entrada direciona a entrada do teclado para a janela do contêiner e o contêiner envia todas as mensagens de teclado subsequentes para o objeto OLE que chama `SetFocus`. Qualquer janela que anteriormente tinha o foco de entrada perde a ele.

Se o controle não for sem janelas, essa função faz com que o controle em si para tomar posse do foco de entrada (mesmo que `CWnd::SetFocus`).

##  <a name="setfont"></a>  COleControl::SetFont

Define a propriedade de fonte de estoque de seu controle.

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Parâmetros

*pFontDisp*<br/>
Um ponteiro para uma interface de expedição da Font.

##  <a name="setforecolor"></a>  COleControl::SetForeColor

Define o valor da propriedade ForeColor estoque de seu controle.

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Parâmetros

*dwForeColor*<br/>
Um valor OLE_COLOR a ser usado para o primeiro plano de desenho do seu controle.

### <a name="remarks"></a>Comentários

Para obter mais informações sobre como usar essa propriedade e outras propriedades relacionadas, consulte o artigo [controles ActiveX: Propriedades](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setinitialdataformats"></a>  COleControl::SetInitialDataFormats

Chamado pelo framework para inicializar a lista de formatos de dados compatível com o controle.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Comentários

A implementação padrão especifica dois formatos: CF_METAFILEPICT e a propriedade persistente definem.

##  <a name="setinitialsize"></a>  COleControl::SetInitialSize

Define o tamanho de um controle OLE quando exibido pela primeira vez em um contêiner.

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Parâmetros

*cx*<br/>
A largura inicial do controle OLE em pixels.

*cy*<br/>
A altura inicial do controle OLE em pixels.

### <a name="remarks"></a>Comentários

Chame essa função em seu construtor para definir o tamanho inicial do seu controle. O tamanho inicial é medido em unidades de dispositivo ou pixels. É recomendável que essa chamada ser feita no construtor do seu controle.

##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag

Altera o estado modificado de um controle.

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Parâmetros

*bModified*<br/>
O novo valor para o controle modificada do sinalizador. TRUE indica que o estado do controle foi modificado; FALSE indica que apenas o estado do controle foi salva.

### <a name="remarks"></a>Comentários

Essa função sempre que ocorre uma alteração que afetam o estado persistente do seu controle de chamada. Por exemplo, se o valor de uma propriedade persistente for alterado, chame essa função com *bModified* **verdadeiro**.

##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted

Indica que uma solicitação de edição falhou.

```
void SetNotPermitted();
```

### <a name="remarks"></a>Comentários

Chame essa função quando `BoundPropertyRequestEdit` falhar. Essa função gera uma exceção do tipo `COleDispScodeException` para indicar que a operação de definição não foi permitida.

##  <a name="setnotsupported"></a>  COleControl::SetNotSupported

Impede a modificação para o valor da propriedade do controle pelo usuário.

```
void SetNotSupported();
```

### <a name="remarks"></a>Comentários

Chame essa função em vez da função de conjunto de qualquer propriedade que não há suporte para modificação do valor da propriedade pelo usuário do controle. Um exemplo seria uma propriedade que é somente leitura.

##  <a name="setrectincontainer"></a>  COleControl::SetRectInContainer

Define as coordenadas do retângulo do controle relativo ao contêiner, expressado em unidades de dispositivo.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Parâmetros

*lpRect*<br/>
Um ponteiro para um retângulo que contém novas coordenadas do controle relativo ao contêiner.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se a chamada foi bem-sucedida; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Se o controle estiver aberto, ele é redimensionado; Caso contrário, o contêiner `OnPosRectChanged` função é chamada.

##  <a name="settext"></a>  COleControl::SetText

Define o valor da propriedade de legenda ou texto de estoque do seu controle.

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Parâmetros

*pszText*<br/>
Um ponteiro para uma cadeia de caracteres.

### <a name="remarks"></a>Comentários

Observe que as propriedades de legenda e o texto de estoque são ambos mapeadas para o mesmo valor. Isso significa que todas as alterações feitas a qualquer propriedade vai alterar automaticamente as duas propriedades. Em geral, um controle deve oferecer suporte a legenda de estoque ou propriedade de texto, mas não ambos.

##  <a name="throwerror"></a>  COleControl::ThrowError

Indica a ocorrência de um erro em seu controle.

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parâmetros

*sc*<br/>
O valor do código de status a ser relatado. Para obter uma lista completa de códigos de possíveis, consulte o artigo [controles ActiveX: Tópicos avançados](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
A ID de recurso de cadeia de caracteres da exceção a ser relatado.

*nHelpID*<br/>
A ID do tópico da ajuda a ser relatado no.

*pszDescription*<br/>
Uma cadeia de caracteres que contém uma explicação da exceção a ser relatado.

### <a name="remarks"></a>Comentários

Essa função só deve ser chamada de dentro de uma função Get ou Set de uma propriedade do OLE, ou a implementação de um método de automação OLE. Se você precisar sinalizar erros que ocorrem em outros momentos, você deve acionar o evento de erro de estoque.

##  <a name="transformcoords"></a>  COleControl::TransformCoords

Transformações de coordenam os valores entre unidades HIMETRIC e do contêiner nativo.

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Parâmetros

*lpptlHimetric*<br/>
Ponteiro para um `POINTL` estrutura que contém as coordenadas em unidades HIMETRIC.

*lpptfContainer*<br/>
Ponteiro para um `POINTF` estrutura que contém coordenadas no tamanho da unidade do contêiner.

*flags*<br/>
Uma combinação dos seguintes valores:

- Posição XFORMCOORDS_POSITION um no contêiner.

- Tamanho de um XFORMCOORDS_SIZE no contêiner.

- Unidades HIMETRIC de transformar XFORMCOORDS_HIMETRICTOCONTAINER para unidades do contêiner.

- XFORMCOORDS_CONTAINERTOHIMETRIC transformar unidades do contêiner para unidades HIMETRIC.

### <a name="remarks"></a>Comentários

Os primeiros dois sinalizadores, XFORMCOORDS_POSITION e XFORMCOORDS_SIZE, indicam se as coordenadas devem ser tratadas como uma posição ou um tamanho. Os dois restantes sinalizadores indicam a direção da transformação.

##  <a name="translatecolor"></a>  COleControl::TranslateColor

Converte um valor de cor do tipo de dados OLE_COLOR para o [COLORREF](/windows/desktop/gdi/colorref) tipo de dados.

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Parâmetros

*clrColor*<br/>
Um tipo de dados OLE_COLOR. Para obter mais informações, consulte o Windows [OleTranslateColor](/windows/desktop/api/olectl/nf-olectl-oletranslatecolor) função.

*hpal*<br/>
Um identificador para uma paleta opcional; pode ser NULL.

### <a name="return-value"></a>Valor de retorno

Um valor de cor de 32 bits RGB (vermelho, verde, azul) que define sólido de cor mais próxima para o *clrColor* valor que o dispositivo pode representar.

### <a name="remarks"></a>Comentários

Essa função é útil para converter as propriedades de cor de primeiro plano e BackColor estoque para COLORREF tipos usados pelo [CDC](../../mfc/reference/cdc-class.md) funções de membro.

##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad

Determina se o controle deve usar os valores das propriedades de ambiente como valores padrão, quando ele for subsequentemente carregado do estado persistente.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Valor de retorno

NonZero indica que as propriedades de ambiente será válidas. Caso contrário, propriedades de ambiente não será válidas.

### <a name="remarks"></a>Comentários

Em alguns contêineres, o controle pode não ter acesso a suas propriedades de ambientes durante a chamada inicial para a substituição do `COleControl::DoPropExchange`. Esse é o caso se o contêiner chama [IPersistStreamInit::Load](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-load) ou [IPersistStorage::Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load) antes de chamar [IOleObject::SetClientSite](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setclientsite) (ou seja, se não existir honra o bit de status OLEMISC_SETCLIENTSITEFIRST).

##  <a name="windowproc"></a>  COleControl::WindowProc

Fornece um procedimento do Windows para um `COleControl` objeto.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Parâmetros

*message*<br/>
Especifica a mensagem do Windows a serem processados.

*wParam*<br/>
Fornece informações adicionais usadas no processamento da mensagem. O valor do parâmetro depende da mensagem.

*lParam*<br/>
Fornece informações adicionais usadas no processamento da mensagem. O valor do parâmetro depende da mensagem.

### <a name="return-value"></a>Valor de retorno

O valor retornado da mensagem expedida.

### <a name="remarks"></a>Comentários

Chame essa função para expedir mensagens específicas por meio do mapa da mensagem do controle.

## <a name="see-also"></a>Consulte também

[CIRC3 de exemplo do MFC](../../overview/visual-cpp-samples.md)<br/>
[Exemplo MFC TESTHELP](../../overview/visual-cpp-samples.md)<br/>
[Classe COlePropertyPage](../../mfc/reference/colepropertypage-class.md)<br/>
[Classe CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Gráfico da hierarquia](../../mfc/hierarchy-chart.md)<br/>
[Classe CFontHolder](../../mfc/reference/cfontholder-class.md)<br/>
[Classe CPictureHolder](../../mfc/reference/cpictureholder-class.md)<br/>
