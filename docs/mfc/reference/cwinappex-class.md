---
title: Classe CWinAppEx
ms.date: 11/04/2016
f1_keywords:
- CWinAppEx
- AFXWINAPPEX/CWinAppEx
- AFXWINAPPEX/CWinAppEx::CWinAppEx
- AFXWINAPPEX/CWinAppEx::CleanState
- AFXWINAPPEX/CWinAppEx::EnableLoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::EnableTearOffMenus
- AFXWINAPPEX/CWinAppEx::EnableUserTools
- AFXWINAPPEX/CWinAppEx::ExitInstance
- AFXWINAPPEX/CWinAppEx::GetBinary
- AFXWINAPPEX/CWinAppEx::GetContextMenuManager
- AFXWINAPPEX/CWinAppEx::GetDataVersion
- AFXWINAPPEX/CWinAppEx::GetDataVersionMajor
- AFXWINAPPEX/CWinAppEx::GetDataVersionMinor
- AFXWINAPPEX/CWinAppEx::GetInt
- AFXWINAPPEX/CWinAppEx::GetKeyboardManager
- AFXWINAPPEX/CWinAppEx::GetMouseManager
- AFXWINAPPEX/CWinAppEx::GetObject
- AFXWINAPPEX/CWinAppEx::GetRegSectionPath
- AFXWINAPPEX/CWinAppEx::GetRegistryBase
- AFXWINAPPEX/CWinAppEx::GetSectionBinary
- AFXWINAPPEX/CWinAppEx::GetSectionInt
- AFXWINAPPEX/CWinAppEx::GetSectionObject
- AFXWINAPPEX/CWinAppEx::GetSectionString
- AFXWINAPPEX/CWinAppEx::GetShellManager
- AFXWINAPPEX/CWinAppEx::GetString
- AFXWINAPPEX/CWinAppEx::GetTooltipManager
- AFXWINAPPEX/CWinAppEx::GetUserToolsManager
- AFXWINAPPEX/CWinAppEx::InitContextMenuManager
- AFXWINAPPEX/CWinAppEx::InitKeyboardManager
- AFXWINAPPEX/CWinAppEx::InitMouseManager
- AFXWINAPPEX/CWinAppEx::InitShellManager
- AFXWINAPPEX/CWinAppEx::InitTooltipManager
- AFXWINAPPEX/CWinAppEx::IsResourceSmartUpdate
- AFXWINAPPEX/CWinAppEx::IsStateExists
- AFXWINAPPEX/CWinAppEx::LoadState
- AFXWINAPPEX/CWinAppEx::OnAppContextHelp
- AFXWINAPPEX/CWinAppEx::OnViewDoubleClick
- AFXWINAPPEX/CWinAppEx::OnWorkspaceIdle
- AFXWINAPPEX/CWinAppEx::SaveState
- AFXWINAPPEX/CWinAppEx::SetRegistryBase
- AFXWINAPPEX/CWinAppEx::ShowPopupMenu
- AFXWINAPPEX/CWinAppEx::WriteBinary
- AFXWINAPPEX/CWinAppEx::WriteInt
- AFXWINAPPEX/CWinAppEx::WriteObject
- AFXWINAPPEX/CWinAppEx::WriteSectionBinary
- AFXWINAPPEX/CWinAppEx::WriteSectionInt
- AFXWINAPPEX/CWinAppEx::WriteSectionObject
- AFXWINAPPEX/CWinAppEx::WriteSectionString
- AFXWINAPPEX/CWinAppEx::WriteString
- AFXWINAPPEX/CWinAppEx::LoadCustomState
- AFXWINAPPEX/CWinAppEx::LoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::OnClosingMainFrame
- AFXWINAPPEX/CWinAppEx::PreLoadState
- AFXWINAPPEX/CWinAppEx::PreSaveState
- AFXWINAPPEX/CWinAppEx::ReloadWindowPlacement
- AFXWINAPPEX/CWinAppEx::SaveCustomState
- AFXWINAPPEX/CWinAppEx::StoreWindowPlacement
- AFXWINAPPEX/CWinAppEx::m_bForceImageReset
helpviewer_keywords:
- CWinAppEx [MFC], CWinAppEx
- CWinAppEx [MFC], CleanState
- CWinAppEx [MFC], EnableLoadWindowPlacement
- CWinAppEx [MFC], EnableTearOffMenus
- CWinAppEx [MFC], EnableUserTools
- CWinAppEx [MFC], ExitInstance
- CWinAppEx [MFC], GetBinary
- CWinAppEx [MFC], GetContextMenuManager
- CWinAppEx [MFC], GetDataVersion
- CWinAppEx [MFC], GetDataVersionMajor
- CWinAppEx [MFC], GetDataVersionMinor
- CWinAppEx [MFC], GetInt
- CWinAppEx [MFC], GetKeyboardManager
- CWinAppEx [MFC], GetMouseManager
- CWinAppEx [MFC], GetObject
- CWinAppEx [MFC], GetRegSectionPath
- CWinAppEx [MFC], GetRegistryBase
- CWinAppEx [MFC], GetSectionBinary
- CWinAppEx [MFC], GetSectionInt
- CWinAppEx [MFC], GetSectionObject
- CWinAppEx [MFC], GetSectionString
- CWinAppEx [MFC], GetShellManager
- CWinAppEx [MFC], GetString
- CWinAppEx [MFC], GetTooltipManager
- CWinAppEx [MFC], GetUserToolsManager
- CWinAppEx [MFC], InitContextMenuManager
- CWinAppEx [MFC], InitKeyboardManager
- CWinAppEx [MFC], InitMouseManager
- CWinAppEx [MFC], InitShellManager
- CWinAppEx [MFC], InitTooltipManager
- CWinAppEx [MFC], IsResourceSmartUpdate
- CWinAppEx [MFC], IsStateExists
- CWinAppEx [MFC], LoadState
- CWinAppEx [MFC], OnAppContextHelp
- CWinAppEx [MFC], OnViewDoubleClick
- CWinAppEx [MFC], OnWorkspaceIdle
- CWinAppEx [MFC], SaveState
- CWinAppEx [MFC], SetRegistryBase
- CWinAppEx [MFC], ShowPopupMenu
- CWinAppEx [MFC], WriteBinary
- CWinAppEx [MFC], WriteInt
- CWinAppEx [MFC], WriteObject
- CWinAppEx [MFC], WriteSectionBinary
- CWinAppEx [MFC], WriteSectionInt
- CWinAppEx [MFC], WriteSectionObject
- CWinAppEx [MFC], WriteSectionString
- CWinAppEx [MFC], WriteString
- CWinAppEx [MFC], LoadCustomState
- CWinAppEx [MFC], LoadWindowPlacement
- CWinAppEx [MFC], OnClosingMainFrame
- CWinAppEx [MFC], PreLoadState
- CWinAppEx [MFC], PreSaveState
- CWinAppEx [MFC], ReloadWindowPlacement
- CWinAppEx [MFC], SaveCustomState
- CWinAppEx [MFC], StoreWindowPlacement
- CWinAppEx [MFC], m_bForceImageReset
ms.assetid: a3d3e053-3e22-463f-9444-c73abb1bb9d7
ms.openlocfilehash: c222567703d0e57480c00f6f2bf9e78f16979150
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "62323250"
---
# <a name="cwinappex-class"></a>Classe CWinAppEx

`CWinAppEx` Manipula o estado do aplicativo, salva o estado para o registro, carrega o estado do registro, inicializa gerentes de aplicativos e fornece links para esses mesmos gerentes de aplicativos.

   Para obter mais detalhes, consulte o código-fonte localizado na **VC\\atlmfc\\src\\mfc** pasta de instalação do Visual Studio.
## <a name="syntax"></a>Sintaxe

```
class CWinAppEx : public CWinApp
```

## <a name="members"></a>Membros

### <a name="public-constructors"></a>Construtores públicos

|Nome|Descrição|
|----------|-----------------|
|[CWinAppEx::CWinAppEx](#cwinappex)|Constrói um objeto `CWinAppEx`.|

### <a name="public-methods"></a>Métodos públicos

|Nome|Descrição|
|----------|-----------------|
|[CWinAppEx::CleanState](#cleanstate)|Remove informações sobre o aplicativo do registro do Windows.|
|[CWinAppEx::EnableLoadWindowPlacement](#enableloadwindowplacement)|Especifica se o aplicativo carregará o tamanho inicial e o local da janela do quadro principal do registro.|
|[CWinAppEx::EnableTearOffMenus](#enabletearoffmenus)|Habilita a tecla menus destacáveis para o aplicativo.|
|[CWinAppEx::EnableUserTools](#enableusertools)|Permite que o usuário crie comandos de menu personalizado no aplicativo.|
|[CWinAppEx::ExitInstance](#exitinstance)|Chamado pelo framework de dentro do `Run` a função de membro para sair dessa instância do aplicativo. (Substitui [CWinApp::ExitInstance](../../mfc/reference/cwinapp-class.md#exitinstance).)|
|[CWinAppEx::GetBinary](#getbinary)|Lê os dados binários que está associados com o valor do registro especificado.|
|[CWinAppEx::GetContextMenuManager](#getcontextmenumanager)|Retorna um ponteiro para o global [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) objeto.|
|[CWinAppEx::GetDataVersion](#getdataversion)||
|[CWinAppEx::GetDataVersionMajor](#getdataversionmajor)|Retorna a versão principal do aplicativo salva no registro do Windows.|
|[CWinAppEx::GetDataVersionMinor](#getdataversionminor)|Retorna a versão secundária do aplicativo salva no registro do Windows.|
|[CWinAppEx::GetInt](#getint)|Lê dados numéricos que está associados com o valor especificado do registro.|
|[CWinAppEx::GetKeyboardManager](#getkeyboardmanager)|Retorna um ponteiro para o global [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) objeto.|
|[CWinAppEx::GetMouseManager](#getmousemanager)|Retorna um ponteiro para o global [CMouseManager](../../mfc/reference/cmousemanager-class.md) objeto.|
|[CWinAppEx::GetObject](#getobject)|Lê `CObject`-derivados de dados que está associados com o valor especificado do registro.|
|[CWinAppEx::GetRegSectionPath](#getregsectionpath)|Retorna uma cadeia de caracteres que é o caminho de uma chave do registro. Esse caminho concatena o caminho relativo fornecido com o caminho do aplicativo.|
|[CWinAppEx::GetRegistryBase](#getregistrybase)|Retorna o caminho do registro para o aplicativo.|
|[CWinAppEx::GetSectionBinary](#getsectionbinary)|Lê os dados binários que está associados com a chave especificada e o valor do registro.|
|[CWinAppEx::GetSectionInt](#getsectionint)|Lê dados numéricos do registro associado com a chave especificada e o valor.|
|[CWinAppEx::GetSectionObject](#getsectionobject)|Lê `CObject` dados que está associados com a chave especificada e o valor do registro.|
|[CWinAppEx::GetSectionString](#getsectionstring)|Lê dados de cadeia de caracteres que está associados com a chave especificada e o valor do registro.|
|[CWinAppEx::GetShellManager](#getshellmanager)|Retorna um ponteiro para o global [CShellManager](../../mfc/reference/cshellmanager-class.md) objeto.|
|[CWinAppEx::GetString](#getstring)|Lê dados de cadeia de caracteres que está associados com o valor especificado do registro.|
|[CWinAppEx::GetTooltipManager](#gettooltipmanager)|Retorna um ponteiro para o global [CTooltipManager](../../mfc/reference/ctooltipmanager-class.md) objeto.|
|[CWinAppEx::GetUserToolsManager](#getusertoolsmanager)|Retorna um ponteiro para o global [CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md) objeto.|
|[CWinAppEx::InitContextMenuManager](#initcontextmenumanager)|Inicializa o objeto `CContextMenuManager`.|
|[CWinAppEx::InitKeyboardManager](#initkeyboardmanager)|Inicializa o objeto `CKeyboardManager`.|
|[CWinAppEx::InitMouseManager](#initmousemanager)|Inicializa o objeto `CMouseManager`.|
|[CWinAppEx::InitShellManager](#initshellmanager)|Inicializa o `CShellManager` classe|
|[CWinAppEx::InitTooltipManager](#inittooltipmanager)|Inicializa a classe `CTooltipManager`.|
|[CWinAppEx::IsResourceSmartUpdate](#isresourcesmartupdate)||
|[CWinAppEx::IsStateExists](#isstateexists)|Indica se a chave especificada está no registro.|
|[CWinAppEx::LoadState](#loadstate)|Carrega o estado do aplicativo do registro.|
|[CWinAppEx::OnAppContextHelp](#onappcontexthelp)|Chamado pelo framework quando o usuário solicita ajuda de contexto para o **personalização** caixa de diálogo.|
|[CWinAppEx::OnViewDoubleClick](#onviewdoubleclick)|Chama o comando definido pelo usuário quando o usuário clica duas vezes em qualquer lugar no aplicativo.|
|[CWinAppEx::OnWorkspaceIdle](#onworkspaceidle)||
|[CWinAppEx::SaveState](#savestate)|Grava o estado da estrutura de aplicativo no registro do Windows.|
|[CWinAppEx::SetRegistryBase](#setregistrybase)|Define o caminho da chave do registro padrão. Essa chave servirá como uma raiz para todas as chamadas subsequentes de registro.|
|[CWinAppEx::ShowPopupMenu](#showpopupmenu)|Exibe um menu pop-up.|
|[CWinAppEx::WriteBinary](#writebinary)|Grava os dados binários para o valor do Registro especificada.|
|[CWinAppEx::WriteInt](#writeint)|Grava os dados numéricos para o valor do Registro especificada.|
|[CWinAppEx::WriteObject](#writeobject)|Grava os dados que são derivados de [classe CObject](../../mfc/reference/cobject-class.md) ao valor do registro especificado.|
|[CWinAppEx::WriteSectionBinary](#writesectionbinary)|Grava os dados binários como um valor de chave do Registro especificada.|
|[CWinAppEx::WriteSectionInt](#writesectionint)|Grava os dados numéricos em um valor de chave do Registro especificada.|
|[CWinAppEx::WriteSectionObject](#writesectionobject)|Grava dados provenientes de `CObject` classe como um valor de chave do Registro especificada.|
|[CWinAppEx::WriteSectionString](#writesectionstring)|Grava os dados de cadeia de caracteres em um valor de chave do Registro especificada.|
|[CWinAppEx::WriteString](#writestring)|Grava os dados de cadeia de caracteres para o valor do Registro especificada.|

### <a name="protected-methods"></a>Métodos Protegidos

|Nome|Descrição|
|----------|-----------------|
|[CWinAppEx::LoadCustomState](#loadcustomstate)|Chamado pelo framework quando o estado do aplicativo foi carregado.|
|[CWinAppEx::LoadWindowPlacement](#loadwindowplacement)|Chamado pelo framework quando ele carrega o tamanho e local do seu aplicativo do registro. Os dados carregados incluem o tamanho e local do quadro principal no momento em que seu aplicativo é fechado pela última vez.|
|[CWinAppEx::OnClosingMainFrame](#onclosingmainframe)|Chamado pelo framework quando uma janela de quadro principal está processando WM_CLOSE.|
|[CWinAppEx::PreLoadState](#preloadstate)|Chamado pelo framework imediatamente antes o estado do aplicativo é carregado.|
|[CWinAppEx::PreSaveState](#presavestate)|Chamado pelo framework imediatamente antes o estado do aplicativo é salvo.|
|[CWinAppEx::ReloadWindowPlacement](#reloadwindowplacement)|Recarrega o tamanho e local da janela fornecida a partir do registro|
|[CWinAppEx::SaveCustomState](#savecustomstate)|Chamado pelo framework depois que ele grava o estado do aplicativo no registro.|
|[CWinAppEx::StoreWindowPlacement](#storewindowplacement)|Chamado pelo framework para gravar o tamanho e local do quadro principal no registro.|

### <a name="data-members"></a>Membros de Dados

|Nome|Descrição|
|----------|-----------------|
|[CWinAppEx::m_bForceImageReset](#m_bforceimagereset)|Especifica se o framework redefinirá todas as imagens da barra de ferramentas quando a janela do quadro que contém a barra de ferramentas é carregada.|

## <a name="remarks"></a>Comentários

Depende muito da funcionalidade fornecida pela estrutura MFC a `CWinAppEx` classe. Você pode incorporar o `CWinAppEx` classe em seu aplicativo em uma das duas maneiras:

- Construir um `CWinAppEx` classe no thread principal.

- Derive a classe principal do aplicativo do `CWinAppEx`.

Depois que você incorporar `CWinAppEx` em seu aplicativo, você pode inicializar qualquer um dos gerenciadores de aplicativo. Antes de usar um Gerenciador de aplicativos, você deve inicializá-lo chamando o método initialize apropriado. Para obter um ponteiro para um determinado gerente, chame o método get associado. O `CWinAppEx` classe gerencia os seguintes gerenciadores de aplicativo: [Classe CMouseManager](../../mfc/reference/cmousemanager-class.md), [classe CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md), [classe CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md), [classe CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md), e [ Classe CMenuTearOffManager](../../mfc/reference/cmenutearoffmanager-class.md).

## <a name="inheritance-hierarchy"></a>Hierarquia de herança

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWinThread](../../mfc/reference/cwinthread-class.md)

[CWinApp](../../mfc/reference/cwinapp-class.md)

[CWinAppEx](../../mfc/reference/cwinappex-class.md)

## <a name="requirements"></a>Requisitos

**Cabeçalho:** afxwinappex.h

##  <a name="cleanstate"></a>  CWinAppEx::CleanState

Remove todas as informações sobre o aplicativo do registro do Windows.

```
virtual BOOL CleanState(LPCTSTR lpszSectionName=NULL);
```

### <a name="parameters"></a>Parâmetros

*lpszSectionName*<br/>
[in] Uma cadeia de caracteres que contém um caminho de uma chave do registro.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o método foi bem-sucedida; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Esse método limpa os dados de aplicativo de uma seção específica do registro. Você pode especificar a seção limpar usando o parâmetro *lpszSectionName*. Se *lpszSectionName* for NULL, esse método usará o caminho do registro padrão armazenado em do `CWinAppEx` objeto. Para obter o caminho do registro padrão, use [CWinAppEx::GetRegistryBase](#getregistrybase).

##  <a name="cwinappex"></a>  CWinAppEx::CWinAppEx

Constrói um objeto `CWinAppEx`.

```
CWinAppEx(BOOL bResourceSmartUpdate = FALSE);
```

### <a name="parameters"></a>Parâmetros

*bResourceSmartUpdate*<br/>
[in] Um parâmetro booliano que especifica se o objeto de espaço de trabalho deve detectar e lidar com atualizações de recursos.

### <a name="remarks"></a>Comentários

O `CWinAppEx` classe tem os métodos de inicialização, fornece a funcionalidade para salvar e carregar informações do aplicativo no registro e controla as configurações de aplicativo global. Ele também permite que você use gerenciadores globais, como o [classe CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) e o [classe CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md). Cada aplicativo pode ter apenas uma instância da `CWinAppEx` classe.

##  <a name="enableloadwindowplacement"></a>  CWinAppEx::EnableLoadWindowPlacement

Especifica se o aplicativo carregará o tamanho inicial e o local da janela do quadro principal do registro.

```
void EnableLoadWindowPlacement(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Parâmetros

*bEnable*<br/>
[in] Especifica se o aplicativo carrega o tamanho inicial e o local da janela do quadro principal do registro.

### <a name="remarks"></a>Comentários

Por padrão, o tamanho e local do quadro principal é carregado do registro junto com outras configurações de aplicativo. Isso ocorre durante [CWinAppEx::LoadState](#loadstate). Se você não deseja carregar o posicionamento de janela inicial do registro, chamar esse método com *bAtivar* definido como FALSE.

##  <a name="enabletearoffmenus"></a>  CWinAppEx::EnableTearOffMenus

Cria e inicializa um [CMenuTearOffManager](../../mfc/reference/cmenutearoffmanager-class.md) objeto.

```
BOOL EnableTearOffMenus(
    LPCTSTR lpszRegEntry,
    const UINT uiCmdFirst,
    const UINT uiCmdLast);
```

### <a name="parameters"></a>Parâmetros

*lpszRegEntry*<br/>
[in] Uma cadeia de caracteres que contém o caminho de uma chave do registro. O aplicativo usa essa chave do registro para armazenar informações para os menus destacáveis.

*uiCmdFirst*<br/>
[in] ID do menu separar primeiro.

*uiCmdLast*<br/>
[in] O menu de separar última ID.

### <a name="return-value"></a>Valor de retorno

TRUE se o `CMenuTearOffManager` é criado e inicializado com êxito; FALSO se ocorrer um erro ou se o `CMenuTearOffManager` já existe.

### <a name="remarks"></a>Comentários

Use essa função para habilitar menus destacáveis em seu aplicativo. Você deve chamar essa função de `InitInstance`.

##  <a name="enableusertools"></a>  CWinAppEx::EnableUserTools

Permite que o usuário crie comandos de menu personalizados que reduzem os pressionamentos de tecla em seu aplicativo. Esse método cria uma [CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md) objeto.

```
BOOL EnableUserTools(
    const UINT uiCmdToolsDummy,
    const UINT uiCmdFirst,
    const UINT uiCmdLast,
    CRuntimeClass* pToolRTC = RUNTIME_CLASS(CUserTool),
    UINT uArgMenuID = 0,
    UINT uInitDirMenuID = 0);
```

### <a name="parameters"></a>Parâmetros

*uiCmdToolsDummy*<br/>
[in] Um inteiro sem sinal de que a estrutura usa como um espaço reservado para a ID de comando do menu de ferramentas do usuário.

*uiCmdFirst*<br/>
[in] A ID de comando para o primeiro comando de ferramenta do usuário.

*uiCmdLast*<br/>
[in] A ID de comando para o último comando de ferramenta do usuário.

*pToolRTC*<br/>
[in] A classe que o `CUserToolsManager` usa o objeto para criar novas ferramentas de usuário.

*uArgMenuID*<br/>
[in] A ID do menu de argumento.

*uInitDirMenuID*<br/>
[in] A ID de menu para o diretório da ferramenta inicial.

### <a name="return-value"></a>Valor de retorno

TRUE se o método cria e inicializa um `CUserToolsManager` do objeto; FALSE se o método falhar ou se um `CUserToolsManager` objeto já existe.

### <a name="remarks"></a>Comentários

Quando você habilita ferramentas definidas pelo usuário, a estrutura automaticamente dá suporte a um menu dinâmico que pode ser estendido durante a personalização. O framework associa cada novo item com um comando externo. O framework invoca esses comandos, quando o usuário seleciona o item apropriado do **ferramentas** menu.

Sempre que o usuário adiciona um novo item, o framework cria um novo objeto. O tipo de classe para o novo objeto é definido por *pToolRTC*. O *pToolRTC* tipo de classe deve ser derivado de [classe CUserTool](../../mfc/reference/cusertool-class.md).

Para obter mais informações sobre ferramentas de usuário e como incorporá-las em seu aplicativo, consulte [ferramentas definidas pelo usuário](../../mfc/user-defined-tools.md).

##  <a name="exitinstance"></a>  CWinAppEx::ExitInstance

```
virtual int ExitInstance();
```

### <a name="return-value"></a>Valor de retorno

### <a name="remarks"></a>Comentários

##  <a name="getbinary"></a>  CWinAppEx::GetBinary

Lê dados binários de uma chave do Registro especificada.

```
BOOL GetBinary(
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>Parâmetros

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o nome de uma chave do registro.

*ppData*<br/>
[out] Um ponteiro para o buffer que o método preenche com os dados binários.

*pBytes*<br/>
[out] Um ponteiro para um inteiro sem sinal que o método usa para gravar o número de bytes lidos.

### <a name="return-value"></a>Valor de retorno

VERDADEIRO se bem-sucedido; FALSE caso contrário.

### <a name="remarks"></a>Comentários

Esse método lê os dados binários gravados no registro. Para gravar dados no registro, use os métodos [CWinAppEx::WriteBinary](#writebinary) e [CWinAppEx::WriteSectionBinary](#writesectionbinary).

O *lpszEntry* parâmetro é o nome de uma entrada de registro localizado sob a chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getcontextmenumanager"></a>  CWinAppEx::GetContextMenuManager

Retorna um ponteiro para o global [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) objeto.

```
CContextMenuManager* GetContextMenuManager();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para o global `CContextMenuManager` objeto.

### <a name="remarks"></a>Comentários

Se o objeto CContextMenuManager não for inicializado, essa função chamará [CWinAppEx::InitContextMenuManager](#initcontextmenumanager) antes de retornar um ponteiro.

##  <a name="getdataversion"></a>  CWinAppEx::GetDataVersion

```
int GetDataVersion() const;
```

### <a name="return-value"></a>Valor de retorno

### <a name="remarks"></a>Comentários

##  <a name="getdataversionmajor"></a>  CWinAppEx::GetDataVersionMajor

Retorna a versão principal do aplicativo que é salva no registro do Windows quando você chama [CWinAppEx::SaveState](#savestate).

```
int GetDataVersionMajor() const;
```

### <a name="return-value"></a>Valor de retorno

Um valor inteiro que contém o número de versão principal.

##  <a name="getdataversionminor"></a>  CWinAppEx::GetDataVersionMinor

Retorna a versão secundária do aplicativo que é salva no registro do Windows quando você chama [CWinAppEx::SaveState](#savestate).

```
int GetDataVersionMinor() const;
```

### <a name="return-value"></a>Valor de retorno

Um valor inteiro que contém o número de versão secundária.

##  <a name="getint"></a>  CWinAppEx::GetInt

Lê dados de inteiro de uma chave do Registro especificada.

```
int GetInt(
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>Parâmetros

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o nome de uma entrada de registro.

*nDefault*<br/>
[in] O valor padrão que o método retorna, se a entrada do Registro especificada não existe.

### <a name="return-value"></a>Valor de retorno

Os dados do registro se o método foi bem-sucedida; Caso contrário, *nConfiguração padrão*.

### <a name="remarks"></a>Comentários

Esse método lê dados de inteiro do registro. Se não há nenhum dado de inteiro associado com a chave de registro indicada por *lpszEntry*, esse método retornará *nConfiguração padrão*. Para gravar dados no registro, use os métodos [CWinAppEx::WriteSectionInt](#writesectionint) e [CWinAppEx::WriteInt](#writeint).

O *lpszEntry* parâmetro é o nome de uma entrada de registro localizado sob a chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getkeyboardmanager"></a>  CWinAppEx::GetKeyboardManager

Retorna um ponteiro para o global [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) objeto.

```
CKeyboardManager* GetKeyboardManager();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para o global `CKeyboardManager` objeto.

### <a name="remarks"></a>Comentários

Se o Gerenciador de teclado não é inicializado, essa função chama [CWinAppEx::InitKeyboardManager](#initkeyboardmanager) antes de retornar um ponteiro.

##  <a name="getmousemanager"></a>  CWinAppEx::GetMouseManager

Retorna um ponteiro para o global [CMouseManager](../../mfc/reference/cmousemanager-class.md) objeto.

```
CMouseManager* GetMouseManager();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para o global `CMouseManager` objeto.

### <a name="remarks"></a>Comentários

Se o Gerenciador de mouse não foi inicializado, essa função chamará [CWinAppEx::InitMouseManager](#initmousemanager) antes de retornar um ponteiro.

##  <a name="getobject"></a>  CWinAppEx::GetObject

Lê [CObject](../../mfc/reference/cobject-class.md)- derivado dados do registro.

```
BOOL GetObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parâmetros

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o caminho relativo de uma entrada de registro.

*obj*<br/>
[out] Uma referência a um `CObject`. O método usa essa referência para armazenar os dados do registro.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o método foi bem-sucedida; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Esse método lê dados do registro que é derivado de `CObject`. Para gravar `CObject` dados no registro, use [CWinAppEx::WriteObject](#writeobject) ou [CWinAppEx::WriteSectionObject](#writesectionobject).

O *lpszEntry* parâmetro é o nome de uma entrada de registro que está localizado sob a chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getregistrybase"></a>  CWinAppEx::GetRegistryBase

Recupera o caminho do registro padrão para o aplicativo.

```
LPCTSTR GetRegistryBase();
```

### <a name="return-value"></a>Valor de retorno

Uma cadeia de caracteres que contém o caminho do local padrão do registro.

### <a name="remarks"></a>Comentários

Todos os métodos de [classe CWinAppEx](../../mfc/reference/cwinappex-class.md) que acessam o início do registro em um local padrão. Use esse método para recuperar um caminho do local padrão do registro. Use [CWinAppEx::SetRegistryBase](#setregistrybase) para alterar o local de registro padrão.

##  <a name="getregsectionpath"></a>  CWinAppEx::GetRegSectionPath

Cria e retorna o caminho absoluto de uma chave do registro.

```
CString GetRegSectionPath(LPCTSTR szSectionAdd = _T(""));
```

### <a name="parameters"></a>Parâmetros

*szSectionAdd*<br/>
[in] Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

### <a name="return-value"></a>Valor de retorno

Um `CString` que contém o caminho absoluto de uma chave do registro.

### <a name="remarks"></a>Comentários

Este método define o caminho absoluto da chave do registro, acrescentando o caminho relativo no *szSectionAdd* até o local do registro padrão para seu aplicativo. Para obter a chave do registro padrão, use o método [CWinAppEx::GetRegistryBase](#getregistrybase).

##  <a name="getsectionbinary"></a>  CWinAppEx::GetSectionBinary

Lê os dados binários do registro.

```
BOOL GetSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>Parâmetros

*lpszSubSection*<br/>
[in] Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o valor a ser lido.

*ppData*<br/>
[out] Um ponteiro para o buffer no qual o método armazena os dados.

*pBytes*<br/>
[out] Um ponteiro para um inteiro sem sinal. O método grava o tamanho de *ppData* para esse parâmetro.

### <a name="return-value"></a>Valor de retorno

VERDADEIRO se bem-sucedido; Caso contrário, FALSE.

### <a name="remarks"></a>Comentários

Esse método lê dados binários que são gravados no registro usando os métodos [CWinAppEx::WriteBinary](#writebinary) e [CWinAppEx::WriteSectionBinary](#writesectionbinary).

O *lpszSubSection* parâmetro não é um caminho absoluto para uma entrada de registro. É um caminho relativo que é acrescentado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getsectionint"></a>  CWinAppEx::GetSectionInt

Lê dados de inteiro do registro.

```
int GetSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>Parâmetros

*lpszSubSection*<br/>
[in] Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o valor a ser lido.

*nDefault*<br/>
[in] O valor padrão para retornar se o valor especificado não existe.

### <a name="return-value"></a>Valor de retorno

Os dados de inteiro que são armazenados no valor do registro especificado; *nConfiguração padrão* se os dados não existe.

### <a name="remarks"></a>Comentários

Use os métodos [CWinAppEx::WriteInt](#writeint) e [CWinAppEx::WriteSectionInt](#writesectionint) para gravar dados de inteiro para o registro.

O *lpszSubSection* parâmetro não é um caminho absoluto de uma entrada de registro. É um caminho relativo que é adicionado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getsectionobject"></a>  CWinAppEx::GetSectionObject

Lê [CObject](../../mfc/reference/cobject-class.md) dados de registro do registro.

```
BOOL GetSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parâmetros

*lpszSubSection*<br/>
[in] Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o valor a ser lido.

*obj*<br/>
[out] Uma referência a um `CObject`. O método usa esse `CObject` para armazenar os dados do registro.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se bem-sucedido; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Esse método lê dados de registro. Os dados de leitura está `CObject` dados ou dados de uma classe derivada de `CObject`. Para gravar `CObject` dados no registro, use [CWinAppEx::WriteObject](#writeobject) ou [CWinAppEx::WriteSectionObject](#writesectionobject).

O *lpszSubSection* parâmetro não é um caminho absoluto para uma entrada de registro. É um caminho relativo que é acrescentado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getsectionstring"></a>  CWinAppEx::GetSectionString

Leituras de dados do registro de cadeia de caracteres.

```
CString GetSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszDefault = _T(""));
```

### <a name="parameters"></a>Parâmetros

*lpszSubSection*<br/>
[in] Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o valor a ser lido.

*lpszDefault*<br/>
[in] O valor padrão para retornar se o valor especificado não existe.

### <a name="return-value"></a>Valor de retorno

Os dados de cadeia de caracteres armazenados no valor do Registro especificada se os dados existem. Caso contrário, *lpszDefault*.

### <a name="remarks"></a>Comentários

Esse método lê dados de cadeia de caracteres gravados no registro. Use [CWinAppEx::WriteString](#writestring) e [CWinAppEx::WriteSectionString](#writesectionstring) para gravar dados de cadeia de caracteres no registro.

O *lpszSubSection* parâmetro não é um caminho absoluto para uma entrada de registro. É um caminho relativo que é acrescentado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="getshellmanager"></a>  CWinAppEx::GetShellManager

Retorna um ponteiro para o global [CShellManager](../../mfc/reference/cshellmanager-class.md) objeto.

```
CShellManager* GetShellManager();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para o global `CShellManager` objeto.

### <a name="remarks"></a>Comentários

Se o `CShellManager` objeto não é inicializado, essa função chama [CWinAppEx::InitShellManager](#initshellmanager) antes de retornar um ponteiro.

##  <a name="getstring"></a>  CWinAppEx::GetString

Lê dados de uma chave do Registro especificada da cadeia de caracteres.

```
CString GetString(
    LPCTSTR lpszEntry,
    LPCTSTR lpzDefault= _T(""));
```

### <a name="parameters"></a>Parâmetros

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o nome de uma chave do registro

*lpzDefault*<br/>
[in] O valor padrão que o método retorna, se a entrada do Registro especificada não existe.

### <a name="return-value"></a>Valor de retorno

Os dados de cadeia de caracteres armazenados no registro se bem-sucedido; *lpszDefault* caso contrário.

### <a name="remarks"></a>Comentários

Esse método lê dados de cadeia de caracteres gravados no registro. Para gravar dados no registro, use os métodos [CWinAppEx::WriteString](#writestring) ou [CWinAppEx::WriteSectionString](#writesectionstring).

O *lpszEntry* parâmetro é o nome de uma entrada de registro localizado sob a chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="gettooltipmanager"></a>  CWinAppEx::GetTooltipManager

Retorna um ponteiro para o global [CTooltipManager](../../mfc/reference/ctooltipmanager-class.md) objeto.

```
CTooltipManager* GetTooltipManager();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para o global `CTooltipManager` objeto.

### <a name="remarks"></a>Comentários

Se o `CTooltipManager` objeto não é inicializado, essa função chama [CWinAppEx::InitTooltipManager](#inittooltipmanager) antes de retornar um ponteiro.

##  <a name="getusertoolsmanager"></a>  CWinAppEx::GetUserToolsManager

Retorna um ponteiro para o global [CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md) objeto.

```
CUserToolsManager* GetUserToolsManager();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para o global `CUserToolsManager` do objeto; NULL se o usuário das ferramentas de gerenciamento não está habilitado para o aplicativo.

### <a name="remarks"></a>Comentários

Antes de recuperar um ponteiro para o `CUserToolsManager` do objeto, você deve inicializar o Gerenciador de chamando [CWinAppEx::EnableUserTools](#enableusertools).

##  <a name="initcontextmenumanager"></a>  CWinAppEx::InitContextMenuManager

Inicializa o [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) objeto.

```
BOOL InitContextMenuManager();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o método cria o objeto CContextMenuManager; 0 se o `CContextMenuManager` objeto já existe.

### <a name="remarks"></a>Comentários

Se você chamar [CWinAppEx::GetContextMenuManager](#getcontextmenumanager), a implementação padrão desse método chama `InitContextMenuManager`.

Se seu aplicativo já tem um Gerenciador de menu de contexto e chamar `InitContextMenuManager`, seu aplicativo terá uma [ASSERT](diagnostic-services.md#assert) falha. Portanto, você não deve chamar `InitContextMenuManager` se você criar um `CContextMenuManager` diretamente do objeto. Se você não estiver usando um personalizado `CContextMenuManager`, você deve usar `GetContextMenuManager` para criar um `CContextMenuManager` objeto.

##  <a name="initkeyboardmanager"></a>  CWinAppEx::InitKeyboardManager

Inicializa o [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) objeto.

```
BOOL InitKeyboardManager();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o método cria o `CKeyboardManager` objeto; 0 se o `CKeyboardManager` objeto já existe.

### <a name="remarks"></a>Comentários

Se você chamar [CWinAppEx::GetKeyboardManager](#getkeyboardmanager), a implementação padrão desse método chama `InitKeyboardManager`.

Se seu aplicativo já tem um Gerenciador de teclado e chamar `InitKeyboardManager`, seu aplicativo terá uma [ASSERT](diagnostic-services.md#assert) falha. Portanto, você não deve chamar `InitKeyboardManager` se você criar um `CKeyboardManager` diretamente do objeto. Se você não estiver usando um personalizado `CKeyboardManager`, você deve usar `GetKeyboardManager` para criar um `CKeyboardManager` objeto.

##  <a name="initmousemanager"></a>  CWinAppEx::InitMouseManager

Inicializa o [CMouseManager](../../mfc/reference/cmousemanager-class.md) objeto.

```
BOOL InitMouseManager();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o método cria o `CMouseManager` objeto; 0 se o `CMouseManager` objeto já existe.

### <a name="remarks"></a>Comentários

Se você chamar [CWinAppEx::GetMouseManager](#getmousemanager), a implementação padrão desse método chama `InitMouseManager`.

Se seu aplicativo já tem um Gerenciador de mouse e chamar `InitMouseManager`, seu aplicativo terá uma [ASSERT](diagnostic-services.md#assert) falha. Portanto, você não deve chamar `InitMouseManager` se você criar um `CMouseManager` diretamente do objeto. Se você não estiver usando um personalizado `CMouseManager`, você deve usar `GetMouseManager` para criar um `CMouseManager` objeto.

##  <a name="initshellmanager"></a>  CWinAppEx::InitShellManager

Inicializa o [CShellManager](../../mfc/reference/cshellmanager-class.md) objeto.

```
BOOL InitShellManager();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o método cria o `CShellManager` objeto; 0 se o `CShellManager` objeto já existe.

### <a name="remarks"></a>Comentários

Se você chamar [CWinAppEx::GetShellManager](#getshellmanager), a implementação padrão desse método chama `InitShellManager`.

Se seu aplicativo já tem um Gerenciador de shell e chamar `InitShellManager`, seu aplicativo gera uma [ASSERT](diagnostic-services.md#assert) falha. Portanto, não chame `InitShellManager` se você criar um `CShellManager` diretamente do objeto. Se você não estiver usando um personalizado `CShellManager`, use `GetShellManager` para criar um `CShellManager` objeto.

##  <a name="inittooltipmanager"></a>  CWinAppEx::InitTooltipManager

Inicializa o [CTooltipManager](../../mfc/reference/ctooltipmanager-class.md) objeto.

```
BOOL InitTooltipManager();
```

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o método cria o `CTooltipManager` objeto; 0 se o `CTooltipManager` objeto já existe.

### <a name="remarks"></a>Comentários

Se você chamar [CWinAppEx::GetTooltipManager](#gettooltipmanager), a implementação padrão desse método chama `InitTooltipManager`.

Se seu aplicativo já tem um Gerenciador de dica de ferramenta e chamar `InitTooltipManager`, seu aplicativo terá uma [ASSERT](diagnostic-services.md#assert) falha. Portanto, você não deve chamar `InitTooltipManager` se você criar um `CTooltipManager` diretamente do objeto. Se você não estiver usando um personalizado `CTooltipManager`, você deve usar `GetTooltipManager` para criar um `CTooltipManager` objeto.

##  <a name="isresourcesmartupdate"></a>  CWinAppEx::IsResourceSmartUpdate

```
BOOL IsResourceSmartUpdate() const;
```

### <a name="return-value"></a>Valor de retorno

### <a name="remarks"></a>Comentários

##  <a name="isstateexists"></a>  CWinAppEx::IsStateExists

Indica se a chave especificada está no registro.

```
BOOL IsStateExists(LPCTSTR lpszSectionName);
```

### <a name="parameters"></a>Parâmetros

*lpszSectionName*<br/>
[in] Uma cadeia de caracteres que contém um caminho de uma chave do registro.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se a chave está no registro. Caso contrário, 0.

##  <a name="loadcustomstate"></a>  CWinAppEx::LoadCustomState

O framework chama esse método depois que ele carrega o estado do aplicativo do registro.

```
virtual void LoadCustomState();
```

### <a name="remarks"></a>Comentários

Substitua este método se você quiser fazer qualquer processamento depois que o aplicativo carrega o estado do registro. Por padrão, esse método não fará nada.

Para carregar informações de estado personalizadas do registro, as informações devem ser salvo pela primeira vez usando [CWinAppEx::SaveCustomState](#savecustomstate).

##  <a name="loadstate"></a>  CWinAppEx::LoadState

Lê o estado do aplicativo de registro do Windows.

```
BOOL LoadState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

virtual BOOL LoadState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);
```

### <a name="parameters"></a>Parâmetros

*pFrame*<br/>
[in] Um ponteiro para um objeto de janela do quadro. O método aplica-se as informações de estado no registro para essa janela do quadro.

*lpszSectionName*<br/>
[in] Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

*pFrameImpl*<br/>
[in] Um ponteiro para um `CFrameImpl` objeto. O método aplica-se as informações de estado no registro para essa janela do quadro.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se bem-sucedido; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Esse método carrega o estado do aplicativo e quaisquer informações de estado para uma janela do quadro. As informações carregadas para a janela do quadro são aplicadas para a janela do quadro fornecido. Se você não fornecer uma janela de quadro, somente as informações de estado do aplicativo são carregadas. As informações do aplicativo incluem o estado do [classe CMouseManager](../../mfc/reference/cmousemanager-class.md), [classe CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md), [classe CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)e o [ Classe CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md).

A implementação padrão de `CFrameImpl::OnLoadFrame` chamadas `LoadState`.

O *lpszSectionName* parâmetro não é o caminho absoluto para uma entrada de registro. É um caminho relativo que é adicionado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="loadwindowplacement"></a>  CWinAppEx::LoadWindowPlacement

Chamado pelo framework quando ele carrega o tamanho e local da janela do quadro principal do registro.

```
virtual BOOL LoadWindowPlacement(
    CRect& rectNormalPosition,
    int& nFlags,
    int& nShowCmd);
```

### <a name="parameters"></a>Parâmetros

*rectNormalPosition*<br/>
[out] Um retângulo que contém as coordenadas da janela do quadro principal quando ele está na posição restaurada.

*nFlags*<br/>
[out] Sinalizadores que controlam a posição da janela minimizada e como o sistema operacional alterna entre uma janela minimizada e uma janela restaurada.

*nShowCmd*<br/>
[out] Um inteiro que especifica o estado de Mostrar da janela. Para obter mais informações sobre os valores possíveis, consulte [CWnd::ShowWindow](../../mfc/reference/cwnd-class.md#showwindow).

### <a name="return-value"></a>Valor de retorno

Diferente de zero se bem-sucedido; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Por padrão, MFC carregará automaticamente a posição anterior e o estado da janela do quadro principal quando o aplicativo é iniciado. Para obter mais informações sobre como essas informações são armazenadas no registro, consulte [CWinAppEx::StoreWindowPlacement](#storewindowplacement).

Substitua este método se você deseja carregar informações adicionais sobre a janela do quadro principal.

##  <a name="m_bforceimagereset"></a>  CWinAppEx::m_bForceImageReset

Especifica se o framework redefine todas as imagens da barra de ferramentas quando é recarregado a janela do quadro que contém a barra de ferramentas.

```
BOOL m_bForceImageReset;
```

### <a name="remarks"></a>Comentários

O `m_bForceImageReset` membro de dados é uma variável protegida.

##  <a name="onappcontexthelp"></a>  CWinAppEx::OnAppContextHelp

O framework chama esse método quando o usuário solicita ajuda de contexto para o **personalização** caixa de diálogo.

```
virtual void OnAppContextHelp(
    CWnd* pWndControl,
    const DWORD dwHelpIDArray[]);
```

### <a name="parameters"></a>Parâmetros

*pWndControl*<br/>
[in] Um ponteiro para um objeto de janela para o qual o usuário acionasse ajuda de contexto.

*dwHelpIDArray[]*<br/>
[in] Um valor reservado.

### <a name="remarks"></a>Comentários

Atualmente, esse método é reservado para uso futuro. A implementação padrão não faz nada e ele atualmente não é chamado pelo framework.

##  <a name="onclosingmainframe"></a>  CWinAppEx::OnClosingMainFrame

O framework chama esse método quando uma janela de quadro está processando WM_CLOSE.

```
virtual void OnClosingMainFrame(CFrameImpl* pFrameImpl);
```

### <a name="parameters"></a>Parâmetros

*pFrameImpl*<br/>
[in] Um ponteiro para um `CFrameImpl` objeto.

### <a name="remarks"></a>Comentários

A implementação padrão desse método salva o estado da *pFrameImpl*.

##  <a name="onviewdoubleclick"></a>  CWinAppEx::OnViewDoubleClick

Chama o comando definido pelo usuário que está associado um modo de exibição quando o usuário clica duas vezes em qualquer lugar dentro dessa exibição.

```
virtual BOOL OnViewDoubleClick(
    CWnd* pWnd,
    int iViewId);
```

### <a name="parameters"></a>Parâmetros

*pWnd*<br/>
[in] Um ponteiro para um objeto derivado de [classe CView](../../mfc/reference/cview-class.md).

*iViewId*<br/>
[in] A ID do modo de exibição.

### <a name="return-value"></a>Valor de retorno

TRUE se o framework encontra um comando; Caso contrário, FALSE.

### <a name="remarks"></a>Comentários

Para dar suporte ao comportamento de mouse personalizado, você deve chamar essa função ao processar a mensagem WM_LBUTTONDBLCLK. Esse método executa o comando associado com a ID de exibição fornecida pelo *iViewId*. Para obter mais informações sobre o comportamento de mouse personalizado, consulte [personalização de teclado e Mouse](../../mfc/keyboard-and-mouse-customization.md).

##  <a name="onworkspaceidle"></a>  CWinAppEx::OnWorkspaceIdle

```
virtual BOOL OnWorkspaceIdle(CWnd*);
```

### <a name="parameters"></a>Parâmetros

[in] *CWnd&#38;*<br/>

### <a name="return-value"></a>Valor de retorno

### <a name="remarks"></a>Comentários

##  <a name="preloadstate"></a>  CWinAppEx::PreLoadState

O framework chama esse método imediatamente antes que ele carrega o estado do aplicativo do registro.

```
virtual void PreLoadState();
```

### <a name="remarks"></a>Comentários

Substitua este método se você quiser fazer qualquer processamento imediatamente antes do framework carrega o estado do aplicativo.

##  <a name="presavestate"></a>  CWinAppEx::PreSaveState

O framework chama esse método imediatamente antes de salvar o estado do aplicativo.

```
virtual void PreSaveState();
```

### <a name="remarks"></a>Comentários

Substitua este método se você quiser fazer qualquer processamento imediatamente antes do framework salva o estado do aplicativo.

##  <a name="reloadwindowplacement"></a>  CWinAppEx::ReloadWindowPlacement

Recarrega o tamanho e local de uma janela do registro.

```
virtual BOOL ReloadWindowPlacement(CFrameWnd* pFrame);
```

### <a name="parameters"></a>Parâmetros

*pFrame*<br/>
[in] Um ponteiro para uma janela do quadro.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o método foi bem-sucedida; 0 se a carga com falha ou se não houver nenhum dados para carregar.

### <a name="remarks"></a>Comentários

Use a função [CWinAppEx::StoreWindowPlacement](#storewindowplacement) para gravar o tamanho e local de uma janela no registro.

##  <a name="savecustomstate"></a>  CWinAppEx::SaveCustomState

O framework chama esse método depois que ele salva o estado do aplicativo no registro.

```
virtual void SaveCustomState();
```

### <a name="remarks"></a>Comentários

Substitua este método se você quiser fazer qualquer processamento depois que o aplicativo salva o estado no registro. Por padrão, esse método não fará nada.

##  <a name="savestate"></a>  CWinAppEx::SaveState

Grava o estado do aplicativo no registro do Windows.

```
virtual BOOL SaveState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);

BOOL SaveState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>Parâmetros

*lpszSectionName*<br/>
[in] Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

*pFrameImpl*<br/>
[in] Um ponteiro para um `CFrameImpl` objeto. Este quadro é salva no registro do Windows.

*pFrame*<br/>
[in] Um ponteiro para um objeto de janela do quadro. Este quadro é salva no registro do Windows.

### <a name="return-value"></a>Valor de retorno

VERDADEIRO se bem-sucedido; FALSE caso contrário.

### <a name="remarks"></a>Comentários

Esse método salva o estado do aplicativo e quaisquer informações de estado para a janela do quadro fornecido. Se você não fornecer uma janela de quadro, o método apenas salva o estado do aplicativo. As informações do aplicativo incluem o estado do [classe CMouseManager](../../mfc/reference/cmousemanager-class.md), [classe CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md), [classe CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)e o [ Classe CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md).

O *lpszSectionName* parâmetro não é o caminho absoluto para uma entrada de registro. É um caminho relativo que é acrescentado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase) , respectivamente.

##  <a name="setregistrybase"></a>  CWinAppEx::SetRegistryBase

Define o caminho do registro padrão para o aplicativo.

```
LPCTSTR SetRegistryBase(LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>Parâmetros

*lpszSectionName*<br/>
[in] Uma cadeia de caracteres que contém o caminho de uma chave do registro.

### <a name="return-value"></a>Valor de retorno

Uma cadeia de caracteres que contém o caminho do local padrão do registro.

### <a name="remarks"></a>Comentários

Todos os métodos de [classe CWinAppEx](../../mfc/reference/cwinappex-class.md) que acessam o início do registro em um local padrão. Use esse método para alterar o local padrão do registro. Use [CWinAppEx::GetRegistryBase](#getregistrybase) para recuperar o local do registro padrão.

##  <a name="showpopupmenu"></a>  CWinAppEx::ShowPopupMenu

Exibe um menu pop-up.

```
virtual BOOL ShowPopupMenu(
    UINT uiMenuResId,
    const CPoint& point,
    CWnd* pWnd);
```

### <a name="parameters"></a>Parâmetros

*uiMenuResId*<br/>
[in] Uma ID de recurso de menu.

*point*<br/>
[in] Um [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) que especifica a posição do menu em coordenadas da tela.

*pWnd*<br/>
[in] Um ponteiro para a janela que possui um menu pop-up.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se o menu pop-up é exibido com êxito; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Esse método exibe o menu associado *uiMenuResId*.

Para dar suporte a menus pop-up, você deve ter uma [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md) objeto. Se você não tiver inicializado o `CContextMenuManager` objeto, `ShowPopupMenu` falhará.

##  <a name="storewindowplacement"></a>  CWinAppEx::StoreWindowPlacement

Chamado pelo framework para gravar o tamanho e local da janela principal do quadro no registro.

```
virtual BOOL StoreWindowPlacement(
    const CRect& rectNormalPosition,
    int nFlags,
    int nShowCmd);
```

### <a name="parameters"></a>Parâmetros

*nFlags*<br/>
[in] Sinalizadores que controlam a posição da janela minimizada e como o sistema operacional alterna entre uma janela minimizada e uma janela restaurada.

*nShowCmd*<br/>
[in] Um inteiro que especifica o estado de Mostrar da janela. Para obter mais informações sobre os valores possíveis, consulte [CWnd::ShowWindow](../../mfc/reference/cwnd-class.md#showwindow).

*rectNormalPosition*<br/>
[in] Um retângulo que contém as coordenadas da janela do quadro principal quando ele está em estado restaurado.

### <a name="return-value"></a>Valor de retorno

Diferente de zero se bem-sucedido; Caso contrário, 0.

### <a name="remarks"></a>Comentários

Por padrão, o MFC salva automaticamente a posição e o estado da janela do quadro principal antes de sair do aplicativo. Essas informações são armazenadas no registro do Windows sob a chave WindowPlacement no local padrão do registro para o seu aplicativo. Para obter mais informações sobre o local padrão do registro do seu aplicativo, consulte [CWinAppEx::GetRegistryBase](#getregistrybase).

Substitua este método se você quiser armazenar informações adicionais sobre a janela do quadro principal.

##  <a name="writebinary"></a>  CWinAppEx::WriteBinary

Grava dados binários no registro.

```
BOOL WriteBinary(
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>Parâmetros

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o nome de uma chave do registro.

*pData*<br/>
[in] Os dados serem armazenados.

*nBytes*<br/>
[in] O tamanho de *pData* em bytes.

### <a name="return-value"></a>Valor de retorno

TRUE se esse método for bem-sucedida; Caso contrário, FALSE.

### <a name="remarks"></a>Comentários

O *lpszEntry* parâmetro é o nome de uma entrada de registro que está localizado sob a chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase) , respectivamente.

Se a chave especificada pelo *lpszEntry* não existir, esse método vai criá-la.

##  <a name="writeint"></a>  CWinAppEx::WriteInt

Grava dados numéricos no registro.

```
BOOL WriteInt(
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>Parâmetros

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o nome de uma chave do registro.

*nValue*<br/>
[in] Os dados serem armazenados.

### <a name="return-value"></a>Valor de retorno

TRUE se esse método for bem-sucedida; Caso contrário, FALSE.

### <a name="remarks"></a>Comentários

O *lpszEntry* parâmetro é o nome de uma entrada de registro localizado sob a chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase) , respectivamente.

Se a chave especificada pelo *lpszEntry* não existir, esse método vai criá-la.

##  <a name="writeobject"></a>  CWinAppEx::WriteObject

Grava dados derivados de [classe CObject](../../mfc/reference/cobject-class.md) no registro.

```
BOOL WriteObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parâmetros

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o valor a ser definido.

*obj*<br/>
[in] Uma referência ao `CObject` dados que armazenará o método.

### <a name="return-value"></a>Valor de retorno

TRUE se esse método for bem-sucedida; Caso contrário, FALSE.

### <a name="remarks"></a>Comentários

Esse método grava o *obj* dados para o valor especificado na chave do registro padrão. Use [CWinAppEx::GetRegistryBase](#getregistrybase) para determinar a chave do registro atual.

##  <a name="writesectionbinary"></a>  CWinAppEx::WriteSectionBinary

Grava dados binários como um valor no registro.

```
BOOL WriteSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>Parâmetros

*lpszSubSection*<br/>
[in] Uma cadeia de caracteres que contém o nome de uma chave do registro

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o valor a ser definido.

*pData*<br/>
[in] Os dados a gravar no registro.

*nBytes*<br/>
[in] O tamanho de *pData* em bytes.

### <a name="return-value"></a>Valor de retorno

TRUE se esse método for bem-sucedida; Caso contrário, FALSE.

### <a name="remarks"></a>Comentários

O *lpszSubSection* parâmetro não é o caminho absoluto para uma entrada de registro. É um caminho relativo que é acrescentado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase) , respectivamente.

Se a chave especificada pelo *lpszEntry* não existir, esse método vai criá-la.

##  <a name="writesectionint"></a>  CWinAppEx::WriteSectionInt

Grava dados numéricos no registro.

```
BOOL WriteSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>Parâmetros

*lpszSubSection*<br/>
[in] Uma cadeia de caracteres que contém o caminho relativo de uma chave do registro.

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o valor a ser definido.

*nValue*<br/>
[in] Os dados a gravar no registro.

### <a name="return-value"></a>Valor de retorno

TRUE se esse método for bem-sucedida; Caso contrário, FALSE.

### <a name="remarks"></a>Comentários

O *lpszSubSection* parâmetro não é um caminho absoluto para uma entrada de registro. É um caminho relativo que é acrescentado à chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase) , respectivamente.

Se a chave especificada pelo *lpszEntry* não existir, esse método vai criá-la.

##  <a name="writesectionobject"></a>  CWinAppEx::WriteSectionObject

Grava dados derivados do [classe de CObject](../../mfc/reference/cobject-class.md) para um valor de registro específicos.

```
BOOL WriteSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Parâmetros

*lpszSubSection*<br/>
[in] Uma cadeia de caracteres que contém o nome de uma chave do registro.

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o nome do valor a ser definido.

*obj*<br/>
[in] Os dados serem armazenados.

### <a name="return-value"></a>Valor de retorno

TRUE se esse método for bem-sucedida; Caso contrário, FALSE.

### <a name="remarks"></a>Comentários

O *lpszSubSection* parâmetro não é um caminho absoluto para uma entrada de registro. É um caminho relativo que é acrescentado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase), respectivamente.

Se o valor especificado por *lpszEntry* não existe sob a chave do Registro especificada por *lpszSubSection*, esse método criará esse valor.

##  <a name="writesectionstring"></a>  CWinAppEx::WriteSectionString

Grava dados de cadeia de caracteres para um valor no registro.

```
BOOL WriteSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>Parâmetros

*lpszSubSection*<br/>
[in] Uma cadeia de caracteres que contém o nome de uma chave do registro.

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o valor a ser definido.

*lpszValue*<br/>
[in] Os dados de cadeia de caracteres a gravar no registro.

### <a name="return-value"></a>Valor de retorno

TRUE se esse método for bem-sucedida; Caso contrário, FALSE.

### <a name="remarks"></a>Comentários

O *lpszSubSection* parâmetro não é um caminho absoluto para uma entrada de registro. É um caminho relativo que é acrescentado ao final da chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase), respectivamente.

Se o valor especificado por *lpszEntry* não existe sob *lpszSubSection*, esse método vai criá-la.

##  <a name="writestring"></a>  CWinAppEx::WriteString

Grava dados de cadeia de caracteres no registro.

```
BOOL WriteString(
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>Parâmetros

*lpszEntry*<br/>
[in] Uma cadeia de caracteres que contém o nome de uma chave do registro.

*lpszValue*<br/>
[in] Os dados serem armazenados.

### <a name="return-value"></a>Valor de retorno

TRUE se esse método for bem-sucedida; Caso contrário, FALSE.

### <a name="remarks"></a>Comentários

O *lpszEntry* parâmetro é o nome de uma entrada de registro localizado sob a chave do registro padrão para seu aplicativo. Para obter ou definir a chave do registro padrão, use os métodos [CWinAppEx::GetRegistryBase](#getregistrybase) e [CWinAppEx::SetRegistryBase](#setregistrybase) , respectivamente.

Se a chave especificada pelo *lspzEntry* não existir, esse método vai criá-la.

## <a name="see-also"></a>Consulte também

[Gráfico da hierarquia](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[Classe CWinApp](../../mfc/reference/cwinapp-class.md)<br/>
[Classe CMouseManager](../../mfc/reference/cmousemanager-class.md)<br/>
[Classe CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)<br/>
[Classe CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)<br/>
[Classe CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)
