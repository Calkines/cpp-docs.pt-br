---
title: Classe CMFCToolBarMenuButton
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CompareWith
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CopyFrom
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateFromMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::EnableQuickCustomize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetCommands
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetImageRect
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPaletteRows
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HasButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HaveHotBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsClickedOnMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsDroppedDown
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsEmptyMenuAllowed
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsExclusive
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsQuickMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsTearOffMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnAfterCreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnBeforeDrag
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCalculateSize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCancelMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnChangeParentWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClick
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClickMenuItem
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnContextHelp
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDraw
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDrawOnCustomizeList
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OpenPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::ResetImageToDefault
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SaveBarState
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::Serialize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetACCData
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuOnly
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMessageWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetRadio
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetTearOff
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::DrawDocumentIcon
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw
helpviewer_keywords:
- CMFCToolBarMenuButton [MFC], CMFCToolBarMenuButton
- CMFCToolBarMenuButton [MFC], CompareWith
- CMFCToolBarMenuButton [MFC], CopyFrom
- CMFCToolBarMenuButton [MFC], CreateFromMenu
- CMFCToolBarMenuButton [MFC], CreateMenu
- CMFCToolBarMenuButton [MFC], CreatePopupMenu
- CMFCToolBarMenuButton [MFC], EnableQuickCustomize
- CMFCToolBarMenuButton [MFC], GetCommands
- CMFCToolBarMenuButton [MFC], GetImageRect
- CMFCToolBarMenuButton [MFC], GetPaletteRows
- CMFCToolBarMenuButton [MFC], GetPopupMenu
- CMFCToolBarMenuButton [MFC], HasButton
- CMFCToolBarMenuButton [MFC], HaveHotBorder
- CMFCToolBarMenuButton [MFC], IsBorder
- CMFCToolBarMenuButton [MFC], IsClickedOnMenu
- CMFCToolBarMenuButton [MFC], IsDroppedDown
- CMFCToolBarMenuButton [MFC], IsEmptyMenuAllowed
- CMFCToolBarMenuButton [MFC], IsExclusive
- CMFCToolBarMenuButton [MFC], IsMenuPaletteMode
- CMFCToolBarMenuButton [MFC], IsQuickMode
- CMFCToolBarMenuButton [MFC], IsTearOffMenu
- CMFCToolBarMenuButton [MFC], OnAfterCreatePopupMenu
- CMFCToolBarMenuButton [MFC], OnBeforeDrag
- CMFCToolBarMenuButton [MFC], OnCalculateSize
- CMFCToolBarMenuButton [MFC], OnCancelMode
- CMFCToolBarMenuButton [MFC], OnChangeParentWnd
- CMFCToolBarMenuButton [MFC], OnClick
- CMFCToolBarMenuButton [MFC], OnClickMenuItem
- CMFCToolBarMenuButton [MFC], OnContextHelp
- CMFCToolBarMenuButton [MFC], OnDraw
- CMFCToolBarMenuButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarMenuButton [MFC], OpenPopupMenu
- CMFCToolBarMenuButton [MFC], ResetImageToDefault
- CMFCToolBarMenuButton [MFC], SaveBarState
- CMFCToolBarMenuButton [MFC], Serialize
- CMFCToolBarMenuButton [MFC], SetACCData
- CMFCToolBarMenuButton [MFC], SetMenuOnly
- CMFCToolBarMenuButton [MFC], SetMenuPaletteMode
- CMFCToolBarMenuButton [MFC], SetMessageWnd
- CMFCToolBarMenuButton [MFC], SetRadio
- CMFCToolBarMenuButton [MFC], SetTearOff
- CMFCToolBarMenuButton [MFC], DrawDocumentIcon
- CMFCToolBarMenuButton [MFC], m_bAlwaysCallOwnerDraw
ms.assetid: cfa50176-7e4b-4527-9904-86a1b48fc1bc
ms.openlocfilehash: 883d6a9242066289f15e58179a03c4f609699141
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/15/2019
ms.locfileid: "69504709"
---
# <a name="cmfctoolbarmenubutton-class"></a>Classe CMFCToolBarMenuButton

Um botão da barra de ferramentas que contém um menu pop-up.
Para obter mais detalhes, consulte o código-fonte localizado na pasta **vc\\atlmfc\\src\\MFC** da instalação do Visual Studio.

## <a name="syntax"></a>Sintaxe

```
class CMFCToolBarMenuButton : public CMFCToolBarButton
```

## <a name="members"></a>Membros

### <a name="public-constructors"></a>Construtores públicos

|Nome|Descrição|
|----------|-----------------|
|[CMFCToolBarMenuButton::CMFCToolBarMenuButton](#cmfctoolbarmenubutton)|Constrói um objeto `CMFCToolBarMenuButton`.|

### <a name="public-methods"></a>Métodos públicos

|Nome|Descrição|
|----------|-----------------|
|[CMFCToolBarMenuButton::CompareWith](#comparewith)|Compara esta instância com o objeto `CMFCToolBarButton` fornecido. (Substitui [CMFCToolBarButton:: CompareWith](../../mfc/reference/cmfctoolbarbutton-class.md#comparewith).)|
|[CMFCToolBarMenuButton::CopyFrom](#copyfrom)|Copia as propriedades de outro botão da barra de ferramentas para o botão atual. (Substitui [CMFCToolBarButton:: CopyFrom](../../mfc/reference/cmfctoolbarbutton-class.md#copyfrom).)|
|[CMFCToolBarMenuButton::CreateFromMenu](#createfrommenu)|Inicializa o menu da barra de ferramentas de um identificador de menu do Windows.|
|[CMFCToolBarMenuButton::CreateMenu](#createmenu)|Cria um menu do Windows que consiste nos comandos no menu da barra de ferramentas. Retorna um identificador para o menu do Windows.|
|[CMFCToolBarMenuButton::CreatePopupMenu](#createpopupmenu)|Cria um objeto de menu pop-up ( [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)) para exibir o menu da barra de ferramentas.|
|[CMFCToolBarMenuButton::EnableQuickCustomize](#enablequickcustomize)||
|[CMFCToolBarMenuButton:: GetCommands](#getcommands)|Concede acesso somente leitura à lista de comandos no menu da barra de ferramentas.|
|[CMFCToolBarMenuButton::GetImageRect](#getimagerect)|Recupera o retângulo delimitador da imagem do botão.|
|[CMFCToolBarMenuButton::GetPaletteRows](#getpaletterows)|Retorna o número de linhas no menu pop-up quando o menu está no modo de paleta.|
|[CMFCToolBarMenuButton::GetPopupMenu](#getpopupmenu)|Retorna um ponteiro para o objeto de menu pop-up que está associado ao botão.|
|[CMFCToolBarMenuButton::HasButton](#hasbutton)||
|[CMFCToolBarMenuButton::HaveHotBorder](#havehotborder)|Determina se uma borda do botão é exibida quando um usuário seleciona o botão. (Substitui [CMFCToolBarButton:: HaveHotBorder](../../mfc/reference/cmfctoolbarbutton-class.md#havehotborder).)|
|[CMFCToolBarMenuButton:: IsBorder](#isborder)||
|[CMFCToolBarMenuButton::IsClickedOnMenu](#isclickedonmenu)||
|[CMFCToolBarMenuButton::IsDroppedDown](#isdroppeddown)|Determina se o menu pop-up é exibido.|
|[CMFCToolBarMenuButton::IsEmptyMenuAllowed](#isemptymenuallowed)|Chamado pelo Framework para determinar se um usuário pode abrir um submenu do item de menu selecionado.|
|[CMFCToolBarMenuButton:: isexclusive](#isexclusive)|Determina se o botão está em modo exclusivo, ou seja, se o menu pop-up permanece aberto mesmo quando o usuário move o ponteiro sobre outra barra de ferramentas ou botão.|
|[CMFCToolBarMenuButton::IsMenuPaletteMode](#ismenupalettemode)|Determina se o menu pop-up está no modo de paleta.|
|[CMFCToolBarMenuButton::IsQuickMode](#isquickmode)||
|[CMFCToolBarMenuButton::IsTearOffMenu](#istearoffmenu)|Determina se o menu pop-up tem uma barra suspensa.|
|[CMFCToolBarMenuButton::OnAfterCreatePopupMenu](#onaftercreatepopupmenu)||
|[CMFCToolBarMenuButton::OnBeforeDrag](#onbeforedrag)|Especifica se o botão pode ser arrastado. (Substitui [CMFCToolBarButton:: OnBeforeDrag](../../mfc/reference/cmfctoolbarbutton-class.md#onbeforedrag).)|
|[CMFCToolBarMenuButton::OnCalculateSize](#oncalculatesize)|Chamado pelo Framework para calcular o tamanho do botão para o contexto do dispositivo especificado e o estado de encaixe. (Substitui [CMFCToolBarButton:: OnCalculateSize](../../mfc/reference/cmfctoolbarbutton-class.md#oncalculatesize).)|
|[CMFCToolBarMenuButton::OnCancelMode](#oncancelmode)|Chamado pelo Framework para manipular a mensagem [WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode) . (Substitui [CMFCToolBarButton::](../../mfc/reference/cmfctoolbarbutton-class.md#oncancelmode)OnCancelMode.)|
|[CMFCToolBarMenuButton::OnChangeParentWnd](#onchangeparentwnd)|Chamado pelo Framework quando o botão é inserido em uma nova barra de ferramentas. (Substitui [CMFCToolBarButton:: OnChangeParentWnd](cmfctoolbarbutton-class.md#onchangeparentwnd).)|
|[CMFCToolBarMenuButton:: OnClick](#onclick)|Chamado pelo Framework quando o usuário clica no botão do mouse. (Substitui [CMFCToolBarButton:: OnClick](../../mfc/reference/cmfctoolbarbutton-class.md#onclick).)|
|[CMFCToolBarMenuButton::OnClickMenuItem](#onclickmenuitem)|Chamado pelo Framework quando o usuário seleciona um item no menu pop-up.|
|[CMFCToolBarMenuButton::OnContextHelp](#oncontexthelp)|Chamado pelo Framework quando a barra de ferramentas pai manipula uma mensagem WM_HELPHITTEST. (Substitui [CMFCToolBarButton:: OnContextHelp](../../mfc/reference/cmfctoolbarbutton-class.md#oncontexthelp).)|
|[CMFCToolBarMenuButton:: OnDraw](#ondraw)|Chamado pelo Framework para desenhar o botão usando os estilos e as opções especificadas. (Substitui [CMFCToolBarButton:: OnDraw](../../mfc/reference/cmfctoolbarbutton-class.md#ondraw).)|
|[CMFCToolBarMenuButton::OnDrawOnCustomizeList](#ondrawoncustomizelist)|Chamado pelo Framework para desenhar o botão no painel **comandos** da caixa de diálogo **Personalizar** . (Substitui [CMFCToolBarButton:: OnDrawOnCustomizeList](../../mfc/reference/cmfctoolbarbutton-class.md#ondrawoncustomizelist).)|
|[CMFCToolBarMenuButton::OpenPopupMenu](#openpopupmenu)|Chamado pelo Framework quando o usuário abre o menu pop-up.|
|[CMFCToolBarMenuButton::ResetImageToDefault](#resetimagetodefault)|Define como o valor padrão a imagem que está associada ao botão. (Substitui [CMFCToolBarButton:: ResetImageToDefault](../../mfc/reference/cmfctoolbarbutton-class.md#resetimagetodefault).)|
|[CMFCToolBarMenuButton::SaveBarState](#savebarstate)|Salva o estado do botão da barra de ferramentas. (Substitui [CMFCToolBarButton:: SaveBarState](../../mfc/reference/cmfctoolbarbutton-class.md#savebarstate).)|
|[CMFCToolBarMenuButton:: Serialize](#serialize)|Lê este objeto de um arquivo ou grava-o em um arquivo morto. (Substitui [CMFCToolBarButton:: Serialize](../../mfc/reference/cmfctoolbarbutton-class.md#serialize).)|
|[CMFCToolBarMenuButton::SetACCData](#setaccdata)|Popula o objeto fornecido `CAccessibilityData` com dados de acessibilidade do botão da barra de ferramentas. (Substitui [CMFCToolBarButton:: SetACCData](../../mfc/reference/cmfctoolbarbutton-class.md#setaccdata).)|
|[CMFCToolBarMenuButton::SetMenuOnly](#setmenuonly)|Especifica se o botão pode ser adicionado a uma barra de ferramentas.|
|[CMFCToolBarMenuButton::SetMenuPaletteMode](#setmenupalettemode)|Especifica se o menu pop-up está no modo de paleta.|
|[CMFCToolBarMenuButton::SetMessageWnd](#setmessagewnd)||
|[CMFCToolBarMenuButton:: SetRadio](#setradio)|Força o botão de menu da barra de ferramentas a exibir um ícone que indica que ele está selecionado.|
|[CMFCToolBarMenuButton::SetTearOff](#settearoff)|Especifica uma ID de barra suspensa para o menu pop-up.|

### <a name="protected-methods"></a>Métodos Protegidos

|Nome|Descrição|
|----------|-----------------|
|[CMFCToolBarMenuButton::DrawDocumentIcon](#drawdocumenticon)|Desenha um ícone no botão de menu.|

### <a name="data-members"></a>Membros de Dados

|Nome|Descrição|
|----------|-----------------|
|[CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw](#m_balwayscallownerdraw)|Se for TRUE, a estrutura sempre chamará [CFrameWndEx:: OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) quando um botão for desenhado.|

## <a name="remarks"></a>Comentários

Um `CMFCToolBarMenuButton` pode aparecer como um menu, um item de menu que tem um submenu, um botão que executa um comando ou exibe um menu ou um botão que exibe apenas um menu. Você determina o comportamento e a aparência do botão de menu especificando parâmetros como a imagem, o texto, o identificador de menu e a ID de comando que está associada ao botão no `CMFCToolbarMenuButton::CMFCToolbarMenuButton`Construtor.

Uma classe personalizada derivada da `CMFCToolbarMenuButton` classe deve usar a macro [DECLARE_SERIAL](run-time-object-model-services.md#declare_serial) . A macro [DECLARE_DYNCREATE](run-time-object-model-services.md#declare_dyncreate) gera um erro quando o aplicativo é fechado.

## <a name="example"></a>Exemplo

O exemplo a seguir demonstra como configurar um `CMFCToolBarMenuButton` objeto. O código ilustra como especificar que o menu suspenso está no modo de paleta e especificar a ID para a barra de desmontagem que é criada quando o usuário arrasta o botão de menu para fora de uma barra de menus. Este trecho de código faz parte do [exemplo do Word pad](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_WordPad#10](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>Hierarquia de herança

[CObject](cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

[CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md)

## <a name="requirements"></a>Requisitos

**Cabeçalho:** afxtoolbarmenubutton. h

##  <a name="cmfctoolbarmenubutton"></a>CMFCToolBarMenuButton::CMFCToolBarMenuButton

Constrói um objeto `CMFCToolBarMenuButton`.

```
CMFCToolBarMenuButton();
CMFCToolBarMenuButton(const CMFCToolBarMenuButton& src);

CMFCToolBarMenuButton(
    UINT uiID,
    HMENU hMenu,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE);
```

### <a name="parameters"></a>Parâmetros

*src*<br/>
no Um objeto `CMFCToolBarMenuButton` existente a ser copiado para `CMFCToolBarMenuButton` este objeto.

*uiID*<br/>
no A ID do comando a ser executado quando um usuário clica no botão; ou (UINT)-1 para um botão de menu que não executa diretamente um comando.

*hMenu*<br/>
no Um identificador para um menu; ou NULL se o botão não tiver um menu.

*iImage*<br/>
no Índice da imagem do botão; ou-1 se esse botão não tiver um ícone ou usar o ícone para o comando especificado por *uiID*. O índice é o mesmo para cada `CMFCToolBarImages` objeto em seu aplicativo.

*lpszText*<br/>
no O texto do botão de menu da barra de ferramentas.

*bUserButton*<br/>
no TRUE se o botão exibir uma imagem definida pelo usuário; FALSE se o botão exibir uma imagem predefinida associada ao comando especificado por *uiID*.

### <a name="remarks"></a>Comentários

Se *uiID* for uma ID de comando válida, o botão executará esse comando quando o usuário clicar nele. Se *HMENU* for um identificador de menu válido, o botão fornecerá um menu suspenso quando ele aparecer em uma barra de ferramentas ou em um submenu quando aparecer em um menu. Se *uiID* e *HMENU* forem válidos, o botão será um botão de divisão com uma parte que executará o comando quando o usuário clicar nele e uma parte com uma seta para baixo que irá listar um menu quando o usuário clicar nele. No entanto, se *HMENU* for válido, um usuário não poderá clicar no botão para executar um comando quando o botão for inserido em um menu.

### <a name="example"></a>Exemplo

O exemplo a seguir demonstra como construir um objeto da `CMFCToolBarMenuButton` classe. Este trecho de código faz parte do [exemplo do Word pad](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_WordPad#9](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_2.cpp)]

##  <a name="comparewith"></a>CMFCToolBarMenuButton::CompareWith

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>Parâmetros

no *outros*<br/>

### <a name="return-value"></a>Valor de retorno

### <a name="remarks"></a>Comentários

##  <a name="copyfrom"></a>CMFCToolBarMenuButton::CopyFrom

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>Parâmetros

no *src*<br/>

### <a name="remarks"></a>Comentários

##  <a name="createfrommenu"></a>CMFCToolBarMenuButton::CreateFromMenu

Inicializa o menu da barra de ferramentas de um identificador de menu do Windows.

```
virtual void CreateFromMenu(HMENU hMenu);
```

### <a name="parameters"></a>Parâmetros

*hMenu*<br/>
no Um identificador para um menu.

### <a name="remarks"></a>Comentários

Um botão de menu da barra de ferramentas pode exibir um submenu suspenso.

A estrutura chama esse método para inicializar os comandos no submenu a partir de um menu.

##  <a name="createmenu"></a>CMFCToolBarMenuButton:: CreateMenu

Cria um menu que consiste nos comandos no menu da barra de ferramentas. Retorna um identificador para o menu.

```
virtual HMENU CreateMenu() const;
```

### <a name="return-value"></a>Valor de retorno

Um identificador para o menu se for bem-sucedido. NULL se a lista de comandos associada ao botão de menu da barra de ferramentas estiver vazia.

### <a name="remarks"></a>Comentários

Você pode substituir esse método em uma classe derivada para personalizar a maneira como o menu é gerado.

##  <a name="createpopupmenu"></a>CMFCToolBarMenuButton::CreatePopupMenu

Cria um `CMFCPopupMenu` objeto para exibir o menu da barra de ferramentas.

```
virtual CMFCPopupMenu* CreatePopupMenu();
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para um `CMFCPopupMenu` objeto que exibe o menu suspenso associado ao botão de menu da barra de ferramentas.

### <a name="remarks"></a>Comentários

Esse método é chamado pelo Framework para preparar a exibição do menu suspenso associado ao botão.

A implementação padrão apenas constrói e retorna um novo `CMFCPopupMenu` objeto. Substitua esse método se você quiser usar um tipo derivado de [classe CMFCPopupMenu](cmfcpopupmenu-class.md) ou para executar uma inicialização adicional.

##  <a name="drawdocumenticon"></a>CMFCToolBarMenuButton::D rawDocumentIcon

Desenha um ícone de documento no botão de menu.

```
void DrawDocumentIcon(
    CDC* pDC,
    const CRect& rectImage,
    HICON hIcon);
```

### <a name="parameters"></a>Parâmetros

*pDC*<br/>
no Um ponteiro para o contexto do dispositivo.

*rectImage*<br/>
no Coordenadas do retângulo delimitador de imagem.

*hIcon*<br/>
no Um identificador para o ícone.

### <a name="remarks"></a>Comentários

Esse método usa um ícone de documento e o desenha no botão de menu, centralizado na área especificada por *rectImage*.

##  <a name="enablequickcustomize"></a>CMFCToolBarMenuButton::EnableQuickCustomize

```
void EnableQuickCustomize();
```

### <a name="remarks"></a>Comentários

##  <a name="hasbutton"></a>CMFCToolBarMenuButton::HasButton

```
virtual BOOL HasButton() const;
```

### <a name="return-value"></a>Valor de retorno

### <a name="remarks"></a>Comentários

##  <a name="havehotborder"></a>CMFCToolBarMenuButton::HaveHotBorder

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>Valor de retorno

### <a name="remarks"></a>Comentários

##  <a name="isborder"></a>CMFCToolBarMenuButton:: IsBorder

```
virtual BOOL IsBorder() const;
```

### <a name="return-value"></a>Valor de retorno

### <a name="remarks"></a>Comentários

##  <a name="isclickedonmenu"></a>CMFCToolBarMenuButton::IsClickedOnMenu

```
BOOL IsClickedOnMenu() const;
```

### <a name="return-value"></a>Valor de retorno

### <a name="remarks"></a>Comentários

##  <a name="isquickmode"></a>CMFCToolBarMenuButton:: isrápidomode

```
BOOL IsQuickMode();
```

### <a name="return-value"></a>Valor de retorno

### <a name="remarks"></a>Comentários

##  <a name="getcommands"></a>CMFCToolBarMenuButton:: GetCommands

Concede acesso somente leitura à lista de comandos no menu da barra de ferramentas.

```
const CObList& GetCommands() const;
```

### <a name="return-value"></a>Valor de retorno

Uma referência const a um objeto de [classe CObList](../../mfc/reference/coblist-class.md) , que contém uma coleção de objetos de [classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) .

### <a name="remarks"></a>Comentários

Um botão de menu da barra de ferramentas pode exibir um submenu. Você pode fornecer a lista de comandos no submenu no construtor ou em [CMFCToolBarMenuButton:: CreateFromMenu](#createfrommenu) como um identificador para um menu (HMENU). O menu é convertido em uma lista de objetos que são derivados da [classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) e armazenados no objeto interno `CObList` . Você pode acessar essa lista chamando este método.

##  <a name="getimagerect"></a>  CMFCToolBarMenuButton::GetImageRect

Recupera o retângulo delimitador da imagem do botão.

```
void GetImageRect(CRect& rectImage);
```

### <a name="parameters"></a>Parâmetros

*rectImage*<br/>
fora Uma referência a um `CRect` objeto que recebe as coordenadas do retângulo delimitador da imagem.

##  <a name="getpaletterows"></a>  CMFCToolBarMenuButton::GetPaletteRows

Retorna o número de linhas no menu suspenso quando o menu está no modo de paleta.

```
int GetPaletteRows() const;
```

### <a name="return-value"></a>Valor de retorno

O número de linhas na paleta.

### <a name="remarks"></a>Comentários

Quando o botão de menu estiver definido como modo de paleta, os itens de menu aparecerão em várias colunas com apenas um número limitado de linhas. Chame esse método para obter o número de linhas. Você pode habilitar ou desabilitar o modo de paleta e especificar o número de linhas usando [CMFCToolBarMenuButton:: SetMenuPaletteMode](#setmenupalettemode).

##  <a name="getpopupmenu"></a>  CMFCToolBarMenuButton::GetPopupMenu

Retorna um ponteiro para o objeto da [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) que representa o menu suspenso do botão.

```
CMFCPopupMenu* GetPopupMenu() const;
```

### <a name="return-value"></a>Valor de retorno

Um ponteiro para um objeto da [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) que foi criado quando a estrutura desenhou o submenu do botão de menu da barra de ferramentas; NULL se nenhum submenu for exibido.

### <a name="remarks"></a>Comentários

Quando um botão de menu da barra de ferramentas exibe um menu suspenso, o botão cria um objeto de [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) para representar o menu. Chame esse método para obter um ponteiro para o `CMFCPopupMenu` objeto. Você não deve armazenar o ponteiro retornado, pois ele é temporário e se torna inválido quando o usuário fecha o menu suspenso.

##  <a name="isdroppeddown"></a>CMFCToolBarMenuButton::IsDroppedDown

Indica se o menu pop-up está sendo exibido no momento.

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>Valor de retorno

TRUE se o botão de menu da barra de ferramentas exibir seu submenu; caso contrário, FALSE.

##  <a name="isemptymenuallowed"></a>CMFCToolBarMenuButton::IsEmptyMenuAllowed

Especifica se os itens de menu mostram submenus vazios.

```
virtual BOOL IsEmptyMenuAllowed() const;
```

### <a name="return-value"></a>Valor de retorno

TRUE se a estrutura abrir um submenu do item de menu selecionado no momento mesmo quando o submenu estiver vazio; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

A estrutura chama esse método quando um usuário tenta abrir o submenu a partir do item de menu atualmente selecionado. Se o submenu estiver vazio e `IsEmptyMenuAllowed` retornar false, o submenu não será aberto.

A implementação padrão retorna FALSE. Substitua esse método para personalizar esse comportamento.

##  <a name="isexclusive"></a>CMFCToolBarMenuButton:: isexclusive

Indica se o botão está no modo exclusivo.

```
virtual BOOL IsExclusive() const;
```

### <a name="return-value"></a>Valor de retorno

TRUE se o botão estiver funcionando em modo exclusivo; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

Quando um usuário abre um menu pop-up para um botão e, em seguida, move o ponteiro do mouse sobre outra barra de ferramentas ou botão de menu, o menu pop-up é fechado, a menos que o botão esteja no modo exclusivo.

A implementação padrão sempre retorna FALSE. Substitua esse método em uma classe derivada se desejar ativar o modo exclusivo.

##  <a name="ismenupalettemode"></a>  CMFCToolBarMenuButton::IsMenuPaletteMode

Determina se o menu suspenso está no modo de paleta.

```
BOOL IsMenuPaletteMode() const;
```

### <a name="return-value"></a>Valor de retorno

TRUE se o modo de paleta estiver habilitado, caso contrário, FALSE.

### <a name="remarks"></a>Comentários

Quando o botão de menu é definido como modo de paleta, os itens de menu aparecem em várias colunas com apenas um número limitado de linhas. Chame esse método para obter o número de linhas. Você pode habilitar ou desabilitar o modo de paleta chamando [CMFCToolBarMenuButton:: SetMenuPaletteMode](#setmenupalettemode).

##  <a name="istearoffmenu"></a>  CMFCToolBarMenuButton::IsTearOffMenu

Indica se o menu suspenso tem uma barra suspensa.

```
virtual BOOL IsTearOffMenu() const;
```

### <a name="return-value"></a>Valor de retorno

TRUE se o botão de menu da barra de ferramentas tiver uma barra suspensa; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

Para habilitar o recurso de remontagem e definir a ID da barra de desfazer, chame [CMFCToolBarMenuButton:: SetTearOff](#settearoff).

##  <a name="m_balwayscallownerdraw"></a>CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw

Especifica se a estrutura sempre chama [CFrameWndEx:: OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) quando um botão é desenhado.

```
static BOOL m_bAlwaysCallOwnerDraw;
```

### <a name="remarks"></a>Comentários

Quando essa variável de membro é definida como TRUE, o botão sempre chama o método [CFrameWndEx:: OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) para exibir a imagem no botão. Quando `m_bAlwaysCallOwnerDraw` for false, o botão em si desenhará a imagem se a imagem for predefinida. Caso contrário, ele `OnDrawMenuImage`chama.

##  <a name="onaftercreatepopupmenu"></a>  CMFCToolBarMenuButton::OnAfterCreatePopupMenu

```
virtual void OnAfterCreatePopupMenu();
```

### <a name="remarks"></a>Comentários

##  <a name="onbeforedrag"></a>CMFCToolBarMenuButton::OnBeforeDrag

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>Valor de retorno

### <a name="remarks"></a>Comentários

##  <a name="oncalculatesize"></a>CMFCToolBarMenuButton::OnCalculateSize

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>Parâmetros

no *PDC*<br/>
[in] *sizeDefault*<br/>
no *bHorz*<br/>

### <a name="return-value"></a>Valor de retorno

### <a name="remarks"></a>Comentários

##  <a name="oncancelmode"></a>CMFCToolBarMenuButton:: OnCancelMode

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>Comentários

##  <a name="onchangeparentwnd"></a>  CMFCToolBarMenuButton::OnChangeParentWnd

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>Parâmetros

[in] *pWndParent*<br/>

### <a name="remarks"></a>Comentários

##  <a name="onclick"></a>CMFCToolBarMenuButton:: OnClick

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay = TRUE);
```

### <a name="parameters"></a>Parâmetros

[in] *pWnd*<br/>
no *bDelay*<br/>

### <a name="return-value"></a>Valor de retorno

### <a name="remarks"></a>Comentários

##  <a name="onclickmenuitem"></a>CMFCToolBarMenuButton::OnClickMenuItem

Chamado pelo Framework quando o usuário seleciona um item no menu suspenso.

```
virtual BOOL OnClickMenuItem();
```

### <a name="return-value"></a>Valor de retorno

FALSE se o Framework deve continuar o processamento de item de menu padrão; caso contrário, TRUE. A implementação padrão sempre retorna FALSE.

### <a name="remarks"></a>Comentários

Quando o usuário clica em um item de menu, a estrutura executa um comando associado a esse item.

Para personalizar o processamento do item de menu `OnClickMenuItem` , substitua em uma classe `CMFCToolBarMenuButton` derivada da classe. Você também deve substituir [CFrameWndEx:: OnShowPopupMenu](../../mfc/reference/cframewndex-class.md#onshowpopupmenu) e substituir os botões de menu que exigem processamento especial com instâncias da classe derivada.

##  <a name="oncontexthelp"></a>CMFCToolBarMenuButton::OnContextHelp

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>Parâmetros

[in] *pWnd*<br/>

### <a name="return-value"></a>Valor de retorno

### <a name="remarks"></a>Comentários

##  <a name="ondraw"></a>CMFCToolBarMenuButton:: OnDraw

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz = TRUE,
    BOOL bCustomizeMode = FALSE,
    BOOL bHighlight = FALSE,
    BOOL bDrawBorder = TRUE,
    BOOL bGrayDisabledButtons = TRUE);
```

### <a name="parameters"></a>Parâmetros

no *PDC*<br/>
no *Rect*<br/>
no *pImages*<br/>
no *bHorz*<br/>
no *bCustomizeMode*<br/>
no *bHighlight*<br/>
no *bDrawBorder*<br/>
no *bGrayDisabledButtons*<br/>

### <a name="remarks"></a>Comentários

##  <a name="ondrawoncustomizelist"></a>CMFCToolBarMenuButton::OnDrawOnCustomizeList

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>Parâmetros

no *PDC*<br/>
no *Rect*<br/>
no *bSelected*<br/>

### <a name="return-value"></a>Valor de retorno

### <a name="remarks"></a>Comentários

##  <a name="openpopupmenu"></a>  CMFCToolBarMenuButton::OpenPopupMenu

Chamado pelo Framework quando o usuário abre o menu suspenso de um botão de menu da barra de ferramentas.

```
virtual BOOL OpenPopupMenu(CWnd* pWnd=NULL);
```

### <a name="parameters"></a>Parâmetros

*pWnd*<br/>
no Especifica a janela que recebe os comandos do menu suspenso. Ele só poderá ser nulo se o botão de menu da barra de ferramentas tiver uma janela pai.

### <a name="return-value"></a>Valor de retorno

TRUE quando um objeto de [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) foi criado e aberto com êxito; caso contrário, FALSE.

### <a name="remarks"></a>Comentários

Essa função é chamada pelo Framework quando o usuário abre um menu suspenso a partir de um botão de menu da barra de ferramentas.

##  <a name="resetimagetodefault"></a>  CMFCToolBarMenuButton::ResetImageToDefault

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>Comentários

##  <a name="savebarstate"></a>CMFCToolBarMenuButton::SaveBarState

```
virtual void SaveBarState();
```

### <a name="remarks"></a>Comentários

A estrutura chama esse método quando ele cria um botão da barra de ferramentas como resultado de uma operação de arrastar e soltar. Esse método chama o método [CMFCPopupMenu:: SaveState](../../mfc/reference/cmfcpopupmenu-class.md#savestate) do menu pop-up de nível superior, que faz com que o botão pai do menu pop-up recrie seu menu.

##  <a name="serialize"></a>CMFCToolBarMenuButton:: Serialize

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>Parâmetros

no *ar*<br/>

### <a name="remarks"></a>Comentários

##  <a name="setaccdata"></a>  CMFCToolBarMenuButton::SetACCData

Define os dados de acessibilidade para o elemento Ribbon.

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>Parâmetros

*pParent*<br/>
A janela pai do elemento Ribbon.

*data*<br/>
Os dados de acessibilidade para o elemento Ribbon.

### <a name="return-value"></a>Valor de retorno

Sempre retorna TRUE.

### <a name="remarks"></a>Comentários

Por padrão, esse método define os dados de acessibilidade para o elemento Ribbon e sempre retorna TRUE. Substitua esse método para definir os dados de acessibilidade e retornar um valor que indique êxito ou falha.

##  <a name="setmenuonly"></a>CMFCToolBarMenuButton::SetMenuOnly

Especifica se o botão é desenhado como um botão de menu ou de divisão quando ele tem uma ID de comando válida e um submenu.

```
void SetMenuOnly(BOOL bMenuOnly);
```

### <a name="parameters"></a>Parâmetros

*bMenuOnly*<br/>
no TRUE para mostrar esse botão como um botão de menu quando ele tiver uma ID de comando válida e um submenu, FALSE para mostrar esse botão como um botão de divisão quando ele tiver uma ID de comando válida e um submenu.

### <a name="remarks"></a>Comentários

Normalmente, quando um botão de menu da barra de ferramentas tem um submenu e uma ID de comando, o menu parece ser um botão de divisão que tem um botão principal e um botão de seta para baixo anexado. Se você chamar esse método e *bMenuOnly* for true, o botão parecerá ser um único botão de menu com uma seta para baixo no botão. Quando o usuário clica na seta em um dos modos, o submenu é aberto e quando o usuário clica na parte sem seta do botão em um dos modos, a estrutura executa o comando.

##  <a name="setmenupalettemode"></a>  CMFCToolBarMenuButton::SetMenuPaletteMode

Especifica se o menu suspenso está no modo de paleta.

```
void SetMenuPaletteMode(
    BOOL bMenuPaletteMode=TRUE,
    int nPaletteRows=1);
```

### <a name="parameters"></a>Parâmetros

*bMenuPaletteMode*<br/>
no Especifica se o menu suspenso está no modo de paleta.

*nPaletteRows*<br/>
no Número de linhas na paleta.

### <a name="remarks"></a>Comentários

No modo de paleta, todos os itens de menu são exibidos como uma paleta de várias colunas. Você especifica o número de linhas usando *nPaletteRows*.

##  <a name="setmessagewnd"></a>  CMFCToolBarMenuButton::SetMessageWnd

```
void SetMessageWnd(CWnd* pWndMessage);
```

### <a name="parameters"></a>Parâmetros

[in] *pWndMessage*<br/>

### <a name="remarks"></a>Comentários

##  <a name="setradio"></a>CMFCToolBarMenuButton:: SetRadio

Define o botão de menu da barra de ferramentas para exibir um ícone de estilo de botão de opção quando ele está marcado.

```
virtual void SetRadio();
```

### <a name="remarks"></a>Comentários

Quando o botão de menu é desenhado enquanto está marcado, ele chama [CMFCVisualManager:: OnDrawMenuCheck](../../mfc/reference/cmfcvisualmanager-class.md#ondrawmenucheck) para desenhar um ícone de marca de seleção. Por padrão, `OnDrawMenuCheck` as solicitações que o Gerenciador de visual atual desenha uma marca de seleção de estilo de caixa de verificação no botão de menu. Depois de chamar esse método, o Gerenciador do visual atual desenha uma marca de seleção de estilo de botão de opção no botão de menu. Essa alteração não pode ser desfeita.

Quando você chamar esse método e o botão de menu estiver sendo exibido no momento, ele será atualizado.

##  <a name="settearoff"></a>CMFCToolBarMenuButton::SetTearOff

Especifica a ID da barra de desfazer para o menu suspenso.

```
virtual void SetTearOff(UINT uiBarID);
```

### <a name="parameters"></a>Parâmetros

*uiBarID*<br/>
no Especifica uma nova ID de barra destacável.

### <a name="remarks"></a>Comentários

Chame esse método para especificar a ID da barra de desmontagem que é criada quando o usuário arrasta o botão de menu para fora de uma barra de menus. Se o parâmetro *uiBarID* for 0, o usuário não poderá desfazer o botão de menu.

Chame [CWinAppEx:: EnableTearOffMenus](../../mfc/reference/cwinappex-class.md#enabletearoffmenus) para habilitar o recurso de menu destacável em seu aplicativo.

## <a name="see-also"></a>Consulte também

[Gráfico da hierarquia](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[Classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)<br/>
[Classe CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)<br/>
[Classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)
